!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.IGE=n():t.IGE=n()}(this,function(){return function(t){function n(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var i={};return n.m=t,n.c=i,n.i=function(t){return t},n.d=function(t,i,e){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=63)}([function(t,n,i){"use strict";var e=i(2);class o extends e.a{init(t){}update(t,n){return"number"==typeof t?super.update(t):"number"==typeof n?super.update(n):void 0}toHTML(){return this.name}}n.a=o},function(t,n,i){var e=i(9),o={};o.create=function(){var t=new e.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var n=new e.ARRAY_TYPE(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},o.fromValues=function(t,n,i){var o=new e.ARRAY_TYPE(3);return o[0]=t,o[1]=n,o[2]=i,o},o.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},o.set=function(t,n,i,e){return t[0]=n,t[1]=i,t[2]=e,t},o.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t},o.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t},o.sub=o.subtract,o.multiply=function(t,n,i){return t[0]=n[0]*i[0],t[1]=n[1]*i[1],t[2]=n[2]*i[2],t},o.mul=o.multiply,o.divide=function(t,n,i){return t[0]=n[0]/i[0],t[1]=n[1]/i[1],t[2]=n[2]/i[2],t},o.div=o.divide,o.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},o.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},o.min=function(t,n,i){return t[0]=Math.min(n[0],i[0]),t[1]=Math.min(n[1],i[1]),t[2]=Math.min(n[2],i[2]),t},o.max=function(t,n,i){return t[0]=Math.max(n[0],i[0]),t[1]=Math.max(n[1],i[1]),t[2]=Math.max(n[2],i[2]),t},o.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},o.scale=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t},o.scaleAndAdd=function(t,n,i,e){return t[0]=n[0]+i[0]*e,t[1]=n[1]+i[1]*e,t[2]=n[2]+i[2]*e,t},o.distance=function(t,n){var i=n[0]-t[0],e=n[1]-t[1],o=n[2]-t[2];return Math.sqrt(i*i+e*e+o*o)},o.dist=o.distance,o.squaredDistance=function(t,n){var i=n[0]-t[0],e=n[1]-t[1],o=n[2]-t[2];return i*i+e*e+o*o},o.sqrDist=o.squaredDistance,o.length=function(t){var n=t[0],i=t[1],e=t[2];return Math.sqrt(n*n+i*i+e*e)},o.len=o.length,o.squaredLength=function(t){var n=t[0],i=t[1],e=t[2];return n*n+i*i+e*e},o.sqrLen=o.squaredLength,o.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},o.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},o.normalize=function(t,n){var i=n[0],e=n[1],o=n[2],s=i*i+e*e+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s),t},o.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},o.cross=function(t,n,i){var e=n[0],o=n[1],s=n[2],r=i[0],a=i[1],c=i[2];return t[0]=o*c-s*a,t[1]=s*r-e*c,t[2]=e*a-o*r,t},o.lerp=function(t,n,i,e){var o=n[0],s=n[1],r=n[2];return t[0]=o+e*(i[0]-o),t[1]=s+e*(i[1]-s),t[2]=r+e*(i[2]-r),t},o.hermite=function(t,n,i,e,o,s){var r=s*s,a=r*(2*s-3)+1,c=r*(s-2)+s,u=r*(s-1),h=r*(3-2*s);return t[0]=n[0]*a+i[0]*c+e[0]*u+o[0]*h,t[1]=n[1]*a+i[1]*c+e[1]*u+o[1]*h,t[2]=n[2]*a+i[2]*c+e[2]*u+o[2]*h,t},o.bezier=function(t,n,i,e,o,s){var r=1-s,a=r*r,c=s*s,u=a*r,h=3*s*a,f=3*c*r,l=c*s;return t[0]=n[0]*u+i[0]*h+e[0]*f+o[0]*l,t[1]=n[1]*u+i[1]*h+e[1]*f+o[1]*l,t[2]=n[2]*u+i[2]*h+e[2]*f+o[2]*l,t},o.random=function(t,n){n=n||1;var i=2*e.RANDOM()*Math.PI,o=2*e.RANDOM()-1,s=Math.sqrt(1-o*o)*n;return t[0]=Math.cos(i)*s,t[1]=Math.sin(i)*s,t[2]=o*n,t},o.transformMat4=function(t,n,i){var e=n[0],o=n[1],s=n[2],r=i[3]*e+i[7]*o+i[11]*s+i[15];return r=r||1,t[0]=(i[0]*e+i[4]*o+i[8]*s+i[12])/r,t[1]=(i[1]*e+i[5]*o+i[9]*s+i[13])/r,t[2]=(i[2]*e+i[6]*o+i[10]*s+i[14])/r,t},o.transformMat3=function(t,n,i){var e=n[0],o=n[1],s=n[2];return t[0]=e*i[0]+o*i[3]+s*i[6],t[1]=e*i[1]+o*i[4]+s*i[7],t[2]=e*i[2]+o*i[5]+s*i[8],t},o.transformQuat=function(t,n,i){var e=n[0],o=n[1],s=n[2],r=i[0],a=i[1],c=i[2],u=i[3],h=u*e+a*s-c*o,f=u*o+c*e-r*s,l=u*s+r*o-a*e,d=-r*e-a*o-c*s;return t[0]=h*u+d*-r+f*-c-l*-a,t[1]=f*u+d*-a+l*-r-h*-c,t[2]=l*u+d*-c+h*-a-f*-r,t},o.rotateX=function(t,n,i,e){var o=[],s=[];return o[0]=n[0]-i[0],o[1]=n[1]-i[1],o[2]=n[2]-i[2],s[0]=o[0],s[1]=o[1]*Math.cos(e)-o[2]*Math.sin(e),s[2]=o[1]*Math.sin(e)+o[2]*Math.cos(e),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t},o.rotateY=function(t,n,i,e){var o=[],s=[];return o[0]=n[0]-i[0],o[1]=n[1]-i[1],o[2]=n[2]-i[2],s[0]=o[2]*Math.sin(e)+o[0]*Math.cos(e),s[1]=o[1],s[2]=o[2]*Math.cos(e)-o[0]*Math.sin(e),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t},o.rotateZ=function(t,n,i,e){var o=[],s=[];return o[0]=n[0]-i[0],o[1]=n[1]-i[1],o[2]=n[2]-i[2],s[0]=o[0]*Math.cos(e)-o[1]*Math.sin(e),s[1]=o[0]*Math.sin(e)+o[1]*Math.cos(e),s[2]=o[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t},o.forEach=function(){var t=o.create();return function(n,i,e,o,s,r){var a,c;for(i||(i=3),e||(e=0),c=o?Math.min(o*i+e,n.length):n.length,a=e;a<c;a+=i)t[0]=n[a],t[1]=n[a+1],t[2]=n[a+2],s(t,t,r),n[a]=t[0],n[a+1]=t[1],n[a+2]=t[2];return n}}(),o.angle=function(t,n){var i=o.fromValues(t[0],t[1],t[2]),e=o.fromValues(n[0],n[1],n[2]);o.normalize(i,i),o.normalize(e,e);var s=o.dot(i,e);return s>1?0:Math.acos(s)},o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},o.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},o.equals=function(t,n){var i=t[0],o=t[1],s=t[2],r=n[0],a=n[1],c=n[2];return Math.abs(i-r)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(o-a)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(a))&&Math.abs(s-c)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))},t.exports=o},function(t,n,i){"use strict";function e(t,n){var i=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,i)}var o=i(1),s=i.n(o),r=i(10);class a{constructor(){this.components=[],this.position=s.a.create(),this.velocity=s.a.create(),this.rotation=0,this.rotationAxis=s.a.fromValues(0,0,1),this.rotationSpeed=0,this._toBeRemoved=[],this._events={}}addComponent(t){return t instanceof Function&&(t={update:t}),this.components.push(t),t.init&&t.init(this),this}addComponents(t){t.forEach(t=>this.addComponent(t))}removeComponent(t){return this._toBeRemoved.push(t),this}removeComponentByName(t){for(var n=0;n<this.components.length;n++){const i=this.components[n];i.name!=t&&i.constructor.name!=t||this._toBeRemoved.push(i)}return this}removeComponentByTest(t){for(var n=0;n<this.components.length;n++)t(this.components[n])&&this._toBeRemoved.push(this.components[n]);return this}setPosition(t,n,i){return void 0==t&&(t=this.position[0]),void 0==n&&(n=this.position[1]),void 0==i&&(i=this.position[2]),s.a.set(this.position,t,n,i),this}setVelocity(t,n,i){return void 0==t&&(t=this.velocity[0]),void 0==n&&(n=this.velocity[1]),void 0==i&&(i=this.velocity[2]),s.a.set(this.velocity,t,n,i),this}setBounds(...t){return this.bounds=t,this}setRotation(t,n){this.rotation=t,n&&s.a.normalize(this.rotationAxis,n)}update(t){for(var n=0,i=this.components.length,o=0,s=this._toBeRemoved.length;o<s;o++)for(n=0;n<i;n++)if(this.components[n]==this._toBeRemoved[o]){e.call(this.components,n);break}for(this._toBeRemoved.length=0,i=this.components.length,n=0;n<i;n++)this.components[n].update(this,t)}toHTML(){var t,n=this.name;if("number"==typeof this.position.x&&(n+=" "+this.position),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}return n}}n.a=a,i.i(r.b)(a,r.c)},function(t,n,i){"use strict";var e=i(0),o=i(8);class s extends e.a{constructor(t,n,i,e=1e3,s=o["Linear"],r=2){super(),Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]),n.length=4,i.length=4,this.outputter=t,this.start=n,this.end=i,this.duration=e,this.easing=s,this.loop=r,this.elapsed=0,this.direction=1,this.out=Array(4)}reset(){this.elapsed=0}start(){this.direction=1}pause(){this.direction=0}stop(){this.pause(),this.reset()}update(t,n){const i=this.easing(this.elapsed/this.duration),e=this.start[0],o=this.start[1],s=this.start[2],r=this.start[3];this.out[0]=e+i*(this.end[0]-e),this.out[1]=o+i*(this.end[1]-o),this.out[2]=s+i*(this.end[2]-s),this.out[3]=r+i*(this.end[3]-r),this.outputter(t,this.out),this.elapsed+=n*this.direction,(this.elapsed>this.duration||this.elapsed<0)&&(2==this.loop?this.direction*=-1:1==this.loop&&(this.elapsed=0),this.elapsed=Math.min(Math.max(this.elapsed,0),this.duration))}}n.a=s},function(t,n,i){var e=i(9),o={};o.create=function(){var t=new e.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var n=new e.ARRAY_TYPE(2);return n[0]=t[0],n[1]=t[1],n},o.fromValues=function(t,n){var i=new e.ARRAY_TYPE(2);return i[0]=t,i[1]=n,i},o.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},o.set=function(t,n,i){return t[0]=n,t[1]=i,t},o.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t},o.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t},o.sub=o.subtract,o.multiply=function(t,n,i){return t[0]=n[0]*i[0],t[1]=n[1]*i[1],t},o.mul=o.multiply,o.divide=function(t,n,i){return t[0]=n[0]/i[0],t[1]=n[1]/i[1],t},o.div=o.divide,o.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},o.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},o.min=function(t,n,i){return t[0]=Math.min(n[0],i[0]),t[1]=Math.min(n[1],i[1]),t},o.max=function(t,n,i){return t[0]=Math.max(n[0],i[0]),t[1]=Math.max(n[1],i[1]),t},o.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},o.scale=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t},o.scaleAndAdd=function(t,n,i,e){return t[0]=n[0]+i[0]*e,t[1]=n[1]+i[1]*e,t},o.distance=function(t,n){var i=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(i*i+e*e)},o.dist=o.distance,o.squaredDistance=function(t,n){var i=n[0]-t[0],e=n[1]-t[1];return i*i+e*e},o.sqrDist=o.squaredDistance,o.length=function(t){var n=t[0],i=t[1];return Math.sqrt(n*n+i*i)},o.len=o.length,o.squaredLength=function(t){var n=t[0],i=t[1];return n*n+i*i},o.sqrLen=o.squaredLength,o.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},o.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},o.normalize=function(t,n){var i=n[0],e=n[1],o=i*i+e*e;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o),t},o.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},o.cross=function(t,n,i){var e=n[0]*i[1]-n[1]*i[0];return t[0]=t[1]=0,t[2]=e,t},o.lerp=function(t,n,i,e){var o=n[0],s=n[1];return t[0]=o+e*(i[0]-o),t[1]=s+e*(i[1]-s),t},o.random=function(t,n){n=n||1;var i=2*e.RANDOM()*Math.PI;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t},o.transformMat2=function(t,n,i){var e=n[0],o=n[1];return t[0]=i[0]*e+i[2]*o,t[1]=i[1]*e+i[3]*o,t},o.transformMat2d=function(t,n,i){var e=n[0],o=n[1];return t[0]=i[0]*e+i[2]*o+i[4],t[1]=i[1]*e+i[3]*o+i[5],t},o.transformMat3=function(t,n,i){var e=n[0],o=n[1];return t[0]=i[0]*e+i[3]*o+i[6],t[1]=i[1]*e+i[4]*o+i[7],t},o.transformMat4=function(t,n,i){var e=n[0],o=n[1];return t[0]=i[0]*e+i[4]*o+i[12],t[1]=i[1]*e+i[5]*o+i[13],t},o.forEach=function(){var t=o.create();return function(n,i,e,o,s,r){var a,c;for(i||(i=2),e||(e=0),c=o?Math.min(o*i+e,n.length):n.length,a=e;a<c;a+=i)t[0]=n[a],t[1]=n[a+1],s(t,t,r),n[a]=t[0],n[a+1]=t[1];return n}}(),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},o.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]},o.equals=function(t,n){var i=t[0],o=t[1],s=n[0],r=n[1];return Math.abs(i-s)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-r)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(r))},t.exports=o},function(t,n,i){"use strict";function e(t,n){const i=function(t){return t.stopPropagation(),t.preventDefault(),t.handled!==!0&&(n(t),void(t.handled=!0))};o(t),t.addEventListener("touchstart",i),t.addEventListener("click",i),t.touchClick=i}function o(t){t.removeEventListener("touchstart",t.touchClick),t.removeEventListener("click",t.touchClick)}var s=i(2),r=i(4),a=i.n(r),c=i(34),u=i.n(c);const h=a.a.create(),f=u.a.create();class l extends s.a{constructor(t,n,i){super(),this._nextClick=a.a.fromValues(NaN,NaN),this.lastClick=a.a.create(),this.hasClick=!1,this._nextKey=null,this.lastKey=null,this.screen=t,this.keyboard=n,this.camera=i,this.initScreen(),this.initKeyboard()}update(t){super.update(t),a.a.copy(this.lastClick,this._nextClick),a.a.set(this._nextClick,NaN,NaN),this.hasClick=!isNaN(this.lastClick[0]),this.hasClick&&this.fire("click",this.lastClick),this.lastKey=this._nextKey,this._nextKey=null,this.lastKey&&this.fire("keypress",this.lastKey)}setScreen(t){this.screen&&this.destroyScreen(),this.screen=t,this.initScreen()}screenToWorld(t,n){const i=this.camera,e=this.screen,o=e.offsetWidth,s=e.offsetHeight;return a.a.set(h,t-o/2,n-s/2),a.a.set(h,h[0]/i.scaleX,h[1]/i.scaleY),1==i.rotationAxis[2]&&(u.a.rotate(f,f,-i.rotation),a.a.transformMat2(h,h,f)),a.a.add(h,h,i.position),h}initScreen(){this.screen&&e(this.screen,t=>{const n=this.screen.offsetLeft,i=this.screen.offsetTop,e=t.touches&&t.touches[0],o=(e?e.pageX:t.pageX)-n,s=(e?e.pageY:t.pageY)-i;a.a.copy(this._nextClick,this.screenToWorld(o,s))})}initKeyboard(){this.keyboard&&this.keyboard.addEventListener("keydown",t=>{this._nextKey=t.which})}destroyScreen(){const t=this.screen;t&&o(t)}}n.a=l,l.Keys={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90}},function(t,n,i){"use strict";function e(t,n){const{context,renderQueue}=t,i=renderQueue[n];if(i){for(let n=0,e=i.length;n<e;n++)context.save(),i[n].call(t,context),context.restore();i.length=0}}var o=i(2);class s extends o.a{constructor(t,n){super(),this.renderQueue=[],this.clearScreen=!0,this.context=t,this.canvas=t&&t.canvas,this.camera=n}push(t,n=1){this.renderQueue[n]||(this.renderQueue[n]=[]),this.renderQueue[n].push(t)}update(t){this.clearScreen&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save();var n,i,o=this.camera.position,s=this.canvas.width/2,r=this.canvas.height/2;for(this.context.translate(s,r),this.context.scale(this.camera.scaleX,this.camera.scaleY),1==this.camera.rotationAxis[2]&&this.context.rotate(-this.camera.rotation),this.context.translate(-o[0],-o[1]),n=0,i=this.renderQueue.length;n<i;n++)e(this,n);this.context.restore(),e(this,-1)}drawPath(t,n){var i=2,e=n.length;for(t.beginPath(),t.moveTo(n[0],n[1]);i<e-1;i+=2)t.lineTo(n[i],n[i+1])}strokePath(t,n="#000",i=1){this.push(function(i){i.strokeStyle=n,this.drawPath(i,t),i.stroke()},i)}}n.a=s},function(t,n,i){"use strict";var e=i(2);class o extends e.a{constructor(t){super(),this.bounds=t}}n.a=o},function(t,n,i){"use strict";function e(t){var n=1.70158;return t*t*((n+1)*t-n)}function o(t){var n=1.70158;return t-=1,t*t*((n+1)*t+n)+1}function s(t){var n=2.5949095;return t*=2,t<1?Math.pow(t,2)*((n+1)*t-n)/2:(t-=2,(Math.pow(t,2)*((n+1)*t+n)+2)/2)}function r(t){if(0==t||1==t)return t;var n=.3,i=n/4;return t-=1,-1*Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n)}function a(t){if(0==t||1==t)return t;var n=.3,i=n/4;return Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}function c(t){if(0==t)return 0;if(t*=2,2==t)return 1;var n=.3*1.5,i=n/4;return t<1?(t-=1,-.5*(Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n))):(t-=1,.5*(Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n))+1)}function u(t){const n=5;return 1-Math.cos(2*t*Math.PI*n)*(1-l(t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BackIn=e,n.BackOut=o,n.BackInOut=s,n.ElasticIn=r,n.ElasticOut=a,n.ElasticInOut=c,n.DampedOscillation=u;const h=t=>t;n.Linear=h;const f=t=>t*t;n.QuadIn=f;const l=t=>-t*(t-2);n.QuadOut=l;const d=t=>1-Math.sqrt(1-t*t);n.CircIn=d;const p=t=>Math.sqrt(1-(t-1)*(t-1));n.CircOut=p;const v=t=>t*t*(3-2*t);n.Smooth=v;const m=t=>-1*Math.cos(t*(Math.PI/2))+1;n.SineIn=m;const y=t=>Math.sin(t*(Math.PI/2));n.SineOut=y;const b=t=>-1*(Math.cos(Math.PI*t)-1)/2;n.SineInOut=b},function(t,n){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.ENABLE_SIMD=!1,i.SIMD_AVAILABLE=i.ARRAY_TYPE===Float32Array&&"SIMD"in this,i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE,i.setMatrixArrayType=function(t){i.ARRAY_TYPE=t};var e=Math.PI/180;i.toRadian=function(t){return t*e},i.equals=function(t,n){return Math.abs(t-n)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))},t.exports=i},function(t,n,i){"use strict";function e(t){let n=t.match(s)||t.match(r);if(n){const t=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1];return t}if(n=t.match(a)){const t=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return t}}function o(t,n){Object.getOwnPropertyNames(n.prototype).forEach(i=>{t.prototype[i]=n.prototype[i]})}n.a=e,n.b=o;const s=/#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i,r=/#([0-9a-f])([0-9a-f])([0-9a-f])/i,a=/rgba?\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(?:,(0(?:.\d+)|1(?:.0)?))?\)/;class c{constructor(){this._events={}}on(t,n){this._events[t]||(this._events[t]=[]),this._events[t].push(n)}fire(t,...n){var i=this._events[t];i&&i.length&&i.forEach(t=>{t.apply(this,n)})}}n.c=c},function(t,n,i){"use strict";var e=i(2);class o extends e.a{constructor(){super(...arguments),this.pruneList=[],this.suspendedObjects=[],this.skewX=0,this.skeyY=0,this.scaleX=1,this.scaleY=1}setScale(t,n){n=n||t,this.scaleX=t,this.scaleY=n}addManagerForPruning(t){this.pruneList.push(t)}}n.a=o},function(t,n,i){"use strict";function e(t,n){return t[0]*n[1]-t[1]*n[0]}var o=i(0),s=i(4),r=i.n(s);const a=r.a.create(),c=r.a.create(),u=r.a.create(),h=r.a.create(),f=r.a.create(),l=r.a.create(),d=r.a.create(),p=r.a.create(),v=r.a.create();class m extends o.a{constructor(t,n){super(),this.coefficientFriction=m.COEFFICIENT_FRICTION,this.coefficientRestitution=m.COEFFICIENT_RESTITUTION,this.background=t,this.bounds=n}update(t,n){var i,o,s,m,y,b=this.background.surfaces,g=0,M=b.length,S=this.coefficientFriction,A=this.coefficientRestitution,I=t.position[0],C=t.position[1],_=this.position;if(_[0]&&Math.abs(_[0]-I)<100&&Math.abs(_[1]-C)<100)for(;g<M;g++)for(i=b[g],o=i.length,s=0;s<o-3;s+=2)if(r.a.set(h,i[s],i[s+1]),r.a.set(f,i[s+2],i[s+3]),r.a.subtract(f,f,h),r.a.copy(l,_),r.a.subtract(d,t.position,l),r.a.subtract(p,l,h),m=e(p,d)/e(f,d),y=e(p,f)/e(f,d),m>=0&&m<=1&&y>=0&&y<=1){r.a.copy(t.position,_),r.a.set(c,-f[1],f[0]),r.a.normalize(c,c),r.a.copy(v,t.velocity),r.a.scale(a,c,r.a.dot(c,v)),r.a.subtract(u,v,a),r.a.scale(u,u,S),r.a.scale(a,a,A),r.a.subtract(t.velocity,u,a);break}r.a.copy(_,t.position)}}n.a=m,m.COEFFICIENT_FRICTION=.95,m.COEFFICIENT_RESTITUTION=.4},function(t,n,i){"use strict";function e(t,n){var i=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,i)}var o=i(2);class s extends o.a{constructor(){super(...arguments),this.objects=[],this._objectsToBeRemoved=[]}addObject(t){return t instanceof o.a&&this.objects.push(t),this}addObjectAt(t,n){return t instanceof o.a&&this.objects.splice(n,0,t),this}removeObject(t){return t instanceof o.a&&this._objectsToBeRemoved.push(t),this}removeAll(){this.objects.length=0}update(t){super.update(t);var n,i=0,o=this.objects.length,s=0;for(i=0;i<o;i++)this.objects[i].update(t);for(n=this._objectsToBeRemoved.length;s<n;s++)for(i=0;i<o;i++)if(this.objects[i]==this._objectsToBeRemoved[s]){e.call(this.objects,i),o--;break}this._objectsToBeRemoved.length=0}toHTML(){var t,n=this.name;if(this.objects.length>1&&(n+=" ("+this.objects.length+" items)"),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}if(this.objects.length){for(n+="<ul>",t=0;t<this.objects.length;t++)n+="<li>"+this.objects[t].toHTML();n+="</ul>"}return n}}n.a=s},function(t,n,i){"use strict";var e=i(0),o=i(4),s=i.n(o);class r extends e.a{constructor(t){super(),this.input=t}update(t,n){this.input.hasClick&&s.a.copy(t.position,this.input.lastClick)}}n.a=r},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n=0,i=0,e=0){super(),this.cRestitution=1,this.cFriction=1,this.worldSystem=t,this.ax=n/2,this.ay=i/2,this.az=e/2}update(t,n){const i=this.cRestitution,e=this.cFriction,o=this.worldSystem.bounds,s=t.bounds;let r,a,c,u,h,f;s?(r=o[0]-s[0],a=o[1]-s[1],c=o[2]-s[2],u=o[3]-s[3],h=o[4]-s[4],f=o[5]-s[5]):(r=o[0]+this.ax,a=o[1]+this.ay,c=o[2]-this.ax,u=o[3]-this.ay,h=o[4]+this.az,f=o[5]-this.az),t.hasBounced=!1,t.position[0]<r?(t.position[0]=r,t.velocity[0]=-t.velocity[0]*i,t.velocity[1]=t.velocity[1]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=1):t.position[0]>c&&(t.position[0]=c,t.velocity[0]=-t.velocity[0]*i,t.velocity[1]=t.velocity[1]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=1),t.position[1]<a?(t.position[1]=a,t.velocity[1]=-t.velocity[1]*i,t.velocity[0]=t.velocity[0]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=2):t.position[1]>u&&(t.position[1]=u,t.velocity[1]=-t.velocity[1]*i,t.velocity[0]=t.velocity[0]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=2),t.position[2]<h?(t.position[2]=h,t.velocity[2]=-t.velocity[2]*i,t.velocity[0]=t.velocity[0]*e,t.velocity[1]=t.velocity[1]*e,t.hasBounced=3):t.position[2]>f&&(t.position[2]=f,t.velocity[2]=-t.velocity[2]*i,t.velocity[0]=t.velocity[0]*e,t.velocity[1]=t.velocity[1]*e,t.hasBounced=3)}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t){super(),this.worldSystem=t}update(t,n){const i=this.worldSystem.bounds[0],e=this.worldSystem.bounds[1],o=this.worldSystem.bounds[2],s=this.worldSystem.bounds[3],r=this.worldSystem.bounds[4],a=this.worldSystem.bounds[5];t.position[0]<i&&t.velocity[0]<0?(t.position[0]=o,this.fire("wrap",t)):t.position[0]>o&&t.velocity[0]>0&&(t.position[0]=i,this.fire("wrap",t)),t.position[1]<e&&t.velocity[1]<0?(t.position[1]=s,this.fire("wrap",t)):t.position[1]>s&&t.velocity[1]>0&&(t.position[1]=e,this.fire("wrap",t)),t.position[2]<r&&t.velocity[2]<0?(t.position[2]=a,this.fire("wrap",t)):t.position[2]>a&&t.velocity[2]>0&&(t.position[2]=r,this.fire("wrap",t))}}n.a=o},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);const r=s.a.create(),a=s.a.create(),c=s.a.create(),u=s.a.create(),h=s.a.create();class f extends e.a{constructor(){super(),this.cRestitution=.9}init(t){t.on("attack",n=>{const i=t.bounds[2]-t.bounds[0],e=t.bounds[3]-t.bounds[1],o=n.bounds[2]-n.bounds[0],f=n.bounds[3]-n.bounds[1],l=(i+e)/2,d=(o+f)/2,p=(l+d)/2,v=s.a.dist(t.position,n.position);if(v<p){s.a.subtract(r,t.position,n.position),s.a.scale(a,r,(p-v)/v);const i=1/(t.mass||1),e=1/(n.mass||1);s.a.scaleAndAdd(t.position,t.position,a,i/(i+e)),s.a.scaleAndAdd(n.position,n.position,a,-e/(i+e)),s.a.subtract(c,t.velocity,n.velocity),s.a.normalize(u,a);const o=s.a.dot(c,u);if(o>0)return;const f=-(1+this.cRestitution)*o/(i+e);s.a.scale(h,u,f),s.a.scaleAndAdd(t.velocity,t.velocity,h,i),s.a.scaleAndAdd(n.velocity,n.velocity,h,-e)}})}}n.a=f},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n,i){super(),this.collisionSystem=t,this.attack=n,this.vulnerable=i}update(t,n){this.attack&&this.collisionSystem.addAttackObject(t),this.vulnerable&&this.collisionSystem.addVulnerableObject(t)}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n){super(),this.backgroundSystem=t,this.segments=n}update(t,n){for(var i,e,o,s,r=[],a=0,c=this.segments.length;a<c;a++){for(o=this.segments[a],e=o.length-1,s=[],i=0;i<e;i+=2)s.push(o[i]+t.position.x,o[i+1]+t.position.y);r.push(s)}this.backgroundSystem.addTemporarySurfaces(r)}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t){super(),this.inputSystem=t}update(t,n){if(t.bounds&&this.inputSystem.hasClick){const n=this.inputSystem.lastClick,i=t.position,e=t.bounds;e[0]+i[0]<n[0]&&e[1]+i[1]<n[1]&&e[2]+i[0]>n[0]&&e[3]+i[1]>n[1]&&this.fire("click",t)}}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const i=t.bounds,e=t.position,o=t.rotation,s=t.size,r=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=r,t.translate(e[0],e[1]),t.rotate(o),i?t.scale(i[2]-i[0],i[3]-i[1]):s&&t.scale(s,s),t.arc(0,0,.5,0,2*Math.PI,!1),t.fill()})}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const i=t.bounds,e=t.position,o=t.size,s=t.rotation,r=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=r,t.translate(e[0],e[1]),t.rotate(s),i?t.rect(i[0],i[1],i[2]-i[0],i[3]-i[1]):o&&t.rect(-o/2,-o/2,o,o),t.fill()})}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n,i,e,o="10px sans-serif",s="#000"){super(),this.renderSystem=t,this.text=n,this.font=o,this.color=s,this.setPosition(i,e)}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.translate(this.position[0],this.position[1]),n.fillStyle=this.color,n.font=this.font,n.fillText(this.text,0,0)})}}n.a=o},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);const r=s.a.create(),a=s.a.create(),c=s.a.create(),u=s.a.create();class h extends e.a{constructor(t){super(),this.flock=t}update(t,n){s.a.set(c,0,0,0),s.a.set(a,0,0,0),s.a.set(r,0,0,0),s.a.set(u,0,0,0);let i=0;const e=this.flock.length;for(let o=0;o<e;o++){const n=this.flock[o],e=s.a.dist(n.position,t.position);e>0&&e<h.NEIGHBOUR_RADIUS&&(s.a.add(c,c,n.position),s.a.add(a,a,n.velocity),e<h.SEPARATION_RADIUS&&(s.a.subtract(u,t.position,n.position),s.a.normalize(u,u),s.a.scaleAndAdd(r,r,u,1/e)),i++)}if(i>0){s.a.scale(c,c,1/i),s.a.subtract(c,c,t.position),s.a.scaleAndAdd(t.velocity,t.velocity,c,h.COHESION_WEIGHT),s.a.scaleAndAdd(t.velocity,t.velocity,a,h.ALIGN_WEIGHT/i),s.a.scaleAndAdd(t.velocity,t.velocity,r,h.SEPARATION_WEIGHT/i);var f=s.a.length(t.velocity);f>h.MAX_SPEED&&s.a.scale(t.velocity,t.velocity,h.MAX_SPEED/f)}}}n.a=h,h.NEIGHBOUR_RADIUS=200,h.SEPARATION_RADIUS=150,h.MAX_SPEED=.1,h.COHESION_WEIGHT=.1*h.MAX_SPEED/h.NEIGHBOUR_RADIUS,h.ALIGN_WEIGHT=30*h.MAX_SPEED/h.NEIGHBOUR_RADIUS,h.SEPARATION_WEIGHT=100/h.SEPARATION_RADIUS},function(t,n,i){"use strict";var e=i(2);class o extends e.a{constructor(){super()}playSound(t){t.audio&&t.audio.play()}}n.a=o},function(t,n,i){"use strict";var e,o=i(13),s=i(11),r=i(6),a=i(7),c=i(5),u=i(10);!function(t){t[t.STATE_PAUSED=0]="STATE_PAUSED",t[t.STATE_PLAYING=1]="STATE_PLAYING",t[t.STATE_STOPPED=2]="STATE_STOPPED",t[t.STATE_DEAD=3]="STATE_DEAD"}(e||(e={}));let h=0;const f="undefined"!=typeof window&&window.requestAnimationFrame||function(t,n){var i=(new Date).getTime(),e=Math.max(0,16-(i-h)),o=setTimeout(function(){t(i+e)},e);return h=i+e,o};class l{constructor({canvas,width,height,score,lives,level,autosize,originCentric}={canvas:null,width:0,height:0,score:0,lives:0,level:0,autosize:false,originCentric:false}){this.root=new o.a,this.textures=[],this.sounds=[],this.frame=0,this.time=0,this.score=0,this.lives=0,this.level=0,this.originCentric=!1,this._toLoad=0,this._lastTime=0,this._loaded=0,this._generalObjects=null,this._autosizeCallback=(()=>{if(this.canvas){const t=this.canvas.offsetWidth,n=this.canvas.offsetHeight;this.setSize(t,n),this.cameraSystem&&this.cameraSystem.setPosition(t/2,n/2),this.worldSystem&&this.worldSystem.setBounds(0,0,t,n)}}),this._events={},this.canvas=canvas,this.width=width||this.canvas&&this.canvas.width||0,this.height=height||this.canvas&&this.canvas.height||0,this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.score=score,this.lives=lives,this.level=level,this.originCentric=originCentric,autosize&&this.setAutosize(!0)}addObject(t){this._initialiseGeneralObjects(),this._generalObjects.addObject(t)}setCanvas(t){this.canvas=t,this.canvas&&(this.width=this.width||this.canvas.width,this.height=this.height||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height)}loadTextures(t){return this._toLoad+=t.length,t.map(t=>{const n={image:new Image,width:0,height:0,loaded:!1};return n.image.onload=(()=>{n.width=n.image.width,n.height=n.image.height,n.loaded=!0,this._resourceLoaded(n)}),n.image.onerror=function(){throw new Error("Failed to load a texture: "+t)},n.image.src=t,this.textures.push(n),n})}loadAudio(t){return this._toLoad+=t.length,t.map(t=>{const n={audio:new Audio,length:0,loaded:!1};return n.audio.addEventListener("canplaythrough",()=>{n.loaded||(n.length=n.audio.duration,n.loaded=!0,this._resourceLoaded(n))}),n.audio.onerror=function(){throw new Error("Failed to load a sound: "+t)},n.audio.src=t,this.sounds.push(n),n})}start(){this.nextLevel(),this.state=e.STATE_PLAYING,this._loop()}stop(){this.state=e.STATE_STOPPED}getDefaultCamera(){return this.cameraSystem||(this.cameraSystem=new s.a,this.originCentric||this.cameraSystem.setPosition(this.width/2,this.height/2),this._initialiseGeneralObjects(),this.root.addObject(this.cameraSystem)),this.cameraSystem}getDefaultRenderer(){if(!this.renderSystem){this.cameraSystem||this.getDefaultCamera();let t;this.canvas&&(t=this.canvas.getContext("2d")),this.renderSystem=new r.a(t,this.cameraSystem),this._initialiseGeneralObjects(),this.root.addObject(this.renderSystem)}return this.renderSystem}getDefaultWorld(t=0,n=t){const i=[-t,-n,this.width+t,this.height+n];if(this.originCentric){const t=this.width/2,n=this.height/2;i[0]-=t,i[1]-=n,i[2]-=t,i[3]-=n}return this.worldSystem?this.worldSystem.setBounds(...i):(this.worldSystem=new a.a(i),this._initialiseGeneralObjects(),this.root.addObject(this.worldSystem)),this.worldSystem}getDefaultInput(){return this.inputSystem||(this.cameraSystem||this.getDefaultCamera(),this.inputSystem=new c.a(this.canvas,"undefined"!=typeof document&&document,this.cameraSystem),this._initialiseGeneralObjects(),this.root.addObject(this.inputSystem)),this.inputSystem}setScore(t){this.score=t,this.fire("score",this.score)}nextLevel(){this.level++,this.fire("loadLevel",this.level)}setLevel(t){this.level=t,this.fire("loadLevel",this.level)}completeLevel(){this.fire("levelComplete",this.level)}setSize(t,n){this.width=t,this.height=n,this.canvas&&(this.canvas.width=t,this.canvas.height=n)}setAutosize(t){"undefined"!=typeof window&&(t?window.addEventListener("resize",this._autosizeCallback):window.removeEventListener("resize",this._autosizeCallback))}_loop(){const t=n=>{if(n&&this.time==n)return void console.log("Multiple calls: "+n);this.time=n,this.frame++;try{this.root.update(Math.min(n-this._lastTime,100)),this.state==e.STATE_PLAYING&&f(t),this._lastTime=n}catch(t){window.console&&console.error(t.stack||t)}};t(this._lastTime)}_resourceLoaded(t){this._loaded++,this.fire("resourcesProgress",this._loaded/this._toLoad),this._toLoad-this._loaded<=0&&this.fire("resourcesLoaded")}_initialiseGeneralObjects(){this._generalObjects||(this._generalObjects=new o.a,this.root.addObjectAt(this._generalObjects,0))}}n.a=l,l.State=e,i.i(u.b)(l,u.c)},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(3),o=i(40),s=i(38),r=i(39),a=i(41);i.d(n,"PropertyAnimationComponent",function(){return e.a}),i.d(n,"PositionAnimationComponent",function(){return o.a}),i.d(n,"BoundsAnimationComponent",function(){return s.a}),i.d(n,"ColorAnimationComponent",function(){return r.a}),i.d(n,"RotationAnimationComponent",function(){return a.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(43);i.d(n,"MoveComponent",function(){return e.a});var o=i(44);i.d(n,"PhysicsComponent",function(){return o.a});var s=i(35);i.d(n,"GravityComponent",function(){return s.a});var r=i(45);i.d(n,"PointGravityComponent",function(){return r.a});var a=i(55);i.d(n,"TerminalVelocityComponent",function(){return a.a});var c=i(42);i.d(n,"FollowComponent",function(){return c.a});var u=i(51);i.d(n,"RotationComponent",function(){
return u.a});var h=i(50);i.d(n,"RotateToHeadingComponent",function(){return h.a});var f=i(56);i.d(n,"TrackRotationComponent",function(){return f.a});var l=i(48);i.d(n,"RandomPositionComponent",function(){return l.a});var d=i(49);i.d(n,"RandomVelocityComponent",function(){return d.a});var p=i(47);i.d(n,"RandomImpulseComponent",function(){return p.a});var v=i(24);i.d(n,"FlockingComponent",function(){return v.a});var m=i(54);i.d(n,"SwitchComponent",function(){return m.a});var y=i(46);i.d(n,"PositionInterpolatorComponent",function(){return y.a});var b=i(52);i.d(n,"SmoothPositionComponent",function(){return b.a});var g=i(53);i.d(n,"SmoothRotationComponent",function(){return g.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(57);i.d(n,"CollisionSystem",function(){return e.a});var o=i(18);i.d(n,"CollisionComponent",function(){return o.a});var s=i(17);i.d(n,"BounceComponent",function(){return s.a});var r=i(36);i.d(n,"BackgroundCollisionSystem",function(){return r.a});var a=i(12);i.d(n,"BackgroundCollisionComponent",function(){return a.a});var c=i(19);i.d(n,"SolidComponent",function(){return c.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(58);i.d(n,"DebugDrawBoundsComponent",function(){return e.a});var o=i(59);i.d(n,"DebugDrawPathComponent",function(){return o.a});var s=i(60);i.d(n,"DebugDrawSurfacesComponent",function(){return s.a});var r=i(61);i.d(n,"DebugFlockingComponent",function(){return r.a});var a=i(62);i.d(n,"PositionRenderComponent",function(){return a.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(5);i.d(n,"InputSystem",function(){return e.a});var o=i(20);i.d(n,"ClickComponent",function(){return o.a});var s=i(14);i.d(n,"MoveToClickComponent",function(){return s.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(6);i.d(n,"CanvasRenderSystem",function(){return e.a});var o=i(21);i.d(n,"DotRenderComponent",function(){return o.a});var s=i(22);i.d(n,"RectangleRenderComponent",function(){return s.a});var r=i(23);i.d(n,"TextRenderComponent",function(){return r.a});var a=i(37);i.d(n,"TileComponent",function(){return a.a}),i.d(n,"SpriteRenderingComponent",function(){return a.b}),i.d(n,"SpriteAnimationComponent",function(){return a.c}),i.d(n,"Sprite",function(){return a.d})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(7);i.d(n,"WorldSystem",function(){return e.a});var o=i(15);i.d(n,"WorldBounceComponent",function(){return o.a});var s=i(16);i.d(n,"WorldWrapComponent",function(){return s.a})},function(t,n,i){var e=i(9),o={};o.create=function(){var t=new e.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.clone=function(t){var n=new e.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},o.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.fromValues=function(t,n,i,o){var s=new e.ARRAY_TYPE(4);return s[0]=t,s[1]=n,s[2]=i,s[3]=o,s},o.set=function(t,n,i,e,o){return t[0]=n,t[1]=i,t[2]=e,t[3]=o,t},o.transpose=function(t,n){if(t===n){var i=n[1];t[1]=n[2],t[2]=i}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},o.invert=function(t,n){var i=n[0],e=n[1],o=n[2],s=n[3],r=i*s-o*e;return r?(r=1/r,t[0]=s*r,t[1]=-e*r,t[2]=-o*r,t[3]=i*r,t):null},o.adjoint=function(t,n){var i=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=i,t},o.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},o.multiply=function(t,n,i){var e=n[0],o=n[1],s=n[2],r=n[3],a=i[0],c=i[1],u=i[2],h=i[3];return t[0]=e*a+s*c,t[1]=o*a+r*c,t[2]=e*u+s*h,t[3]=o*u+r*h,t},o.mul=o.multiply,o.rotate=function(t,n,i){var e=n[0],o=n[1],s=n[2],r=n[3],a=Math.sin(i),c=Math.cos(i);return t[0]=e*c+s*a,t[1]=o*c+r*a,t[2]=e*-a+s*c,t[3]=o*-a+r*c,t},o.scale=function(t,n,i){var e=n[0],o=n[1],s=n[2],r=n[3],a=i[0],c=i[1];return t[0]=e*a,t[1]=o*a,t[2]=s*c,t[3]=r*c,t},o.fromRotation=function(t,n){var i=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=i,t[2]=-i,t[3]=e,t},o.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},o.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},o.LDU=function(t,n,i,e){return t[2]=e[2]/e[0],i[0]=e[0],i[1]=e[1],i[3]=e[3]-t[2]*i[1],[t,n,i]},o.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t},o.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t},o.sub=o.subtract,o.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},o.equals=function(t,n){var i=t[0],o=t[1],s=t[2],r=t[3],a=n[0],c=n[1],u=n[2],h=n[3];return Math.abs(i-a)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(o-c)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-u)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(r-h)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))},o.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t},o.multiplyScalarAndAdd=function(t,n,i,e){return t[0]=n[0]+i[0]*e,t[1]=n[1]+i[1]*e,t[2]=n[2]+i[2]*e,t[3]=n[3]+i[3]*e,t},t.exports=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{update(t,n){"undefined"==typeof t.velocity[1]&&(t.velocity[1]=0),t.velocity[1]+=o.GRAVITATIONAL_CONSTANT*n}}n.a=o,o.GRAVITATIONAL_CONSTANT=3e-4},function(t,n,i){"use strict";var e=i(2);class o extends e.a{constructor(){super(...arguments),this.surfaces=[],this.temporarySurfaces=[]}addSurface(t){this.surfaces.push(t)}addSurfaces(t){for(var n=0;n<t.length;n++)this.surfaces.push(t[n])}clearSurfaces(){this.surfaces.length=0}addTemporarySurface(t){this.temporarySurfaces.push(t)}update(t){super.update(t),this.temporarySurfaces.length=0}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n,i){super(),this.renderSystem=t,this.texture=n,this.bounds=i}update(t,n){for(var i,e=this.renderSystem,o=this.texture,s=this.bounds,r=o.width,a=o.height,c=t.position[0]%r,u=(t.position[1]%a,s[1]),h=s[2],f=s[3],l=function(t,n,i){return function(e){e.drawImage(t.image,n,i)}};u<f+a;u+=a)for(i=s[0]+c-r;i<h+r;i+=r)e.push(l(o,i,u))}}n.a=o;class s extends e.a{constructor(t,n,i){super(),this.renderSystem=t,this.layer=n,this.sprite=i}update(t,n){super.update(n);var i=this.sprite||t.sprite,e=i&&i.t.image;i&&this.renderSystem.push(function(n){var o=t.position[0],s=t.position[1],r=i.w,a=i.h;n.translate(o,s),n.rotate(t.rotation),n.drawImage(e,i.x,i.y,r,a,-i.ox,-i.oy,r,a)},this.layer)}}n.b=s;class r extends e.a{constructor(t,n){super(),this.duration=t,this.spriteIndex=0,this.playing=!0,this.sprites=n}init(t){this.sprites&&(t.sprites=this.sprites),t.sprites.length&&(t.sprite=t.sprites[0]),t.spriteCountdown=t.sprite&&t.sprite.d||this.duration}update(t,n){var i,e,o=t.sprites.length;this.playing&&(t.spriteCountdown-=n,t.spriteCountdown<=0&&(this.spriteIndex=(this.spriteIndex+1)%o,i=t.sprites[this.spriteIndex],t.sprite=i,e=i.d||this.duration,t.spriteCountdown=e))}play(){this.playing=!0}stop(){this.playing=!1,this.spriteIndex=0}pause(){this.playing=!1}}n.c=r;class a{static generateSpriteSheet(t,n,i){var e,o,s=[];for(e=0;e<n;e++)for(o=0;o<i;o++)s.push({t:t.t,x:o*t.w,y:e*t.h,w:t.w,h:t.h,ox:t.ox,oy:t.oy,d:t.d});return s}}n.d=a},function(t,n,i){"use strict";var e=i(3);const o=(t,n)=>{t.setBounds(...n)};class s extends e.a{constructor(t,n,i=undefined,e=undefined){super(o,t,n,i,e)}}n.a=s},function(t,n,i){"use strict";function e(t,n){t.color=`rgba(${0|n[0]}, ${0|n[1]}, ${0|n[2]}, ${n[3]})`}var o=i(3),s=i(10);class r extends o.a{constructor(t,n,o=undefined,r=undefined){super(e,i.i(s.a)(t),i.i(s.a)(n),o,r)}}n.a=r},function(t,n,i){"use strict";var e=i(3);const o=(t,n)=>{t.setPosition(...n)};class s extends e.a{constructor(t,n,i=undefined,e=undefined){super(o,t,n,i,e)}}n.a=s},function(t,n,i){"use strict";var e=i(3);const o=(t,n)=>{t.setRotation(n[0])};class s extends e.a{constructor(t,n,i=undefined,e=undefined,s=undefined){super(o,t,n,i,e,s)}update(t,n){this.end[0]=this.rotation,super.update(t,n)}setRotation(t){this.start[0]=this.rotation,this.end[0]=t,this.reset(),super.setRotation(t)}}n.a=s},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{constructor(t){super(),this.target=t}update(t,n){s.a.add(t.position,this.target.position,this.position)}setTarget(t){this.target=t}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{update(t,n){s.a.scaleAndAdd(t.position,t.position,t.velocity,n)}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{init(t){t.impulse=s.a.create()}update(t,n){s.a.add(t.velocity,t.velocity,t.impulse),s.a.set(t.impulse,0,0,0)}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{constructor(t){super(),this.target=t,this.vector=s.a.create()}update(t,n){s.a.subtract(this.vector,this.target.position,t.position);var i=this.target.mass*n/s.a.squaredLength(this.vector);s.a.normalize(this.vector,this.vector),s.a.scaleAndAdd(t.velocity,t.velocity,this.vector,i)}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o),r=i(8);class a extends e.a{constructor(t,n){super(),this.duration=t,this.easing=n||r.Linear,this.elapsed=0,this.running=!1,this.starting=!1,this.start=s.a.create(),this.position=s.a.create()}update(t,n){if(this.starting&&(isNaN(this.position[0])&&(this.position[0]=t.position[0]),isNaN(this.position[1])&&(this.position[1]=t.position[1]),isNaN(this.position[2])&&(this.position[2]=t.position[2]),s.a.copy(this.start,t.position),this.running=!0,this.starting=!1,this.elapsed=0),this.running){var i=this.elapsed/this.duration,e=this.easing(i);i>1?(s.a.copy(t.position,this.position),this.running=!1):(s.a.lerp(t.position,this.start,this.position,e),this.elapsed+=n)}}setPosition(t,n,i){super.setPosition(t,n,i),this.starting=!0}}n.a=a},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{constructor(t=.001,n=.1){super(),this.probability=t,this.maximumImpulse=n}init(t){t.impulse=t.impulse||s.a.create()}update(t,n){Math.random()<this.probability&&s.a.random(t.impulse,Math.random()*this.maximumImpulse)}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{constructor(t,n=.001){super(),this.world=t,this.probability=n}update(t,n){if(Math.random()<this.probability){const n=this.world.bounds,i=Math.random()*(n[2]-n[0]),e=Math.random()*(n[3]-n[1]),o=Math.random()*(n[5]-n[4]);s.a.set(t.position,i,e,o)}}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{constructor(t=.001,n=.1){super(),this.probability=t,this.maximumVelocity=n}update(t,n){Math.random()<this.probability&&s.a.random(t.velocity,Math.random()*this.maximumVelocity)}}n.a=r},function(t,n,i){"use strict";var e=i(0);class o extends e.a{update(t,n){t.setRotation(Math.atan2(t.velocity[0],-t.velocity[1]))}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t){super(),this.rotationSpeed=t}update(t,n){var i=t.rotationSpeed||this.rotationSpeed||0;t.setRotation(t.rotation+i*n)}}n.a=o},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);const r=s.a.create();class a extends e.a{constructor(){super(),this.speed=.01,this.lastPosition=s.a.create()}update(t,n){super.update(this,n);const i=this.position,e=this.speed;s.a.equals(this.lastPosition,t.position)||s.a.copy(i,t.position),s.a.equals(this.lastPosition,i)||(s.a.subtract(r,i,this.lastPosition),s.a.scaleAndAdd(t.position,this.lastPosition,r,n*e),s.a.copy(this.lastPosition,t.position))}}n.a=a},function(t,n,i){"use strict";var e=i(0);class o extends e.a{update(t,n){if(this.lastRotation!=t.rotation&&(this.rotation=t.rotation),this.rotation!=t.rotation){var i=t.rotation,e=this.rotation,o=e-i,s=.01;o>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),t.rotation=i+o*n*s,this.lastRotation=t.rotation}}}n.a=o},function(t,n,i){"use strict";var e=i(2),o=i(0),s=e.a.prototype.addComponent;class r extends o.a{constructor(t,n){super(),this.positiveComponents=[],this.negativeComponents=[],this.active=!0,this.object=t,this.prop=n}addComponent(t){this.components=this.positiveComponents,s.call(this,t),this.components=void 0}addPositiveComponent(t){this.components=this.positiveComponents,s.call(this,t),this.components=void 0}addNegativeComponent(t){this.components=this.negativeComponents,s.call(this,t),this.components=void 0}addComponents(t,n){t.forEach(this.addPositiveComponent.bind(this)),n.forEach(this.addNegativeComponent.bind(this))}flip(){this.setActive(!this.active)}setActive(t){this.active=t,this.object&&(this.object[this.prop]=this.active)}update(t,n){var i,e=0;if(this.object&&(this.active=this.object[this.prop]),this.active)for(i=this.positiveComponents.length;e<i;e++)this.positiveComponents[e].update(t,n);else for(i=this.negativeComponents.length;e<i;e++)this.negativeComponents[e].update(t,n)}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1),s=i.n(o);class r extends e.a{constructor(t){super(),this.velocityMagnitude=t}update(t,n){const i=s.a.length(t.velocity);if(i>this.velocityMagnitude){const n=this.velocityMagnitude/i;s.a.scale(t.velocity,t.velocity,n)}}}n.a=r},function(t,n,i){"use strict";var e=i(0),o=i(1);i.n(o);class s extends e.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=this.target.rotation+this.rotation}}n.a=s},function(t,n,i){"use strict";var e=i(2);class o extends e.a{constructor(){super(),this.attackObjects=[],this.vulnerableObjects=[]}addAttackObject(t){this.attackObjects.push(t)}addVulnerableObject(t){this.vulnerableObjects.push(t)}update(t){const n=this.attackObjects.length,i=this.vulnerableObjects.length;for(let e=0;e<n;e++){const t=this.attackObjects[e],n=t.position[0],o=t.position[1],s=t.bounds,r=[n+s[0],o+s[1],n+s[2],o+s[3]];for(let a=0;a<i;a++){const n=this.vulnerableObjects[a],i=n.position[0],e=n.position[1],o=n.bounds,s=[i+o[0],e+o[1],i+o[2],e+o[3]];t!==n&&r[0]<s[2]&&r[1]<s[3]&&r[2]>s[0]&&r[3]>s[1]&&(t.fire("attack",n),n.fire("attackedBy",t))}}this.attackObjects.length=0,this.vulnerableObjects.length=0}}n.a=o},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t){super(),this.renderSystem=t}update(t,n){const i=t.bounds;i&&this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.rect(t.bounds[0],t.bounds[1],t.bounds[2]-t.bounds[0],t.bounds[3]-t.bounds[1]),n.strokeStyle="#000",n.stroke()})}}n.a=o},function(t,n,i){"use strict";var e=(i(2),i(0)),o=i(4);i.n(o);const s=1e3;class r extends e.a{constructor(t){super(),this.path=[],this.currIndex=0,this.lastVx=0,this.lastVy=0,this.renderSystem=t,this.path.length=s}update(t,n){const i=t.position[0],e=t.position[1],o=t.velocity[0],r=t.velocity[1],a=(o-this.lastVx)/n,c=(r-this.lastVy)/n,u=this.path,h=(this.currIndex-2+s)%s,f=Math.abs(u[h]-i),l=Math.abs(u[h+1]-e);(f>100||l>100)&&(u[this.currIndex]=NaN,u[this.currIndex+1]=NaN,this.currIndex=(this.currIndex+2)%s),u[this.currIndex]=i,u[this.currIndex+1]=e,this.renderSystem.push(t=>{t.beginPath(),t.moveTo(u[this.currIndex],u[this.currIndex+1]);for(let n=2;n<s;n+=2){let i=(this.currIndex+n)%s;u[i]?t.lineTo(u[i],u[i+1]):(n+=2,i=(this.currIndex+n)%s,t.moveTo(u[i],u[i+1]))}t.strokeStyle="#CCC",t.stroke()}),this.currIndex=(this.currIndex+2)%s,this.renderSystem.strokePath([i,e,i+100*o,e+100*r],"rgba(0,128,255,0.7)",0),this.renderSystem.strokePath([i,e,i+4e5*a,e+4e5*c],"rgba(0,255,0,0.7)",0),this.lastVx=o,this.lastVy=r}}n.a=r},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n){super(),this.renderSystem=t,this.colour=n||"#000"}update(t,n){for(var i,e,o,s=t.surfaces,r=0,a=s.length;r<a;r++)this.renderSystem.strokePath(s[r],t.colour||this.colour);for(r=0;r<a;r++)for(e=t.surfaces[r],o=e.length,i=0;i<o-3;i+=2){var c=e[i],u=e[i+1],h=e[i+2],f=e[i+3],l=h-c,d=f-u,p=c+.5*l,v=u+.5*d,m=d/Math.sqrt(d*d+l*l),y=-l/Math.sqrt(d*d+l*l);this.renderSystem.strokePath([p,v,p+30*m,v+30*y],"#08f")}}}n.a=o},function(t,n,i){"use strict";var e=i(0),o=i(24);class s extends e.a{constructor(t){super(),this.renderSystem=t}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.arc(0,0,o.a.NEIGHBOUR_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#008",n.stroke(),n.beginPath(),n.arc(0,0,o.a.SEPARATION_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#800",n.stroke()})}}n.a=s},function(t,n,i){"use strict";var e=i(0);class o extends e.a{constructor(t,n="10px sans-serif",i="#000"){super(),this.renderSystem=t,this.font=n,this.color=i,this.size=parseInt(n,10)}update(t,n){const i=t.position,e=this.size;this.renderSystem.push(t=>{t.translate(i[0],i[1]),t.strokeStyle="#888",t.lineWidth=2,t.beginPath(),t.moveTo(-e,0),t.lineTo(e,0),t.moveTo(0,-e),t.lineTo(0,e),t.stroke(),t.fillStyle=this.color,t.font=this.font,t.fillText(`${0|i[0]}, ${0|i[1]}`,e/2,-e/2)})}}n.a=o},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i(2);i.d(n,"GameObject",function(){return e.a});var o=i(13);i.d(n,"GameObjectManager",function(){return o.a});var s=i(0);i.d(n,"GameComponent",function(){return s.a});var r=i(11);i.d(n,"CameraSystem",function(){return r.a});var a=i(6);i.d(n,"CanvasRenderSystem",function(){return a.a});var c=i(7);i.d(n,"WorldSystem",function(){return c.a});var u=i(5);i.d(n,"InputSystem",function(){return u.a});var h=i(25);i.d(n,"AudioSystem",function(){return h.a});var f=i(26);i.d(n,"Game",function(){return f.a});var l=i(28),d=i(27),p=i(8);i.d(n,"Easing",function(){return p});var v=i(33);i.d(n,"World",function(){return v});var m=i(15),y=i(16),b=i(31);i.d(n,"Input",function(){return b});var g=i(20),M=i(14),S=i(29);i.d(n,"Collision",function(){return S});var A=i(18),I=i(17),C=i(12),_=i(19),E=i(32);i.d(n,"Render",function(){return E});var w=i(21),P=i(22),x=i(23),T=i(30);i.d(n,"Debug",function(){return T});const R={};n.Components=R;for(let O in l)R[O]=l[O];for(let O in d)R[O]=d[O];R.WorldBounceComponent=m.a,R.WorldWrapComponent=y.a,R.ClickComponent=g.a,R.MoveToClickComponent=M.a,R.CollisionComponent=A.a,R.BounceComponent=I.a,R.BackgroundCollisionComponent=C.a,R.SolidComponent=_.a,R.DotRenderComponent=w.a,R.RectangleRenderComponent=P.a,R.TextRenderComponent=x.a}])});
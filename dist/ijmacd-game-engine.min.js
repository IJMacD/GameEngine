!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.IGE=n():t.IGE=n()}(this,function(){return function(t){function n(i){if(a[i])return a[i].exports;var e=a[i]={i:i,l:!1,exports:{}};return t[i].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var a={};return n.m=t,n.c=a,n.i=function(t){return t},n.d=function(t,a,i){n.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(a,"a",a),a},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=50)}([function(t,n,a){"use strict";var i=a(1);class e extends i.a{init(t){}update(t,n){}toHTML(){return this.name}}e.create=function(t,n){t.prototype=new e;for(var a in n)t.prototype[a]=n[a];var i=t.name;return i||(i=t.toString().match(/^function ([a-z_]+)/i)[1],t.name=i),t},n.a=e},function(t,n,a){"use strict";function i(t,n){var a=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,a)}function e(t){return t instanceof Function}var o=a(2),s=a.n(o),r=a(9);class u{constructor(){this.components=[],this.components.remove=i,this.position=s.a.create(),this.velocity=s.a.create(),this.rotation=0,this.rotationAxis=s.a.fromValues(0,0,1),this._toBeRemoved=[]}addComponent(t){return e(t)&&(t={update:t}),this.components.push(t),t.init&&t.init(this),this}removeComponent(t){return this._toBeRemoved.push(t),this}removeComponentByName(t){for(var n=0;n<this.components.length;n++){const a=this.components[n];a.name!=t&&a.constructor.name!=t||this._toBeRemoved.push(a)}return this}removeComponentByTest(t){for(var n=0;n<this.components.length;n++)t(this.components[n])&&this._toBeRemoved.push(this.components[n]);return this}setPosition(t,n,a){return void 0==t&&(t=this.position[0]),void 0==n&&(n=this.position[1]),void 0==a&&(a=this.position[2]),s.a.set(this.position,t,n,a),this}setVelocity(t,n,a){return void 0==t&&(t=this.velocity[0]),void 0==n&&(n=this.velocity[1]),void 0==a&&(a=this.velocity[2]),s.a.set(this.velocity,t,n,a),this}setBounds(...t){return this.bounds=t,this}setRotation(t,n){return this.rotation=t,n&&3==n.length&&s.a.normalize(this.rotationAxis,n),this}hit(t){null==this.hitVictim&&(this.hitVictim=t)}hitBy(t){null==this.attackerHit&&(this.attackerHit=t)}update(t){for(var n=0,a=this.components.length,i=0,e=this._toBeRemoved.length;i<e;i++)for(n=0;n<a;n++)if(this.components[n]==this._toBeRemoved[i]){this.components.remove(n);break}for(this._toBeRemoved.length=0,a=this.components.length,n=0;n<a;n++)this.components[n].update(this,t)}toHTML(){var t,n=this.name;if("number"==typeof this.position.x&&(n+=" "+this.position),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}return n}}n.a=u,a.i(r.b)(u)},function(t,n,a){var i=a(3),e={};e.create=function(){var t=new i.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},e.clone=function(t){var n=new i.ARRAY_TYPE(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},e.fromValues=function(t,n,a){var e=new i.ARRAY_TYPE(3);return e[0]=t,e[1]=n,e[2]=a,e},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},e.set=function(t,n,a,i){return t[0]=n,t[1]=a,t[2]=i,t},e.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t},e.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t},e.sub=e.subtract,e.multiply=function(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t},e.mul=e.multiply,e.divide=function(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t},e.div=e.divide,e.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},e.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},e.min=function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t},e.max=function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t},e.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},e.scale=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t},e.scaleAndAdd=function(t,n,a,i){return t[0]=n[0]+a[0]*i,t[1]=n[1]+a[1]*i,t[2]=n[2]+a[2]*i,t},e.distance=function(t,n){var a=n[0]-t[0],i=n[1]-t[1],e=n[2]-t[2];return Math.sqrt(a*a+i*i+e*e)},e.dist=e.distance,e.squaredDistance=function(t,n){var a=n[0]-t[0],i=n[1]-t[1],e=n[2]-t[2];return a*a+i*i+e*e},e.sqrDist=e.squaredDistance,e.length=function(t){var n=t[0],a=t[1],i=t[2];return Math.sqrt(n*n+a*a+i*i)},e.len=e.length,e.squaredLength=function(t){var n=t[0],a=t[1],i=t[2];return n*n+a*a+i*i},e.sqrLen=e.squaredLength,e.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},e.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},e.normalize=function(t,n){var a=n[0],i=n[1],e=n[2],o=a*a+i*i+e*e;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t},e.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},e.cross=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=a[0],r=a[1],u=a[2];return t[0]=e*u-o*r,t[1]=o*s-i*u,t[2]=i*r-e*s,t},e.lerp=function(t,n,a,i){var e=n[0],o=n[1],s=n[2];return t[0]=e+i*(a[0]-e),t[1]=o+i*(a[1]-o),t[2]=s+i*(a[2]-s),t},e.hermite=function(t,n,a,i,e,o){var s=o*o,r=s*(2*o-3)+1,u=s*(o-2)+o,h=s*(o-1),c=s*(3-2*o);return t[0]=n[0]*r+a[0]*u+i[0]*h+e[0]*c,t[1]=n[1]*r+a[1]*u+i[1]*h+e[1]*c,t[2]=n[2]*r+a[2]*u+i[2]*h+e[2]*c,t},e.bezier=function(t,n,a,i,e,o){var s=1-o,r=s*s,u=o*o,h=r*s,c=3*o*r,l=3*u*s,f=u*o;return t[0]=n[0]*h+a[0]*c+i[0]*l+e[0]*f,t[1]=n[1]*h+a[1]*c+i[1]*l+e[1]*f,t[2]=n[2]*h+a[2]*c+i[2]*l+e[2]*f,t},e.random=function(t,n){n=n||1;var a=2*i.RANDOM()*Math.PI,e=2*i.RANDOM()-1,o=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(a)*o,t[1]=Math.sin(a)*o,t[2]=e*n,t},e.transformMat4=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=a[3]*i+a[7]*e+a[11]*o+a[15];return s=s||1,t[0]=(a[0]*i+a[4]*e+a[8]*o+a[12])/s,t[1]=(a[1]*i+a[5]*e+a[9]*o+a[13])/s,t[2]=(a[2]*i+a[6]*e+a[10]*o+a[14])/s,t},e.transformMat3=function(t,n,a){var i=n[0],e=n[1],o=n[2];return t[0]=i*a[0]+e*a[3]+o*a[6],t[1]=i*a[1]+e*a[4]+o*a[7],t[2]=i*a[2]+e*a[5]+o*a[8],t},e.transformQuat=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=a[0],r=a[1],u=a[2],h=a[3],c=h*i+r*o-u*e,l=h*e+u*i-s*o,f=h*o+s*e-r*i,M=-s*i-r*e-u*o;return t[0]=c*h+M*-s+l*-u-f*-r,t[1]=l*h+M*-r+f*-s-c*-u,t[2]=f*h+M*-u+c*-r-l*-s,t},e.rotateX=function(t,n,a,i){var e=[],o=[];return e[0]=n[0]-a[0],e[1]=n[1]-a[1],e[2]=n[2]-a[2],o[0]=e[0],o[1]=e[1]*Math.cos(i)-e[2]*Math.sin(i),o[2]=e[1]*Math.sin(i)+e[2]*Math.cos(i),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},e.rotateY=function(t,n,a,i){var e=[],o=[];return e[0]=n[0]-a[0],e[1]=n[1]-a[1],e[2]=n[2]-a[2],o[0]=e[2]*Math.sin(i)+e[0]*Math.cos(i),o[1]=e[1],o[2]=e[2]*Math.cos(i)-e[0]*Math.sin(i),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},e.rotateZ=function(t,n,a,i){var e=[],o=[];return e[0]=n[0]-a[0],e[1]=n[1]-a[1],e[2]=n[2]-a[2],o[0]=e[0]*Math.cos(i)-e[1]*Math.sin(i),o[1]=e[0]*Math.sin(i)+e[1]*Math.cos(i),o[2]=e[2],t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},e.forEach=function(){var t=e.create();return function(n,a,i,e,o,s){var r,u;for(a||(a=3),i||(i=0),u=e?Math.min(e*a+i,n.length):n.length,r=i;r<u;r+=a)t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],o(t,t,s),n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2];return n}}(),e.angle=function(t,n){var a=e.fromValues(t[0],t[1],t[2]),i=e.fromValues(n[0],n[1],n[2]);e.normalize(a,a),e.normalize(i,i);var o=e.dot(a,i);return o>1?0:Math.acos(o)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},e.equals=function(t,n){var a=t[0],e=t[1],o=t[2],s=n[0],r=n[1],u=n[2];return Math.abs(a-s)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(e-r)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(o-u)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},t.exports=e},function(t,n){var a={};a.EPSILON=1e-6,a.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,a.RANDOM=Math.random,a.ENABLE_SIMD=!1,a.SIMD_AVAILABLE=a.ARRAY_TYPE===Float32Array&&"SIMD"in this,a.USE_SIMD=a.ENABLE_SIMD&&a.SIMD_AVAILABLE,a.setMatrixArrayType=function(t){a.ARRAY_TYPE=t};var i=Math.PI/180;a.toRadian=function(t){return t*i},a.equals=function(t,n){return Math.abs(t-n)<=a.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))},t.exports=a},function(t,n,a){"use strict";var i=a(0),e=a(11);class o extends i.a{constructor(t,n,a,i=1e3,o=e["Linear"]){super(),this.outputter=t,this.start=n,this.end=a,this.duration=i,this.easing=o,this.elapsed=0,this.direction=1,this.out=[]}update(t,n){const a=this.easing(this.elapsed/this.duration),i=this.start[0],e=this.start[1],o=this.start[2],s=this.start[3];this.out[0]=i+a*(this.end[0]-i),this.out[1]=e+a*(this.end[1]-e),this.out[2]=o+a*(this.end[2]-o),this.out[3]=s+a*(this.end[3]-s),this.outputter(t,this.out),this.elapsed+=n*this.direction,(this.elapsed>this.duration||this.elapsed<0)&&(this.direction*=-1,this.elapsed=Math.min(Math.max(this.elapsed,0),this.duration))}}n.a=o},function(t,n,a){"use strict";function i(){o(this.screen,t=>{const n=this.screen.offsetLeft,a=this.screen.offsetTop,i=t.touches&&t.touches[0],e=(i?i.pageX:t.pageX)-n,o=(i?i.pageY:t.pageY)-a;u.a.copy(this._nextClick,this.screenToWorld(e,o))})}function e(){this.keyboard.addEventListener("keydown",t=>{this._nextKey=t.which})}function o(t,n){const a=function(t){return t.stopPropagation(),t.preventDefault(),t.handled!==!0&&(n(t),void(t.handled=!0))};t.removeEventListener("touchstart",t.touchClick),t.removeEventListener("click",t.touchClick),t.addEventListener("touchstart",a),t.addEventListener("click",a),t.touchClick=a}var s=a(1),r=a(8),u=a.n(r),h=a(34),c=a.n(h);const l=u.a.create(),f=c.a.create();class M extends s.a{constructor(t,n,a){super(),this.screen=t,this.keyboard=n,this.cameraSystem=a,this._nextClick=u.a.create(),this.lastClick=u.a.create(),this.hasClick=!1,this._nextKey=null,this.lastKey=null,i.call(this),e.call(this)}update(t){super.update(t),u.a.copy(this.lastClick,this._nextClick),u.a.set(this._nextClick,NaN,NaN),this.hasClick=!isNaN(this.lastClick[0]),this.lastKey=this._nextKey,this._nextKey=null}setScreen(t){this.screen=t,i.call(this)}screenToWorld(t,n){const a=this.cameraSystem,i=a.width,e=(a.height,this.screen),o=e.offsetWidth,s=e.offsetHeight,r=i/o;return u.a.set(l,t-o/2,n-s/2),u.a.scale(l,l,r),u.a.set(l,l[0]/a.scaleX,l[1]/a.scaleY),1==a.rotationAxis[2]&&(c.a.rotate(f,f,-a.rotation),u.a.transformMat2(l,l,f)),u.a.add(l,l,a.position),l}}n.a=M,M.Keys={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90}},function(t,n,a){"use strict";function i(t,n){const{context,renderQueue}=t,a=renderQueue[n];if(a){for(let n=0,i=a.length;n<i;n++)context.save(),a[n].call(t,context),context.restore();a.length=0}}var e=a(1);a(0);class o extends e.a{constructor(t,n){super(),this.context=t,this.canvas=t&&t.canvas,this.cameraSystem=n,this.renderQueue=[],this.clearScreen=!0}push(t,n){n=void 0==n?1:n,this.renderQueue[n]||(this.renderQueue[n]=[]),this.renderQueue[n].push(t)}update(t){this.clearScreen&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save();var n,a,e=this.cameraSystem.position,o=this.canvas.width/2,s=this.canvas.height/2;for(this.context.translate(o,s),this.context.scale(this.cameraSystem.scaleX,this.cameraSystem.scaleY),1==this.cameraSystem.rotationAxis[2]&&this.context.rotate(-this.cameraSystem.rotation),this.context.translate(-e[0],-e[1]),n=0,a=this.renderQueue.length;n<a;n++)i(this,n);this.context.restore(),i(this,-1)}drawPath(t,n){var a=2,i=n.length;for(t.beginPath(),t.moveTo(n[0],n[1]);a<i-1;a+=2)t.lineTo(n[a],n[a+1])}strokePath(t,n,a){"undefined"==typeof n&&(n="#000"),"undefined"==typeof a&&(a=1),this.push(function(a){a.strokeStyle=n,this.drawPath(a,t),a.stroke()},a)}}n.a=o},function(t,n,a){"use strict";var i=a(1);class e extends i.a{constructor(t){super(),this.bounds=t}}n.a=e},function(t,n,a){var i=a(3),e={};e.create=function(){var t=new i.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},e.clone=function(t){var n=new i.ARRAY_TYPE(2);return n[0]=t[0],n[1]=t[1],n},e.fromValues=function(t,n){var a=new i.ARRAY_TYPE(2);return a[0]=t,a[1]=n,a},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},e.set=function(t,n,a){return t[0]=n,t[1]=a,t},e.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t},e.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t},e.sub=e.subtract,e.multiply=function(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t},e.mul=e.multiply,e.divide=function(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t},e.div=e.divide,e.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},e.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},e.min=function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t},e.max=function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t},e.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},e.scale=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t},e.scaleAndAdd=function(t,n,a,i){return t[0]=n[0]+a[0]*i,t[1]=n[1]+a[1]*i,t},e.distance=function(t,n){var a=n[0]-t[0],i=n[1]-t[1];return Math.sqrt(a*a+i*i)},e.dist=e.distance,e.squaredDistance=function(t,n){var a=n[0]-t[0],i=n[1]-t[1];return a*a+i*i},e.sqrDist=e.squaredDistance,e.length=function(t){var n=t[0],a=t[1];return Math.sqrt(n*n+a*a)},e.len=e.length,e.squaredLength=function(t){var n=t[0],a=t[1];return n*n+a*a},e.sqrLen=e.squaredLength,e.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},e.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},e.normalize=function(t,n){var a=n[0],i=n[1],e=a*a+i*i;return e>0&&(e=1/Math.sqrt(e),t[0]=n[0]*e,t[1]=n[1]*e),t},e.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},e.cross=function(t,n,a){var i=n[0]*a[1]-n[1]*a[0];return t[0]=t[1]=0,t[2]=i,t},e.lerp=function(t,n,a,i){var e=n[0],o=n[1];return t[0]=e+i*(a[0]-e),t[1]=o+i*(a[1]-o),t},e.random=function(t,n){n=n||1;var a=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(a)*n,t[1]=Math.sin(a)*n,t},e.transformMat2=function(t,n,a){var i=n[0],e=n[1];return t[0]=a[0]*i+a[2]*e,t[1]=a[1]*i+a[3]*e,t},e.transformMat2d=function(t,n,a){var i=n[0],e=n[1];return t[0]=a[0]*i+a[2]*e+a[4],t[1]=a[1]*i+a[3]*e+a[5],t},e.transformMat3=function(t,n,a){var i=n[0],e=n[1];return t[0]=a[0]*i+a[3]*e+a[6],t[1]=a[1]*i+a[4]*e+a[7],t},e.transformMat4=function(t,n,a){var i=n[0],e=n[1];return t[0]=a[0]*i+a[4]*e+a[12],t[1]=a[1]*i+a[5]*e+a[13],t},e.forEach=function(){var t=e.create();return function(n,a,i,e,o,s){var r,u;for(a||(a=2),i||(i=0),u=e?Math.min(e*a+i,n.length):n.length,r=i;r<u;r+=a)t[0]=n[r],t[1]=n[r+1],o(t,t,s),n[r]=t[0],n[r+1]=t[1];return n}}(),e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]},e.equals=function(t,n){var a=t[0],e=t[1],o=n[0],s=n[1];return Math.abs(a-o)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(e-s)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))},t.exports=e},function(t,n,a){"use strict";function i(t){let n=t.match(o)||t.match(s);if(n){const t=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1];return t.format="hex",t}if(n=t.match(r)){const t=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return t.format="rgb",t}}function e(t){function n(t,n){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),this._events[t].push(n),this}function a(t,...n){this._events||(this._events={});var a=this._events[t];a&&a.length&&a.forEach(t=>{t.apply(this,n)})}t.prototype.on=n,t.prototype.fire=a}n.a=i,n.b=e;const o=/#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i,s=/#([0-9a-f])([0-9a-f])([0-9a-f])/i,r=/rgba?\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(?:,(0(?:.\d+)|1(?:.0)?))?\)/},function(t,n,a){"use strict";var i=a(1),e=a(2),o=a.n(e);class s extends i.a{constructor(){super(),this.pruneList=[],this.suspendedObjects=[],this.skewX=this.skew,this.skeyY=this.skew,this.scaleX=1,this.scaleY=1,this.rotation=0,this.rotationAxis=o.a.create(),o.a.set(this.rotationAxis,0,0,1)}setScale(t,n){n=n||t,this.scaleX=t,this.scaleY=n}setSize(t,n){this.width=t,this.height=n}addManagerForPruning(t){t instanceof GameObjectManager&&this.pruneList.push(t)}getTransformMatrix(){return this.transformMatrix}update(t){super.update(t)}}n.a=s},function(t,n,a){"use strict";function i(t){var n=1.70158;return t*t*((n+1)*t-n)}function e(t){var n=1.70158;return t-=1,t*t*((n+1)*t+n)+1}function o(t){var n=2.5949095;return t*=2,t<1?Math.pow(t,2)*((n+1)*t-n)/2:(t-=2,(Math.pow(t,2)*((n+1)*t+n)+2)/2)}function s(t){if(0==t||1==t)return t;var n=.3,a=n/4;return t-=1,-1*Math.pow(2,10*t)*Math.sin((t-a)*(2*Math.PI)/n)}function r(t){if(0==t||1==t)return t;var n=.3,a=n/4;return Math.pow(2,-10*t)*Math.sin((t-a)*(2*Math.PI)/n)+1}function u(t){if(0==t)return 0;if(t*=2,2==t)return 1;var n=.3*1.5,a=n/4;return t<1?(t-=1,-.5*(Math.pow(2,10*t)*Math.sin((t-a)*(2*Math.PI)/n))):(t-=1,.5*(Math.pow(2,-10*t)*Math.sin((t-a)*(2*Math.PI)/n))+1)}Object.defineProperty(n,"__esModule",{value:!0}),n.BackIn=i,n.BackOut=e,n.BackInOut=o,n.ElasticIn=s,n.ElasticOut=r,n.ElasticInOut=u;const h=t=>t;n.Linear=h;const c=t=>t*t;n.QuadIn=c;const l=t=>-t*(t-2);n.QuadOut=l;const f=t=>1-Math.sqrt(1-t*t);n.CircIn=f;const M=t=>Math.sqrt(1-(t-1)*(t-1));n.CircOut=M;const d=t=>t*t*(3-2*t);n.Smooth=d;const m=t=>-1*Math.cos(t*(Math.PI/2))+1;n.SineIn=m;const p=t=>Math.sin(t*(Math.PI/2));n.SineOut=p;const S=t=>-1*(Math.cos(Math.PI*t)-1)/2;n.SineInOut=S},function(t,n,a){"use strict";function i(t,n){return t[0]*n[1]-t[1]*n[0]}var e=a(0),o=a(8),s=a.n(o);const r=s.a.create(),u=s.a.create(),h=s.a.create(),c=s.a.create(),l=s.a.create(),f=s.a.create(),M=s.a.create(),d=s.a.create(),m=s.a.create();class p extends e.a{constructor(t,n){super(),this.backgroundSystem=t,this.bounds=n,this.coefficientFriction=p.COEFFICIENT_FRICTION,this.coefficientRestitution=p.COEFFICIENT_RESTITUTION}update(t,n){var a,e,o,p,S,v=this.backgroundSystem.surfaces,I=0,x=v.length,D=this.coefficientFriction,b=this.coefficientRestitution,F=t.position[0],y=t.position[1];if(this.lastX&&Math.abs(this.lastX-F)<100&&Math.abs(this.lastY-y)<100)for(;I<x;I++)for(a=v[I],e=a.length,o=0;o<e-3;o+=2)if(s.a.set(c,a[o],a[o+1]),s.a.set(l,a[o+2],a[o+3]),s.a.subtract(l,l,c),s.a.set(f,this.lastX,this.lastY),s.a.subtract(M,t.position,f),s.a.subtract(d,f,c),p=i(d,M)/i(l,M),S=i(d,l)/i(l,M),p>=0&&p<=1&&S>=0&&S<=1){t.position[0]=this.lastX,t.position[1]=this.lastY,s.a.set(u,-l[1],l[0]),s.a.normalize(u,u),s.a.copy(m,t.velocity),s.a.scale(r,u,s.a.dot(u,m)),s.a.subtract(h,m,r),s.a.scale(h,h,D),s.a.scale(r,r,b),s.a.subtract(t.velocity,h,r);break}this.lastX=t.position[0],this.lastY=t.position[1]}}p.COEFFICIENT_FRICTION=.95,p.COEFFICIENT_RESTITUTION=.4,n.a=p},function(t,n,a){"use strict";var i=a(0),e=a(2),o=a.n(e);const s=o.a.create(),r=o.a.create(),u=o.a.create(),h=o.a.create(),c=o.a.create();class l extends i.a{constructor(){super(),this.cRestitution=.9}init(t){t.on("attack",n=>{const a=t.bounds[2]-t.bounds[0],i=t.bounds[3]-t.bounds[1],e=n.bounds[2]-n.bounds[0],l=n.bounds[3]-n.bounds[1],f=(a+i)/2,M=(e+l)/2,d=(f+M)/2,m=o.a.dist(t.position,n.position);if(m<d){o.a.subtract(s,t.position,n.position),o.a.scale(r,s,(d-m)/m);const a=1/(t.mass||1),i=1/(n.mass||1);o.a.scaleAndAdd(t.position,t.position,r,a/(a+i)),o.a.scaleAndAdd(n.position,n.position,r,-i/(a+i)),o.a.subtract(u,t.velocity,n.velocity),o.a.normalize(h,r);const e=o.a.dot(u,h);if(e>0)return;const l=-(1+this.cRestitution)*e/(a+i);o.a.scale(c,h,l),o.a.scaleAndAdd(t.velocity,t.velocity,c,a),o.a.scaleAndAdd(n.velocity,n.velocity,c,-i)}})}}n.a=l},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n,a){super(),this.collisionSystem=t,this.attack=n,this.vulnerable=a}update(t,n){this.attack&&this.collisionSystem.addAttackObject(t),this.vulnerable&&this.collisionSystem.addVulnerableObject(t)}}n.a=e},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n){super(),this.backgroundSystem=t,this.segments=n}update(t,n){for(var a,i,e,o,s=[],r=0,u=this.segments.length;r<u;r++){for(e=this.segments[r],i=e.length-1,o=[],a=0;a<i;a+=2)o.push(e[a]+t.position.x,e[a+1]+t.position.y);s.push(o)}this.backgroundSystem.addTemporarySurfaces(s)}}n.a=e},function(t,n,a){"use strict";function i(t,n){var a=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,a)}var e=a(1);class o extends e.a{constructor(){super(),this.objects=[],this.objectsToBeRemoved=[],this.objects.remove=i}addObject(t){return t instanceof e.a&&this.objects.push(t),t.parent=this,this}addObjectAt(t,n){return n instanceof e.a&&this.objects.splice(t,0,n),n.parent=this,this}removeObject(t){return t instanceof e.a&&this.objectsToBeRemoved.push(t),t.parent==this&&(t.parent=null),this}removeAll(){this.objects.length=0}update(t){e.a.prototype.update.call(this,t);var n,a=0,i=this.objects.length,o=0;for(a=0;a<i;a++)this.objects[a].update(t);for(n=this.objectsToBeRemoved.length;o<n;o++)for(a=0;a<i;a++)if(this.objects[a]==this.objectsToBeRemoved[o]){this.objects.remove(a),i--;break}this.objectsToBeRemoved.length=0}toHTML(){var t,n=this.name;if(this.objects.length>1&&(n+=" ("+this.objects.length+" items)"),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}if(this.objects.length){for(n+="<ul>",t=0;t<this.objects.length;t++)n+="<li>"+this.objects[t].toHTML();n+="</ul>"}return n}}n.a=o},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t){super(),this.inputSystem=t}update(t,n){if(t.bounds&&this.inputSystem.hasClick){const n=this.inputSystem.lastClick,a=t.position,i=t.bounds;i[0]+a[0]<n[0]&&i[1]+a[1]<n[1]&&i[2]+a[0]>n[0]&&i[3]+a[1]>n[1]&&this.fire("click",t)}}}n.a=e},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const a=t.bounds,i=t.position,e=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(i[0],i[1]),a?t.scale(a[2]-a[0],a[3]-a[1]):e&&t.scale(e,e),t.arc(0,0,.5,0,2*Math.PI,!1),t.fill()})}}n.a=e},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const a=t.bounds,i=t.position,e=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(i[0],i[1]),a?t.rect(a[0],a[1],a[2]-a[0],a[3]-a[1]):e&&t.rect(-e/2,-e/2,e,e),t.fill()})}}n.a=e},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n,a,i,e="10px sans-serif",o="#000"){super(),this.renderSystem=t,this.text=n,this.font=e,this.color=o,this.setPosition(a,i)}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.translate(this.position[0],this.position[1]),n.fillStyle=this.color,n.font=this.font,n.fillText(this.text,0,0)})}}n.a=e},function(t,n,a){"use strict";var i=a(1),e=a(2),o=a.n(e),s=a(24),r=a.n(s);class u extends i.a{constructor(t,n,a,i,e){super(),this.context=t,this.canvasWidth=n,this.canvasHeight=a,this.cameraSystem=i,this.shaderProgram=e,this.mvMatrix=r.a.create(),this.pMatrix=r.a.create(),this.renderQueue=[],this.spareVector=o.a.create(),this.ambientLight=.3,this.pointLighting=1.4}push(t){this.renderQueue.push(t)}update(t){var n,a,i=this.context,e=this.cameraSystem;for(i.viewport(0,0,i.viewportWidth,i.viewportHeight),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),r.a.perspective(this.pMatrix,45*Math.PI/180,i.viewportWidth/i.viewportHeight,.1,1e4),r.a.translate(this.pMatrix,this.pMatrix,o.a.negate(this.spareVector,e.position)),e.rotation&&e.rotationAxis&&r.a.rotate(this.pMatrix,this.pMatrix,e.rotation,e.rotationAxis),i.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),n=0,a=this.renderQueue.length;n<a;n++)r.a.identity(this.mvMatrix),this.renderQueue[n].call(this,this.context,this.mvMatrix);this.renderQueue.length=0}setCanvasSize(t,n){this.canvasWidth=t,this.canvasHeight=n}}n.a=u},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n,a,i){super(),this.worldSystem=t,this.ax=(n||0)/2,this.ay=(a||0)/2,this.az=(i||0)/2,this.cRestitution=1,this.cFriction=1}update(t,n){var a=this.cRestitution,i=this.cFriction;t.bounds?(this.bx1=this.worldSystem.bounds[0]-t.bounds[0],this.by1=this.worldSystem.bounds[1]-t.bounds[1],this.bx2=this.worldSystem.bounds[2]-t.bounds[2],this.by2=this.worldSystem.bounds[3]-t.bounds[3],this.bz1=this.worldSystem.bounds[4]-t.bounds[4],this.bz2=this.worldSystem.bounds[5]-t.bounds[5]):(this.bx1=this.worldSystem.bounds[0]+this.ax,this.by1=this.worldSystem.bounds[1]+this.ay,this.bx2=this.worldSystem.bounds[2]-this.ax,this.by2=this.worldSystem.bounds[3]-this.ay,this.bz1=this.worldSystem.bounds[4]+this.az,this.bz2=this.worldSystem.bounds[5]-this.az),t.hasBounced=!1,t.position[0]<this.bx1?(t.position[0]=this.bx1,t.velocity[0]=-t.velocity[0]*a,t.velocity[1]=t.velocity[1]*i,t.velocity[2]=t.velocity[2]*i,t.hasBounced=1):t.position[0]>this.bx2&&(t.position[0]=this.bx2,t.velocity[0]=-t.velocity[0]*a,t.velocity[1]=t.velocity[1]*i,t.velocity[2]=t.velocity[2]*i,t.hasBounced=1),t.position[1]<this.by1?(t.position[1]=this.by1,t.velocity[1]=-t.velocity[1]*a,t.velocity[0]=t.velocity[0]*i,t.velocity[2]=t.velocity[2]*i,t.hasBounced=2):t.position[1]>this.by2&&(t.position[1]=this.by2,t.velocity[1]=-t.velocity[1]*a,t.velocity[0]=t.velocity[0]*i,t.velocity[2]=t.velocity[2]*i,t.hasBounced=2),t.position[2]<this.bz1?(t.position[2]=this.bz1,t.velocity[2]=-t.velocity[2]*a,t.velocity[0]=t.velocity[0]*i,t.velocity[1]=t.velocity[1]*i,t.hasBounced=3):t.position[2]>this.bz2&&(t.position[2]=this.bz2,t.velocity[2]=-t.velocity[2]*a,t.velocity[0]=t.velocity[0]*i,t.velocity[1]=t.velocity[1]*i,t.hasBounced=3)}}n.a=e},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t){super(),this.worldSystem=t}update(t,n){this.ax=this.worldSystem.bounds[0],this.ay=this.worldSystem.bounds[1],this.bx=this.worldSystem.bounds[2],this.by=this.worldSystem.bounds[3],this.az=this.worldSystem.bounds[4],this.bz=this.worldSystem.bounds[5],t.position[0]<this.ax&&t.velocity[0]<0?(t.position[0]=this.bx,this.fire("wrap",t)):t.position[0]>this.bx&&t.velocity[0]>0&&(t.position[0]=this.ax,this.fire("wrap",t)),t.position[1]<this.ay&&t.velocity[1]<0?(t.position[1]=this.by,this.fire("wrap",t)):t.position[1]>this.by&&t.velocity[1]>0&&(t.position[1]=this.ay,this.fire("wrap",t)),t.position[2]<this.az&&t.velocity[2]<0?(t.position[2]=this.bz,this.fire("wrap",t)):t.position[2]>this.bz&&t.velocity[2]>0&&(t.position[2]=this.az,this.fire("wrap",t))}}n.a=e},function(t,n,a){var i=a(3),e={scalar:{},SIMD:{}};e.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var n=new i.ARRAY_TYPE(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.fromValues=function(t,n,a,e,o,s,r,u,h,c,l,f,M,d,m,p){var S=new i.ARRAY_TYPE(16);return S[0]=t,S[1]=n,S[2]=a,S[3]=e,S[4]=o,S[5]=s,S[6]=r,S[7]=u,S[8]=h,S[9]=c,S[10]=l,S[11]=f,S[12]=M,S[13]=d,S[14]=m,S[15]=p,S},e.set=function(t,n,a,i,e,o,s,r,u,h,c,l,f,M,d,m,p){return t[0]=n,t[1]=a,t[2]=i,t[3]=e,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=h,t[9]=c,t[10]=l,t[11]=f,t[12]=M,t[13]=d,t[14]=m,t[15]=p,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.scalar.transpose=function(t,n){if(t===n){var a=n[1],i=n[2],e=n[3],o=n[6],s=n[7],r=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=a,t[6]=n[9],t[7]=n[13],t[8]=i,t[9]=o,t[11]=n[14],t[12]=e,t[13]=s,t[14]=r}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},e.SIMD.transpose=function(t,n){var a,i,e,o,s,r,u,h,c,l;return a=SIMD.Float32x4.load(n,0),i=SIMD.Float32x4.load(n,4),e=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),u=SIMD.Float32x4.shuffle(s,r,0,2,4,6),h=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,h),s=SIMD.Float32x4.shuffle(a,i,2,3,6,7),r=SIMD.Float32x4.shuffle(e,o,2,3,6,7),c=SIMD.Float32x4.shuffle(s,r,0,2,4,6),l=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,l),t},e.transpose=i.USE_SIMD?e.SIMD.transpose:e.scalar.transpose,e.scalar.invert=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],M=n[11],d=n[12],m=n[13],p=n[14],S=n[15],v=a*r-i*s,I=a*u-e*s,x=a*h-o*s,D=i*u-e*r,b=i*h-o*r,F=e*h-o*u,y=c*m-l*d,g=c*p-f*d,w=c*S-M*d,A=l*p-f*m,E=l*S-M*m,z=f*S-M*p,R=v*z-I*E+x*A+D*w-b*g+F*y;return R?(R=1/R,t[0]=(r*z-u*E+h*A)*R,t[1]=(e*E-i*z-o*A)*R,t[2]=(m*F-p*b+S*D)*R,t[3]=(f*b-l*F-M*D)*R,t[4]=(u*w-s*z-h*g)*R,t[5]=(a*z-e*w+o*g)*R,t[6]=(p*x-d*F-S*I)*R,t[7]=(c*F-f*x+M*I)*R,t[8]=(s*E-r*w+h*y)*R,t[9]=(i*w-a*E-o*y)*R,t[10]=(d*b-m*x+S*v)*R,t[11]=(l*x-c*b-M*v)*R,t[12]=(r*g-s*A-u*y)*R,t[13]=(a*A-i*g+e*y)*R,t[14]=(m*I-d*D-p*v)*R,t[15]=(c*D-l*I+f*v)*R,t):null},e.SIMD.invert=function(t,n){var a,i,e,o,s,r,u,h,c,l,f=SIMD.Float32x4.load(n,0),M=SIMD.Float32x4.load(n,4),d=SIMD.Float32x4.load(n,8),m=SIMD.Float32x4.load(n,12);return s=SIMD.Float32x4.shuffle(f,M,0,1,4,5),i=SIMD.Float32x4.shuffle(d,m,0,1,4,5),a=SIMD.Float32x4.shuffle(s,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,s,1,3,5,7),s=SIMD.Float32x4.shuffle(f,M,2,3,6,7),o=SIMD.Float32x4.shuffle(d,m,2,3,6,7),e=SIMD.Float32x4.shuffle(s,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,s,1,3,5,7),s=SIMD.Float32x4.mul(e,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.mul(i,s),u=SIMD.Float32x4.mul(a,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),r),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(i,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),r),c=SIMD.Float32x4.mul(a,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(o,s)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,3,0,1),o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),r),h=SIMD.Float32x4.mul(a,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(e,s)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),s=SIMD.Float32x4.mul(a,i),s=SIMD.Float32x4.swizzle(s,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),h),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,s),c),s=SIMD.Float32x4.swizzle(s,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,s),h),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(e,s)),s=SIMD.Float32x4.mul(a,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(e,s)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),h),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.mul(a,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,s)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),c),
l=SIMD.Float32x4.mul(a,r),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,2,3,0,1),l),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,1,0,3,2),l),s=SIMD.Float32x4.reciprocalApproximation(l),l=SIMD.Float32x4.sub(SIMD.Float32x4.add(s,s),SIMD.Float32x4.mul(l,SIMD.Float32x4.mul(s,s))),(l=SIMD.Float32x4.swizzle(l,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(l,r)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(l,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(l,h)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(l,c)),t):null},e.invert=i.USE_SIMD?e.SIMD.invert:e.scalar.invert,e.scalar.adjoint=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],M=n[11],d=n[12],m=n[13],p=n[14],S=n[15];return t[0]=r*(f*S-M*p)-l*(u*S-h*p)+m*(u*M-h*f),t[1]=-(i*(f*S-M*p)-l*(e*S-o*p)+m*(e*M-o*f)),t[2]=i*(u*S-h*p)-r*(e*S-o*p)+m*(e*h-o*u),t[3]=-(i*(u*M-h*f)-r*(e*M-o*f)+l*(e*h-o*u)),t[4]=-(s*(f*S-M*p)-c*(u*S-h*p)+d*(u*M-h*f)),t[5]=a*(f*S-M*p)-c*(e*S-o*p)+d*(e*M-o*f),t[6]=-(a*(u*S-h*p)-s*(e*S-o*p)+d*(e*h-o*u)),t[7]=a*(u*M-h*f)-s*(e*M-o*f)+c*(e*h-o*u),t[8]=s*(l*S-M*m)-c*(r*S-h*m)+d*(r*M-h*l),t[9]=-(a*(l*S-M*m)-c*(i*S-o*m)+d*(i*M-o*l)),t[10]=a*(r*S-h*m)-s*(i*S-o*m)+d*(i*h-o*r),t[11]=-(a*(r*M-h*l)-s*(i*M-o*l)+c*(i*h-o*r)),t[12]=-(s*(l*p-f*m)-c*(r*p-u*m)+d*(r*f-u*l)),t[13]=a*(l*p-f*m)-c*(i*p-e*m)+d*(i*f-e*l),t[14]=-(a*(r*p-u*m)-s*(i*p-e*m)+d*(i*u-e*r)),t[15]=a*(r*f-u*l)-s*(i*f-e*l)+c*(i*u-e*r),t},e.SIMD.adjoint=function(t,n){var a,i,e,o,s,r,u,h,c,l,f,M,d,a=SIMD.Float32x4.load(n,0),i=SIMD.Float32x4.load(n,4),e=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12);return c=SIMD.Float32x4.shuffle(a,i,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),s=SIMD.Float32x4.shuffle(c,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,c,1,3,5,7),c=SIMD.Float32x4.shuffle(a,i,2,3,6,7),h=SIMD.Float32x4.shuffle(e,o,2,3,6,7),u=SIMD.Float32x4.shuffle(c,h,0,2,4,6),h=SIMD.Float32x4.shuffle(h,c,1,3,5,7),c=SIMD.Float32x4.mul(u,h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.mul(r,c),f=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,c),l),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(r,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),l),d=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(h,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),l),M=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(u,c)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(s,r),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),M),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,c),M),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(s,h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,c),M),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(r,c)),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(h,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,c),d),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,M),SIMD.Float32x4.store(t,12,d),t},e.adjoint=i.USE_SIMD?e.SIMD.adjoint:e.scalar.adjoint,e.determinant=function(t){var n=t[0],a=t[1],i=t[2],e=t[3],o=t[4],s=t[5],r=t[6],u=t[7],h=t[8],c=t[9],l=t[10],f=t[11],M=t[12],d=t[13],m=t[14],p=t[15],S=n*s-a*o,v=n*r-i*o,I=n*u-e*o,x=a*r-i*s,D=a*u-e*s,b=i*u-e*r,F=h*d-c*M,y=h*m-l*M,g=h*p-f*M,w=c*m-l*d,A=c*p-f*d,E=l*p-f*m;return S*E-v*A+I*w+x*g-D*y+b*F},e.SIMD.multiply=function(t,n,a){var i=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4.load(a,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,3,3,3,3),s))));SIMD.Float32x4.store(t,0,u);var h=SIMD.Float32x4.load(a,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),s))));SIMD.Float32x4.store(t,4,c);var l=SIMD.Float32x4.load(a,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),s))));SIMD.Float32x4.store(t,8,f);var M=SIMD.Float32x4.load(a,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,3,3,3,3),s))));return SIMD.Float32x4.store(t,12,d),t},e.scalar.multiply=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=n[9],M=n[10],d=n[11],m=n[12],p=n[13],S=n[14],v=n[15],I=a[0],x=a[1],D=a[2],b=a[3];return t[0]=I*i+x*r+D*l+b*m,t[1]=I*e+x*u+D*f+b*p,t[2]=I*o+x*h+D*M+b*S,t[3]=I*s+x*c+D*d+b*v,I=a[4],x=a[5],D=a[6],b=a[7],t[4]=I*i+x*r+D*l+b*m,t[5]=I*e+x*u+D*f+b*p,t[6]=I*o+x*h+D*M+b*S,t[7]=I*s+x*c+D*d+b*v,I=a[8],x=a[9],D=a[10],b=a[11],t[8]=I*i+x*r+D*l+b*m,t[9]=I*e+x*u+D*f+b*p,t[10]=I*o+x*h+D*M+b*S,t[11]=I*s+x*c+D*d+b*v,I=a[12],x=a[13],D=a[14],b=a[15],t[12]=I*i+x*r+D*l+b*m,t[13]=I*e+x*u+D*f+b*p,t[14]=I*o+x*h+D*M+b*S,t[15]=I*s+x*c+D*d+b*v,t},e.multiply=i.USE_SIMD?e.SIMD.multiply:e.scalar.multiply,e.mul=e.multiply,e.scalar.translate=function(t,n,a){var i,e,o,s,r,u,h,c,l,f,M,d,m=a[0],p=a[1],S=a[2];return n===t?(t[12]=n[0]*m+n[4]*p+n[8]*S+n[12],t[13]=n[1]*m+n[5]*p+n[9]*S+n[13],t[14]=n[2]*m+n[6]*p+n[10]*S+n[14],t[15]=n[3]*m+n[7]*p+n[11]*S+n[15]):(i=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=n[9],M=n[10],d=n[11],t[0]=i,t[1]=e,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=h,t[7]=c,t[8]=l,t[9]=f,t[10]=M,t[11]=d,t[12]=i*m+r*p+l*S+n[12],t[13]=e*m+u*p+f*S+n[13],t[14]=o*m+h*p+M*S+n[14],t[15]=s*m+c*p+d*S+n[15]),t},e.SIMD.translate=function(t,n,a){var i=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4(a[0],a[1],a[2],0);n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11]),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(r,0,0,0,0)),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(r,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(r,2,2,2,2));var u=SIMD.Float32x4.add(i,SIMD.Float32x4.add(e,SIMD.Float32x4.add(o,s)));return SIMD.Float32x4.store(t,12,u),t},e.translate=i.USE_SIMD?e.SIMD.translate:e.scalar.translate,e.scalar.scale=function(t,n,a){var i=a[0],e=a[1],o=a[2];return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.SIMD.scale=function(t,n,a){var i,e,o,s=SIMD.Float32x4(a[0],a[1],a[2],0);return i=SIMD.Float32x4.load(n,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,0,0,0,0))),e=SIMD.Float32x4.load(n,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(s,1,1,1,1))),o=SIMD.Float32x4.load(n,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2))),t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.scale=i.USE_SIMD?e.SIMD.scale:e.scalar.scale,e.rotate=function(t,n,a,e){var o,s,r,u,h,c,l,f,M,d,m,p,S,v,I,x,D,b,F,y,g,w,A,E,z=e[0],R=e[1],_=e[2],P=Math.sqrt(z*z+R*R+_*_);return Math.abs(P)<i.EPSILON?null:(P=1/P,z*=P,R*=P,_*=P,o=Math.sin(a),s=Math.cos(a),r=1-s,u=n[0],h=n[1],c=n[2],l=n[3],f=n[4],M=n[5],d=n[6],m=n[7],p=n[8],S=n[9],v=n[10],I=n[11],x=z*z*r+s,D=R*z*r+_*o,b=_*z*r-R*o,F=z*R*r-_*o,y=R*R*r+s,g=_*R*r+z*o,w=z*_*r+R*o,A=R*_*r-z*o,E=_*_*r+s,t[0]=u*x+f*D+p*b,t[1]=h*x+M*D+S*b,t[2]=c*x+d*D+v*b,t[3]=l*x+m*D+I*b,t[4]=u*F+f*y+p*g,t[5]=h*F+M*y+S*g,t[6]=c*F+d*y+v*g,t[7]=l*F+m*y+I*g,t[8]=u*w+f*A+p*E,t[9]=h*w+M*A+S*E,t[10]=c*w+d*A+v*E,t[11]=l*w+m*A+I*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},e.scalar.rotateX=function(t,n,a){var i=Math.sin(a),e=Math.cos(a),o=n[4],s=n[5],r=n[6],u=n[7],h=n[8],c=n[9],l=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*e+h*i,t[5]=s*e+c*i,t[6]=r*e+l*i,t[7]=u*e+f*i,t[8]=h*e-o*i,t[9]=c*e-s*i,t[10]=l*e-r*i,t[11]=f*e-u*i,t},e.SIMD.rotateX=function(t,n,a){var i=SIMD.Float32x4.splat(Math.sin(a)),e=SIMD.Float32x4.splat(Math.cos(a));n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,4),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,i))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,e),SIMD.Float32x4.mul(o,i))),t},e.rotateX=i.USE_SIMD?e.SIMD.rotateX:e.scalar.rotateX,e.scalar.rotateY=function(t,n,a){var i=Math.sin(a),e=Math.cos(a),o=n[0],s=n[1],r=n[2],u=n[3],h=n[8],c=n[9],l=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*e-h*i,t[1]=s*e-c*i,t[2]=r*e-l*i,t[3]=u*e-f*i,t[8]=o*i+h*e,t[9]=s*i+c*e,t[10]=r*i+l*e,t[11]=u*i+f*e,t},e.SIMD.rotateY=function(t,n,a){var i=SIMD.Float32x4.splat(Math.sin(a)),e=SIMD.Float32x4.splat(Math.cos(a));n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,i))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(s,e))),t},e.rotateY=i.USE_SIMD?e.SIMD.rotateY:e.scalar.rotateY,e.scalar.rotateZ=function(t,n,a){var i=Math.sin(a),e=Math.cos(a),o=n[0],s=n[1],r=n[2],u=n[3],h=n[4],c=n[5],l=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*e+h*i,t[1]=s*e+c*i,t[2]=r*e+l*i,t[3]=u*e+f*i,t[4]=h*e-o*i,t[5]=c*e-s*i,t[6]=l*e-r*i,t[7]=f*e-u*i,t},e.SIMD.rotateZ=function(t,n,a){var i=SIMD.Float32x4.splat(Math.sin(a)),e=SIMD.Float32x4.splat(Math.cos(a));n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,i))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,e),SIMD.Float32x4.mul(o,i))),t},e.rotateZ=i.USE_SIMD?e.SIMD.rotateZ:e.scalar.rotateZ,e.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,n,a){var e,o,s,r=a[0],u=a[1],h=a[2],c=Math.sqrt(r*r+u*u+h*h);return Math.abs(c)<i.EPSILON?null:(c=1/c,r*=c,u*=c,h*=c,e=Math.sin(n),o=Math.cos(n),s=1-o,t[0]=r*r*s+o,t[1]=u*r*s+h*e,t[2]=h*r*s-u*e,t[3]=0,t[4]=r*u*s-h*e,t[5]=u*u*s+o,t[6]=h*u*s+r*e,t[7]=0,t[8]=r*h*s+u*e,t[9]=u*h*s-r*e,t[10]=h*h*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,n){var a=Math.sin(n),i=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,n){var a=Math.sin(n),i=Math.cos(n);return t[0]=i,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,n){var a=Math.sin(n),i=Math.cos(n);return t[0]=i,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=i+i,u=e+e,h=o+o,c=i*r,l=i*u,f=i*h,M=e*u,d=e*h,m=o*h,p=s*r,S=s*u,v=s*h;return t[0]=1-(M+m),t[1]=l+v,t[2]=f-S,t[3]=0,t[4]=l-v,t[5]=1-(c+m),t[6]=d+p,t[7]=0,t[8]=f+S,t[9]=d-p,t[10]=1-(c+M),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},e.getTranslation=function(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t},e.getRotation=function(t,n){var a=n[0]+n[5]+n[10],i=0;return a>0?(i=2*Math.sqrt(a+1),t[3]=.25*i,t[0]=(n[6]-n[9])/i,t[1]=(n[8]-n[2])/i,t[2]=(n[1]-n[4])/i):n[0]>n[5]&n[0]>n[10]?(i=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/i,t[0]=.25*i,t[1]=(n[1]+n[4])/i,t[2]=(n[8]+n[2])/i):n[5]>n[10]?(i=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/i,t[0]=(n[1]+n[4])/i,t[1]=.25*i,t[2]=(n[6]+n[9])/i):(i=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/i,t[0]=(n[8]+n[2])/i,t[1]=(n[6]+n[9])/i,t[2]=.25*i),t},e.fromRotationTranslationScale=function(t,n,a,i){var e=n[0],o=n[1],s=n[2],r=n[3],u=e+e,h=o+o,c=s+s,l=e*u,f=e*h,M=e*c,d=o*h,m=o*c,p=s*c,S=r*u,v=r*h,I=r*c,x=i[0],D=i[1],b=i[2];return t[0]=(1-(d+p))*x,t[1]=(f+I)*x,t[2]=(M-v)*x,t[3]=0,t[4]=(f-I)*D,t[5]=(1-(l+p))*D,t[6]=(m+S)*D,t[7]=0,t[8]=(M+v)*b,t[9]=(m-S)*b,t[10]=(1-(l+d))*b,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,n,a,i,e){var o=n[0],s=n[1],r=n[2],u=n[3],h=o+o,c=s+s,l=r+r,f=o*h,M=o*c,d=o*l,m=s*c,p=s*l,S=r*l,v=u*h,I=u*c,x=u*l,D=i[0],b=i[1],F=i[2],y=e[0],g=e[1],w=e[2];return t[0]=(1-(m+S))*D,t[1]=(M+x)*D,t[2]=(d-I)*D,t[3]=0,t[4]=(M-x)*b,t[5]=(1-(f+S))*b,t[6]=(p+v)*b,t[7]=0,t[8]=(d+I)*F,t[9]=(p-v)*F,t[10]=(1-(f+m))*F,t[11]=0,t[12]=a[0]+y-(t[0]*y+t[4]*g+t[8]*w),t[13]=a[1]+g-(t[1]*y+t[5]*g+t[9]*w),t[14]=a[2]+w-(t[2]*y+t[6]*g+t[10]*w),t[15]=1,t},e.fromQuat=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=a+a,r=i+i,u=e+e,h=a*s,c=i*s,l=i*r,f=e*s,M=e*r,d=e*u,m=o*s,p=o*r,S=o*u;return t[0]=1-l-d,t[1]=c+S,t[2]=f-p,t[3]=0,t[4]=c-S,t[5]=1-h-d,t[6]=M+m,t[7]=0,t[8]=f+p,t[9]=M-m,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,n,a,i,e,o,s){var r=1/(a-n),u=1/(e-i),h=1/(o-s);return t[0]=2*o*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(a+n)*r,t[9]=(e+i)*u,t[10]=(s+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*h,t[15]=0,t},e.perspective=function(t,n,a,i,e){var o=1/Math.tan(n/2),s=1/(i-e);return t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*i*s,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,n,a,i){var e=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),s=Math.tan(n.leftDegrees*Math.PI/180),r=Math.tan(n.rightDegrees*Math.PI/180),u=2/(s+r),h=2/(e+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-((s-r)*u*.5),t[9]=(e-o)*h*.5,t[10]=i/(a-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*a/(a-i),t[15]=0,t},e.ortho=function(t,n,a,i,e,o,s){var r=1/(n-a),u=1/(i-e),h=1/(o-s);return t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(n+a)*r,t[13]=(e+i)*u,t[14]=(s+o)*h,t[15]=1,t},e.lookAt=function(t,n,a,o){var s,r,u,h,c,l,f,M,d,m,p=n[0],S=n[1],v=n[2],I=o[0],x=o[1],D=o[2],b=a[0],F=a[1],y=a[2];return Math.abs(p-b)<i.EPSILON&&Math.abs(S-F)<i.EPSILON&&Math.abs(v-y)<i.EPSILON?e.identity(t):(f=p-b,M=S-F,d=v-y,m=1/Math.sqrt(f*f+M*M+d*d),f*=m,M*=m,d*=m,s=x*d-D*M,r=D*f-I*d,u=I*M-x*f,m=Math.sqrt(s*s+r*r+u*u),m?(m=1/m,s*=m,r*=m,u*=m):(s=0,r=0,u=0),h=M*u-d*r,c=d*s-f*u,l=f*r-M*s,m=Math.sqrt(h*h+c*c+l*l),m?(m=1/m,h*=m,c*=m,l*=m):(h=0,c=0,l=0),t[0]=s,t[1]=h,t[2]=f,t[3]=0,t[4]=r,t[5]=c,t[6]=M,t[7]=0,t[8]=u,t[9]=l,t[10]=d,t[11]=0,t[12]=-(s*p+r*S+u*v),t[13]=-(h*p+c*S+l*v),t[14]=-(f*p+M*S+d*v),t[15]=1,t)},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t[9]=n[9]+a[9],t[10]=n[10]+a[10],t[11]=n[11]+a[11],t[12]=n[12]+a[12],t[13]=n[13]+a[13],t[14]=n[14]+a[14],t[15]=n[15]+a[15],t},e.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t[9]=n[9]-a[9],t[10]=n[10]-a[10],t[11]=n[11]-a[11],t[12]=n[12]-a[12],t[13]=n[13]-a[13],t[14]=n[14]-a[14],t[15]=n[15]-a[15],t},e.sub=e.subtract,e.multiplyScalar=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12]*a,t[13]=n[13]*a,t[14]=n[14]*a,t[15]=n[15]*a,t},e.multiplyScalarAndAdd=function(t,n,a,i){return t[0]=n[0]+a[0]*i,t[1]=n[1]+a[1]*i,t[2]=n[2]+a[2]*i,t[3]=n[3]+a[3]*i,t[4]=n[4]+a[4]*i,t[5]=n[5]+a[5]*i,t[6]=n[6]+a[6]*i,t[7]=n[7]+a[7]*i,t[8]=n[8]+a[8]*i,t[9]=n[9]+a[9]*i,t[10]=n[10]+a[10]*i,t[11]=n[11]+a[11]*i,t[12]=n[12]+a[12]*i,t[13]=n[13]+a[13]*i,t[14]=n[14]+a[14]*i,t[15]=n[15]+a[15]*i,t},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]},e.equals=function(t,n){var a=t[0],e=t[1],o=t[2],s=t[3],r=t[4],u=t[5],h=t[6],c=t[7],l=t[8],f=t[9],M=t[10],d=t[11],m=t[12],p=t[13],S=t[14],v=t[15],I=n[0],x=n[1],D=n[2],b=n[3],F=n[4],y=n[5],g=n[6],w=n[7],A=n[8],E=n[9],z=n[10],R=n[11],_=n[12],P=n[13],C=n[14],O=n[15];return Math.abs(a-I)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(e-x)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(o-D)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(s-b)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(r-F)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(F))&&Math.abs(u-y)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-g)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(c-w)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(l-A)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-E)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(M-z)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(z))&&Math.abs(d-R)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(m-_)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(_))&&Math.abs(p-P)<=i.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(S-C)<=i.EPSILON*Math.max(1,Math.abs(S),Math.abs(C))&&Math.abs(v-O)<=i.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))},t.exports=e},function(t,n,a){"use strict";var i=a(0),e=a(2),o=a.n(e);const s=o.a.create(),r=o.a.create(),u=o.a.create(),h=o.a.create();class c extends i.a{constructor(t){super(),this.flock=t}update(t,n){o.a.set(u,0,0,0),o.a.set(r,0,0,0),o.a.set(s,0,0,0),o.a.set(h,0,0,0);let a=0;const i=this.flock.length;for(let e=0;e<i;e++){const n=this.flock[e],i=o.a.dist(n.position,t.position);i>0&&i<c.NEIGHBOUR_RADIUS&&(o.a.add(u,u,n.position),o.a.add(r,r,n.velocity),i<c.SEPARATION_RADIUS&&(o.a.subtract(h,t.position,n.position),o.a.normalize(h,h),o.a.scaleAndAdd(s,s,h,1/i)),a++)}if(a>0){o.a.scale(u,u,1/a),o.a.subtract(u,u,t.position),o.a.scaleAndAdd(t.velocity,t.velocity,u,c.COHESION_WEIGHT),o.a.scaleAndAdd(t.velocity,t.velocity,r,c.ALIGN_WEIGHT/a),o.a.scaleAndAdd(t.velocity,t.velocity,s,c.SEPARATION_WEIGHT/a);var l=o.a.length(t.velocity);l>c.MAX_SPEED&&o.a.scale(t.velocity,t.velocity,c.MAX_SPEED/l)}}}n.a=c,c.NEIGHBOUR_RADIUS=200,c.SEPARATION_RADIUS=150,c.MAX_SPEED=.1,c.COHESION_WEIGHT=.1*c.MAX_SPEED/c.NEIGHBOUR_RADIUS,c.ALIGN_WEIGHT=30*c.MAX_SPEED/c.NEIGHBOUR_RADIUS,c.SEPARATION_WEIGHT=100/c.SEPARATION_RADIUS},function(t,n,a){"use strict";var i=a(1);class e extends i.a{constructor(){super()}playSound(t){t.audio&&t.audio.play()}}n.a=e},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(a(1),a(0)),e=a(2),o=a.n(e),s=a(25);a.d(n,"FlockingComponent",function(){return s.a});var r=a(38);a.d(n,"GravityComponent",function(){return r.a});var u=a(40);a.d(n,"PositionInterpolatorComponent",function(){return u.a});var h=a(41);a.d(n,"SwitchComponent",function(){return h.a});var c=a(4);a.d(n,"PropertyAnimationComponent",function(){return c.a});var l=a(39);a.d(n,"PositionAnimationComponent",function(){return l.a});var f=a(36);a.d(n,"BoundsAnimationComponent",function(){return f.a});var M=a(37);a.d(n,"ColorAnimationComponent",function(){return M.a});class d extends i.a{constructor(t){super(),this.target=t,this.vector=o.a.create()}update(t,n){o.a.subtract(this.vector,this.target.position,t.position);var a=this.target.mass*n/o.a.squaredLength(this.vector);o.a.normalize(this.vector,this.vector),o.a.scaleAndAdd(t.velocity,t.velocity,this.vector,a)}}n.PointGravityComponent=d;class m extends i.a{update(t,n){o.a.scaleAndAdd(t.position,t.position,t.velocity,n)}}n.MoveComponent=m;class p extends i.a{update(t,n){t.impulse&&(o.a.add(t.velocity,t.velocity,t.impulse),o.a.set(t.impulse,0,0,0))}}n.PhysicsComponent=p;class S extends i.a{update(t,n){Math.random()<.001&&o.a.random(t.velocity,Math.random())}}n.RandomMotionComponent=S;class v extends i.a{constructor(t){super(),this.rotationSpeed=t}update(t,n){var a=t.rotationSpeed||this.rotationSpeed||0;t.setRotation(t.rotation+a*n)}}n.RotationComponent=v;class I extends i.a{update(t,n){t.targetRotation=Math.atan2(t.velocity[0],-t.velocity[1])}}n.RotateToHeadingComponent=I;class x extends i.a{update(t,n){var a=t.rotation,i=t.targetRotation,e=i-a,o=.01;e>Math.PI?e-=2*Math.PI:e<-Math.PI&&(e+=2*Math.PI),t.rotation=a+e*n*o}}n.RotationInterpolatorComponent=x;class D extends i.a{constructor(t){super(),this.target=t}update(t,n){this.target&&o.a.copy(t.position,this.target.position)}setTarget(t){this.target=t}}n.FollowComponent=D;class b extends i.a{constructor(t,n){super(),this.target=t,this.distance=n}update(t,n){o.a.add(t.position,this.target.position,this.distance)}}n.FollowAtDistanceComponent=b;class F extends i.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=this.target.rotation+Math.PI}}n.TrackRotationComponent=F;class y extends i.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=-this.target.rotation}}n.CounterRotationComponent=y;class g extends i.a{constructor(t){super(),this.velocityMagnitude=t}update(t,n){const a=o.a.length(t.velocity);if(a>this.velocityMagnitude){const n=this.velocityMagnitude/a;o.a.scale(t.velocity,t.velocity,n)}}}n.TerminalVelocityComponent=g},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=a(43);a.d(n,"CollisionSystem",function(){return i.a});var e=a(14);a.d(n,"CollisionComponent",function(){return e.a});var o=a(13);a.d(n,"BounceComponent",function(){return o.a});var s=a(42);a.d(n,"BackgroundCollisionSystem",function(){return s.a});var r=a(12);a.d(n,"BackgroundCollisionComponent",function(){return r.a});var u=a(15);a.d(n,"SolidComponent",function(){return u.a})},function(t,n,a){"use strict";function i(t){function n(a){if(a&&t.time==a)return void console.log("Multiple calls: "+a);t.time=a,t.frame++;try{t.root.update(Math.min(a-t._lastTime,100)),t.state==l&&d(n),t._lastTime=a}catch(t){window.console&&console.error(t.stack||t)}}n(t._lastTime)}function e(t,n){t._loaded++,t.fire("resourcesProgress",t._loaded/t._toLoad),t._toLoad-t._loaded<=0&&t.fire("resourcesLoaded")}var o=(a(1),a(16)),s=(a(0),a(10)),r=a(6),u=a(7),h=a(5),c=a(9),l=1,f=2,M=0,d="undefined"!=typeof window&&window.requestAnimationFrame||function(t,n){var a=(new Date).getTime(),i=Math.max(0,16-(a-M)),e=setTimeout(function(){t(a+i)},i);return M=a+i,e};class m{constructor(t){this.canvas=t.canvas,this.width=t.width||this.canvas&&this.canvas.width,this.height=t.height||this.canvas&&this.canvas.height,this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.root=new o.a,this.textures=[],this.sounds=[],this.frame=0,this.time=0,this.score=t.score||0,this.lives=t.lives||0,this.level=t.level||0,this._toLoad=0,this._lastTime=0,this._loaded=0,this._autosizeCallback=(()=>{if(this.canvas){const t=this.canvas.offsetWidth,n=this.canvas.offsetHeight;this.setSize(t,n),this.cameraSystem&&this.cameraSystem.setPosition(t/2,n/2),this.worldSystem&&this.worldSystem.setBounds(0,0,t,n)}}),t.autosize&&this.setAutosize(!0)}setCanvas(t){this.canvas=t,this.canvas&&(this.width=this.width||this.canvas.width,this.height=this.height||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height)}loadTextures(t){this._toLoad+=t.length;var n=this;return t.map(function(t){var a={};return a.image=new Image,a.image.onload=function(){a.width=a.image.width,a.height=a.image.height,a.loaded=!0,e(n,a)},a.image.onerror=function(){throw new Error("Failed to load a texture: "+t)},a.image.src=t,n.textures.push(a),a})}loadAudio(t){this._toLoad+=t.length;var n=this;return t.map(function(t){var a={};return a.audio=new Audio,a.audio.addEventListener("canplaythrough",()=>{a.loaded||(a.length=a.audio.duration,a.loaded=!0,e(n,a))}),a.audio.onerror=function(){throw new Error("Failed to load a sound: "+t)},a.audio.src=t,n.sounds.push(a),a})}start(){this.nextLevel(),this.state=l,i(this)}stop(){this.state=f}getDefaultCamera(){return this.cameraSystem||(this.cameraSystem=new s.a,this.cameraSystem.setPosition(this.width/2,this.height/2)),this.cameraSystem}getDefaultRenderer(){if(!this.renderSystem){this.cameraSystem||this.getDefaultCamera();let t;this.canvas&&(t=this.canvas.getContext("2d")),this.renderSystem=new r.a(t,this.cameraSystem)}return this.renderSystem}getDefaultWorld(t=0,n=t){const a=[-t,-n,this.width+t,this.height+n];return this.worldSystem?this.worldSystem.setBounds(...a):this.worldSystem=new u.a(a),this.worldSystem}getDefaultInput(){return this.inputSystem||(this.cameraSystem||this.getDefaultCamera(),this.inputSystem=new h.a(this.canvas,document,this.cameraSystem)),this.inputSystem}setScore(t){this.score=t,this.fire("score",this.score)}nextLevel(){this.level++,this.fire("loadLevel",this.level)}setLevel(t){this.level=t,this.fire("loadLevel",this.level)}completeLevel(){this.fire("levelComplete",this.level)}setSize(t,n){this.width=t,this.height=n,this.canvas&&(this.canvas.width=t,this.canvas.height=n)}setAutosize(t){t?window.addEventListener("resize",this._autosizeCallback):window.removeEventListener("resize",this._autosizeCallback)}}n.a=m,a.i(c.b)(m)},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=a(44);a.d(n,"DebugDrawBoundsComponent",function(){return i.a});var e=a(45);a.d(n,"DebugDrawPathComponent",function(){return e.a});var o=a(46);a.d(n,"DebugDrawSurfacesComponent",function(){return o.a});var s=a(47);a.d(n,"DebugFlockingComponent",function(){return s.a})},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=a(5);a.d(n,"InputSystem",function(){return i.a});var e=a(17);a.d(n,"ClickComponent",function(){return e.a})},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=a(6);a.d(n,"CanvasRenderSystem",function(){return i.a});var e=a(18);a.d(n,"DotRenderComponent",function(){return e.a});var o=a(19);a.d(n,"RectangleRenderComponent",function(){return o.a});var s=a(20);a.d(n,"TextRenderComponent",function(){return s.a});var r=a(21);a.d(n,"WebGLRenderSystem",function(){return r.a});var u=a(48);a.d(n,"PolyShapeRenderComponent",function(){return u.a});var h=a(49);a.d(n,"TileComponent",function(){return h.a}),a.d(n,"SpriteRenderingComponent",function(){return h.b}),a.d(n,"SpriteAnimationComponent",function(){return h.c}),a.d(n,"Sprite",function(){return h.d}),a.d(n,"AnimatedSpriteComponent",function(){return h.e}),a.d(n,"CanvasSpriteRenderingComponent",function(){return h.f})},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=a(7);a.d(n,"WorldSystem",function(){return i.a});var e=a(22);a.d(n,"WorldBounceComponent",function(){return e.a});var o=a(23);a.d(n,"WorldWrapComponent",function(){return o.a})},function(t,n,a){var i=a(3),e={};e.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var n=new i.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,n,a,e){var o=new i.ARRAY_TYPE(4);return o[0]=t,o[1]=n,o[2]=a,o[3]=e,o},e.set=function(t,n,a,i,e){return t[0]=n,t[1]=a,t[2]=i,t[3]=e,t},e.transpose=function(t,n){if(t===n){var a=n[1];t[1]=n[2],t[2]=a}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},e.invert=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=a*o-e*i;return s?(s=1/s,t[0]=o*s,t[1]=-i*s,t[2]=-e*s,t[3]=a*s,t):null},e.adjoint=function(t,n){var a=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=a,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=a[0],u=a[1],h=a[2],c=a[3];return t[0]=i*r+o*u,t[1]=e*r+s*u,t[2]=i*h+o*c,t[3]=e*h+s*c,t},e.mul=e.multiply,e.rotate=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=Math.sin(a),u=Math.cos(a);return t[0]=i*u+o*r,t[1]=e*u+s*r,t[2]=i*-r+o*u,t[3]=e*-r+s*u,t},e.scale=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=a[0],u=a[1];return t[0]=i*r,t[1]=e*r,t[2]=o*u,t[3]=s*u,t},e.fromRotation=function(t,n){var a=Math.sin(n),i=Math.cos(n);return t[0]=i,t[1]=a,t[2]=-a,t[3]=i,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,n,a,i){return t[2]=i[2]/i[0],a[0]=i[0],a[1]=i[1],a[3]=i[3]-t[2]*a[1],[t,n,a]},e.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t},e.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t},e.sub=e.subtract,e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},e.equals=function(t,n){var a=t[0],e=t[1],o=t[2],s=t[3],r=n[0],u=n[1],h=n[2],c=n[3];return Math.abs(a-r)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(r))&&Math.abs(e-u)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(o-h)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-c)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))},e.multiplyScalar=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t},e.multiplyScalarAndAdd=function(t,n,a,i){return t[0]=n[0]+a[0]*i,t[1]=n[1]+a[1]*i,t[2]=n[2]+a[2]*i,t[3]=n[3]+a[3]*i,t},t.exports=e},function(t,n,a){var i=a(3),e={};e.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],
t[6]=n[8],t[7]=n[9],t[8]=n[10],t},e.clone=function(t){var n=new i.ARRAY_TYPE(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},e.fromValues=function(t,n,a,e,o,s,r,u,h){var c=new i.ARRAY_TYPE(9);return c[0]=t,c[1]=n,c[2]=a,c[3]=e,c[4]=o,c[5]=s,c[6]=r,c[7]=u,c[8]=h,c},e.set=function(t,n,a,i,e,o,s,r,u,h){return t[0]=n,t[1]=a,t[2]=i,t[3]=e,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=h,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,n){if(t===n){var a=n[1],i=n[2],e=n[5];t[1]=n[3],t[2]=n[6],t[3]=a,t[5]=n[7],t[6]=i,t[7]=e}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},e.invert=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=c*s-r*h,f=-c*o+r*u,M=h*o-s*u,d=a*l+i*f+e*M;return d?(d=1/d,t[0]=l*d,t[1]=(-c*i+e*h)*d,t[2]=(r*i-e*s)*d,t[3]=f*d,t[4]=(c*a-e*u)*d,t[5]=(-r*a+e*o)*d,t[6]=M*d,t[7]=(-h*a+i*u)*d,t[8]=(s*a-i*o)*d,t):null},e.adjoint=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8];return t[0]=s*c-r*h,t[1]=e*h-i*c,t[2]=i*r-e*s,t[3]=r*u-o*c,t[4]=a*c-e*u,t[5]=e*o-a*r,t[6]=o*h-s*u,t[7]=i*u-a*h,t[8]=a*s-i*o,t},e.determinant=function(t){var n=t[0],a=t[1],i=t[2],e=t[3],o=t[4],s=t[5],r=t[6],u=t[7],h=t[8];return n*(h*o-s*u)+a*(-h*e+s*r)+i*(u*e-o*r)},e.multiply=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=a[0],M=a[1],d=a[2],m=a[3],p=a[4],S=a[5],v=a[6],I=a[7],x=a[8];return t[0]=f*i+M*s+d*h,t[1]=f*e+M*r+d*c,t[2]=f*o+M*u+d*l,t[3]=m*i+p*s+S*h,t[4]=m*e+p*r+S*c,t[5]=m*o+p*u+S*l,t[6]=v*i+I*s+x*h,t[7]=v*e+I*r+x*c,t[8]=v*o+I*u+x*l,t},e.mul=e.multiply,e.translate=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=a[0],M=a[1];return t[0]=i,t[1]=e,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=f*i+M*s+h,t[7]=f*e+M*r+c,t[8]=f*o+M*u+l,t},e.rotate=function(t,n,a){var i=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=Math.sin(a),M=Math.cos(a);return t[0]=M*i+f*s,t[1]=M*e+f*r,t[2]=M*o+f*u,t[3]=M*s-f*i,t[4]=M*r-f*e,t[5]=M*u-f*o,t[6]=h,t[7]=c,t[8]=l,t},e.scale=function(t,n,a){var i=a[0],e=a[1];return t[0]=i*n[0],t[1]=i*n[1],t[2]=i*n[2],t[3]=e*n[3],t[4]=e*n[4],t[5]=e*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},e.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t},e.fromRotation=function(t,n){var a=Math.sin(n),i=Math.cos(n);return t[0]=i,t[1]=a,t[2]=0,t[3]=-a,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},e.fromQuat=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=a+a,r=i+i,u=e+e,h=a*s,c=i*s,l=i*r,f=e*s,M=e*r,d=e*u,m=o*s,p=o*r,S=o*u;return t[0]=1-l-d,t[3]=c-S,t[6]=f+p,t[1]=c+S,t[4]=1-h-d,t[7]=M-m,t[2]=f-p,t[5]=M+m,t[8]=1-h-l,t},e.normalFromMat4=function(t,n){var a=n[0],i=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],M=n[11],d=n[12],m=n[13],p=n[14],S=n[15],v=a*r-i*s,I=a*u-e*s,x=a*h-o*s,D=i*u-e*r,b=i*h-o*r,F=e*h-o*u,y=c*m-l*d,g=c*p-f*d,w=c*S-M*d,A=l*p-f*m,E=l*S-M*m,z=f*S-M*p,R=v*z-I*E+x*A+D*w-b*g+F*y;return R?(R=1/R,t[0]=(r*z-u*E+h*A)*R,t[1]=(u*w-s*z-h*g)*R,t[2]=(s*E-r*w+h*y)*R,t[3]=(e*E-i*z-o*A)*R,t[4]=(a*z-e*w+o*g)*R,t[5]=(i*w-a*E-o*y)*R,t[6]=(m*F-p*b+S*D)*R,t[7]=(p*x-d*F-S*I)*R,t[8]=(d*b-m*x+S*v)*R,t):null},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t},e.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t},e.sub=e.subtract,e.multiplyScalar=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t},e.multiplyScalarAndAdd=function(t,n,a,i){return t[0]=n[0]+a[0]*i,t[1]=n[1]+a[1]*i,t[2]=n[2]+a[2]*i,t[3]=n[3]+a[3]*i,t[4]=n[4]+a[4]*i,t[5]=n[5]+a[5]*i,t[6]=n[6]+a[6]*i,t[7]=n[7]+a[7]*i,t[8]=n[8]+a[8]*i,t},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]},e.equals=function(t,n){var a=t[0],e=t[1],o=t[2],s=t[3],r=t[4],u=t[5],h=t[6],c=t[7],l=t[8],f=n[0],M=n[1],d=n[2],m=n[3],p=n[4],S=n[5],v=t[6],I=n[7],x=n[8];return Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(e-M)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(o-d)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-m)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(r-p)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(u-S)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-v)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-I)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(l-x)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))},t.exports=e},function(t,n,a){"use strict";var i=a(4);const e=(t,n)=>{t.setBounds(...n)};class o extends i.a{constructor(t,n,a=undefined,i=undefined){super(e,t,n,a,i)}}n.a=o},function(t,n,a){"use strict";function i(t,n){t.color=`rgba(${0|n[0]}, ${0|n[1]}, ${0|n[2]}, ${n[3]})`}var e=a(4),o=a(9);class s extends e.a{constructor(t,n,e=undefined,s=undefined){super(i,a.i(o.a)(t),a.i(o.a)(n),e,s)}}n.a=s},function(t,n,a){"use strict";var i=a(0);class e extends i.a{update(t,n){"undefined"==typeof t.velocity[1]&&(t.velocity[1]=0),t.velocity[1]+=e.GRAVITATIONAL_CONSTANT*n}}n.a=e,e.GRAVITATIONAL_CONSTANT=3e-4},function(t,n,a){"use strict";var i=a(4);const e=(t,n)=>{t.setPosition(...n)};class o extends i.a{constructor(t,n,a=undefined,i=undefined){super(e,t,n,a,i)}}n.a=o},function(t,n,a){"use strict";var i=a(0),e=a(2),o=a.n(e);class s extends i.a{constructor(t,n){super(),this.duration=t,this.easing=n||s.linear,this.elapsed=0,this.running=!1,this.starting=!1,this.start=o.a.create(),this.position=o.a.create()}update(t,n){if(this.starting&&(isNaN(this.position[0])&&(this.position[0]=t.position[0]),isNaN(this.position[1])&&(this.position[1]=t.position[1]),isNaN(this.position[2])&&(this.position[2]=t.position[2]),o.a.copy(this.start,t.position),this.running=!0,this.starting=!1,this.elapsed=0),this.running){var a=this.elapsed/this.duration,i=this.easing(a);a>1?(o.a.copy(t.position,this.position),this.running=!1):(o.a.lerp(t.position,this.start,this.position,i),this.elapsed+=n)}}setPosition(t,n,a){super.setPosition(t,n,a),this.starting=!0}}n.a=s},function(t,n,a){"use strict";var i=a(1),e=a(0),o=i.a.prototype.addComponent;class s extends e.a{constructor(t,n){super(),this.positiveComponents=[],this.negativeComponents=[],this.active=!0,this.object=t,this.prop=n}addComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addPositiveComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addNegativeComponent(t){this.components=this.negativeComponents,o.call(this,t),this.components=void 0}addComponents(t,n){t.forEach(this.addPositiveComponent.bind(this)),n.forEach(this.addNegativeComponent.bind(this))}flip(){this.setActive(!this.active)}setActive(t){this.active=t,this.object&&(this.object[this.prop]=this.active)}update(t,n){var a,i=0;if(this.object&&(this.active=this.object[this.prop]),this.active)for(a=this.positiveComponents.length;i<a;i++)this.positiveComponents[i].update(t,n);else for(a=this.negativeComponents.length;i<a;i++)this.negativeComponents[i].update(t,n)}}n.a=s},function(t,n,a){"use strict";var i=a(1);class e extends i.a{constructor(){super(),this.surfaces=[],this.temporarySurfaces=[]}addSurface(t){this.surfaces.push(t)}addSurfaces(t){for(var n=0;n<t.length;n++)this.surfaces.push(t[n])}clearSurfaces(){this.surfaces.length=0}addTemporarySurface(t){this.temporarySurfaces.push(t)}update(t){super.update(t),this.temporarySurfaces.length=0}}n.a=e},function(t,n,a){"use strict";var i=a(1);class e extends i.a{constructor(){super(),this.attackObjects=[],this.vulnerableObjects=[]}addAttackObject(t){this.attackObjects.push(t)}addVulnerableObject(t){this.vulnerableObjects.push(t)}update(t){const n=this.attackObjects.length,a=this.vulnerableObjects.length;for(let i=0;i<n;i++){const t=this.attackObjects[i],n=t.position[0],e=t.position[1],o=t.bounds,s=[n+o[0],e+o[1],n+o[2],e+o[3]];for(let r=0;r<a;r++){const n=this.vulnerableObjects[r],a=n.position[0],i=n.position[1],e=n.bounds,o=[a+e[0],i+e[1],a+e[2],i+e[3]];t!==n&&s[0]<o[2]&&s[1]<o[3]&&s[2]>o[0]&&s[3]>o[1]&&(t.fire("attack",n),n.fire("attackedBy",t))}}this.attackObjects.length=0,this.vulnerableObjects.length=0}}n.a=e},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t){super(),this.renderSystem=t}update(t,n){const a=t.bounds;a&&this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.rect(t.bounds[0],t.bounds[1],t.bounds[2]-t.bounds[0],t.bounds[3]-t.bounds[1]),n.strokeStyle="#000",n.stroke()})}}n.a=e},function(t,n,a){"use strict";var i=(a(1),a(0)),e=a(8);a.n(e);const o=1e3;class s extends i.a{constructor(t){super(),this.path=[],this.currIndex=0,this.lastVx=0,this.lastVy=0,this.renderSystem=t,this.path.length=o}update(t,n){const a=t.position[0],i=t.position[1],e=t.velocity[0],s=t.velocity[1],r=(e-this.lastVx)/n,u=(s-this.lastVy)/n,h=this.path,c=(this.currIndex-2+o)%o,l=Math.abs(h[c]-a),f=Math.abs(h[c+1]-i);(l>100||f>100)&&(h[this.currIndex]=NaN,h[this.currIndex+1]=NaN,this.currIndex=(this.currIndex+2)%o),h[this.currIndex]=a,h[this.currIndex+1]=i,this.renderSystem.push(t=>{t.beginPath(),t.moveTo(h[this.currIndex],h[this.currIndex+1]);for(let n=2;n<o;n+=2){let a=(this.currIndex+n)%o;h[a]?t.lineTo(h[a],h[a+1]):(n+=2,a=(this.currIndex+n)%o,t.moveTo(h[a],h[a+1]))}t.strokeStyle="#CCC",t.stroke()}),this.currIndex=(this.currIndex+2)%o,this.renderSystem.strokePath([a,i,a+100*e,i+100*s],"rgba(0,128,255,0.7)",0),this.renderSystem.strokePath([a,i,a+4e5*r,i+4e5*u],"rgba(0,255,0,0.7)",0),this.lastVx=e,this.lastVy=s}}n.a=s},function(t,n,a){"use strict";var i=a(0);class e extends i.a{constructor(t,n){super(),this.renderSystem=t,this.colour=n||"#000"}update(t,n){for(var a,i,e,o=t.surfaces,s=0,r=o.length;s<r;s++)this.renderSystem.strokePath(o[s],t.colour||this.colour);for(s=0;s<r;s++)for(i=t.surfaces[s],e=i.length,a=0;a<e-3;a+=2){var u=i[a],h=i[a+1],c=i[a+2],l=i[a+3],f=c-u,M=l-h,d=u+.5*f,m=h+.5*M,p=M/Math.sqrt(M*M+f*f),S=-f/Math.sqrt(M*M+f*f);this.renderSystem.strokePath([d,m,d+30*p,m+30*S],"#08f")}}}n.a=e},function(t,n,a){"use strict";var i=a(0),e=a(25);class o extends i.a{constructor(t){super(),this.renderSystem=t}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.arc(0,0,e.a.NEIGHBOUR_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#008",n.stroke(),n.beginPath(),n.arc(0,0,e.a.SEPARATION_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#800",n.stroke()})}}n.a=o},function(t,n,a){"use strict";var i=a(0),e=a(35),o=a.n(e),s=a(24),r=a.n(s);class u extends i.a{constructor(t,n,a,i,e){super();var o=t.context;this.renderSystem=t,this.vertexBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.STATIC_DRAW),this.vertexBuffer.itemSize=3,this.vertexBuffer.numItems=Math.floor(n.length/this.vertexBuffer.itemSize),this.textureBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.textureBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(a),o.STATIC_DRAW),this.textureBuffer.itemSize=2,this.textureBuffer.numItems=Math.floor(a.length/this.textureBuffer.itemSize),this.vertexNormalBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexNormalBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(i),o.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=Math.floor(i.length/this.vertexNormalBuffer.itemSize),this.vertexIndexBuffer=o.createBuffer(),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),o.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=e.length}update(t,n){var a=this.vertexBuffer,i=this.textureBuffer,e=this.vertexNormalBuffer,s=this.vertexIndexBuffer,u=this.lighting||t.lighting,h=this.renderSystem.shaderProgram,c=this.texture||t.texture;this.renderSystem.push(function(n,l){r.a.translate(l,l,t.position),t.rotation&&t.rotationAxis&&r.a.rotate(l,l,t.rotation,t.rotationAxis);var f=o.a.create();o.a.fromMat4(f,l),o.a.invert(f,f),o.a.transpose(f,f),n.uniformMatrix3fv(h.nMatrixUniform,!1,f),t.size&&r.a.scale(l,l,t.size),n.bindBuffer(n.ARRAY_BUFFER,a),n.vertexAttribPointer(h.vertexPositionAttribute,a.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(h.textureCoordAttribute,i.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,e),n.vertexAttribPointer(h.vertexNormalAttribute,e.itemSize,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,c),n.uniform1i(h.samplerUniform,0),n.uniform1i(h.useLightingUniform,u),u&&(n.uniform3f(h.ambientColorUniform,this.ambientLight,this.ambientLight,this.ambientLight),n.uniform3f(h.pointLightingLocationUniform,0,0,0),n.uniform3f(h.pointLightingColorUniform,this.pointLighting,this.pointLighting,this.pointLighting)),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,s),n.uniformMatrix4fv(h.mvMatrixUniform,!1,l),n.drawElements(n.TRIANGLES,s.numItems,n.UNSIGNED_SHORT,0)})}}n.a=u,u.createCube=function(t){var n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],a=[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],i=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],e=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return new u(t,n,a,i,e)},u.createSphere=function(t,n,a){var i,e,o,s,r,h,c,l,f,M,d,m,p,S,v,I,x=[],D=[],b=[];for(i=0;i<=n;i++)for(e=i*Math.PI/n,o=Math.sin(e),s=Math.cos(e),r=0;r<=a;r++)h=2*r*Math.PI/a,c=Math.sin(h),l=Math.cos(h),f=l*o,M=s,d=c*o,m=1-r/a,p=1-i/n,D.push(f),D.push(M),D.push(d),b.push(m),b.push(p),x.push(f),x.push(M),x.push(d);for(S=[],i=0;i<n;i++)for(r=0;r<a;r++)v=i*(a+1)+r,I=v+a+1,S.push(v),S.push(I),S.push(v+1),S.push(I),S.push(I+1),S.push(v+1);return new u(t,x,b,x,S)}},function(t,n,a){"use strict";function i(t,n){this.images=t,this.delay=1e3/n,this.lastChange=0,this.imageIndex=0}function e(t){this.renderSystem=t}var o=a(0);n.e=i,n.f=e;class s extends o.a{constructor(t,n,a){super(),this.renderSystem=t,this.texture=n,this.bounds=a}update(t,n){for(var a,i=this.renderSystem,e=this.texture,o=this.bounds,s=e.width,r=e.height,u=t.position[0]%s,h=(t.position[1]%r,o[1]),c=o[2],l=o[3],f=function(t,n,a){return function(i){i.drawImage(t.image,n,a)}};h<l+r;h+=r)for(a=o[0]+u-s;a<c+s;a+=s)i.push(f(e,a,h))}}n.a=s;class r extends o.a{constructor(t,n,a){super(),this.renderSystem=t,this.layer=n,this.sprite=a}update(t,n){super.update(n);var a=this.sprite||t.sprite,i=a&&a.t.image;a&&this.renderSystem.push(function(n){var e=t.position[0],o=t.position[1],s=a.w,r=a.h;n.translate(e,o),n.rotate(t.rotation),n.drawImage(i,a.x,a.y,s,r,-a.ox,-a.oy,s,r)},this.layer)}}n.b=r;class u extends o.a{constructor(t,n){super(),this.duration=t,this.spriteIndex=0,this.playing=!0,this.sprites=n}init(t){this.sprites&&(t.sprites=this.sprites),t.sprites.length&&(t.sprite=t.sprites[0]),t.spriteCountdown=t.sprite&&t.sprite.d||this.duration}update(t,n){var a,i,e=t.sprites.length;this.playing&&(t.spriteCountdown-=n,t.spriteCountdown<=0&&(this.spriteIndex=(this.spriteIndex+1)%e,a=t.sprites[this.spriteIndex],t.sprite=a,i=a.d||this.duration,t.spriteCountdown=i))}play(){this.playing=!0}stop(){this.playing=!1,this.spriteIndex=0}pause(){this.playing=!1}}n.c=u;const h={};n.d=h,h.generateSpriteSheet=function(t,n,a){var i,e,o=[];for(i=0;i<n;i++)for(e=0;e<a;e++)o.push({t:t.t,x:e*t.w,y:i*t.h,w:t.w,h:t.h,ox:t.ox,oy:t.oy,d:t.d});return o},i.prototype=new o.a,i.prototype.update=function(t,n){this.lastChange>this.delay?(this.imageIndex=(this.imageIndex+1)%this.images.length,t.sprite=this.images[this.imageIndex],this.lastChange=0):this.lastChange+=n},e.prototype=new o.a,e.prototype.update=function(t,n){this.renderSystem.push(function(n){var a=t.position[0],i=t.position[1],e=t.sprite.width,o=t.sprite.height;n.translate(a,i),n.rotate(t.rotation),n.drawImage(t.sprite,-e/2,-o/2)})}},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=a(1);a.d(n,"GameObject",function(){return i.a});var e=a(16);a.d(n,"GameObjectManager",function(){return e.a});var o=a(0);a.d(n,"GameComponent",function(){return o.a});var s=a(10);a.d(n,"CameraSystem",function(){return s.a});var r=a(6);a.d(n,"CanvasRenderSystem",function(){return r.a});var u=a(7);a.d(n,"WorldSystem",function(){return u.a});var h=a(5);a.d(n,"InputSystem",function(){return h.a});var c=a(26);a.d(n,"AudioSystem",function(){return c.a});var l=a(29);a.d(n,"Game",function(){return l.a});var f=a(27),M=a(11);a.d(n,"Easing",function(){return M});var d=a(33);a.d(n,"World",function(){return d});var m=a(22),p=a(23),S=a(31);a.d(n,"Input",function(){return S});var v=a(17),I=a(28);a.d(n,"Collision",function(){return I});var x=a(14),D=a(13),b=a(12),F=a(15),y=a(32);a.d(n,"Render",function(){return y});var g=a(21);a.d(n,"WebGLRenderSystem",function(){return g.a});var w=a(18),A=a(19),E=a(20),z=a(30);a.d(n,"Debug",function(){return z});const R={};n.Components=R;for(let _ in f)R[_]=f[_];R.WorldBounceComponent=m.a,R.WorldWrapComponent=p.a,R.ClickComponent=v.a,R.CollisionComponent=x.a,R.BounceComponent=D.a,R.BackgroundCollisionComponent=b.a,R.SolidComponent=F.a,R.DotRenderComponent=w.a,R.RectangleRenderComponent=A.a,R.TextRenderComponent=E.a}])});
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.IGE=n():t.IGE=n()}(this,function(){return function(t){function n(a){if(i[a])return i[a].exports;var e=i[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var i={};return n.m=t,n.c=i,n.i=function(t){return t},n.d=function(t,i,a){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:a})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=65)}([function(t,n,i){"use strict";var a=i(2);class e extends a.a{init(t){}update(t,n){}toHTML(){return this.name}}e.create=function(t,n){t.prototype=new e;for(var i in n)t.prototype[i]=n[i];var a=t.name;return a||(a=t.toString().match(/^function ([a-z_]+)/i)[1],t.name=a),t},n.a=e},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},e.clone=function(t){var n=new a.ARRAY_TYPE(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},e.fromValues=function(t,n,i){var e=new a.ARRAY_TYPE(3);return e[0]=t,e[1]=n,e[2]=i,e},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},e.set=function(t,n,i,a){return t[0]=n,t[1]=i,t[2]=a,t},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t},e.sub=e.subtract,e.multiply=function(t,n,i){return t[0]=n[0]*i[0],t[1]=n[1]*i[1],t[2]=n[2]*i[2],t},e.mul=e.multiply,e.divide=function(t,n,i){return t[0]=n[0]/i[0],t[1]=n[1]/i[1],t[2]=n[2]/i[2],t},e.div=e.divide,e.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},e.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},e.min=function(t,n,i){return t[0]=Math.min(n[0],i[0]),t[1]=Math.min(n[1],i[1]),t[2]=Math.min(n[2],i[2]),t},e.max=function(t,n,i){return t[0]=Math.max(n[0],i[0]),t[1]=Math.max(n[1],i[1]),t[2]=Math.max(n[2],i[2]),t},e.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},e.scale=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t},e.scaleAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t},e.distance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return Math.sqrt(i*i+a*a+e*e)},e.dist=e.distance,e.squaredDistance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return i*i+a*a+e*e},e.sqrDist=e.squaredDistance,e.length=function(t){var n=t[0],i=t[1],a=t[2];return Math.sqrt(n*n+i*i+a*a)},e.len=e.length,e.squaredLength=function(t){var n=t[0],i=t[1],a=t[2];return n*n+i*i+a*a},e.sqrLen=e.squaredLength,e.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},e.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},e.normalize=function(t,n){var i=n[0],a=n[1],e=n[2],o=i*i+a*a+e*e;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t},e.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},e.cross=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=i[0],r=i[1],u=i[2];return t[0]=e*u-o*r,t[1]=o*s-a*u,t[2]=a*r-e*s,t},e.lerp=function(t,n,i,a){var e=n[0],o=n[1],s=n[2];return t[0]=e+a*(i[0]-e),t[1]=o+a*(i[1]-o),t[2]=s+a*(i[2]-s),t},e.hermite=function(t,n,i,a,e,o){var s=o*o,r=s*(2*o-3)+1,u=s*(o-2)+o,h=s*(o-1),c=s*(3-2*o);return t[0]=n[0]*r+i[0]*u+a[0]*h+e[0]*c,t[1]=n[1]*r+i[1]*u+a[1]*h+e[1]*c,t[2]=n[2]*r+i[2]*u+a[2]*h+e[2]*c,t},e.bezier=function(t,n,i,a,e,o){var s=1-o,r=s*s,u=o*o,h=r*s,c=3*o*r,l=3*u*s,f=u*o;return t[0]=n[0]*h+i[0]*c+a[0]*l+e[0]*f,t[1]=n[1]*h+i[1]*c+a[1]*l+e[1]*f,t[2]=n[2]*h+i[2]*c+a[2]*l+e[2]*f,t},e.random=function(t,n){n=n||1;var i=2*a.RANDOM()*Math.PI,e=2*a.RANDOM()-1,o=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=e*n,t},e.transformMat4=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=i[3]*a+i[7]*e+i[11]*o+i[15];return s=s||1,t[0]=(i[0]*a+i[4]*e+i[8]*o+i[12])/s,t[1]=(i[1]*a+i[5]*e+i[9]*o+i[13])/s,t[2]=(i[2]*a+i[6]*e+i[10]*o+i[14])/s,t},e.transformMat3=function(t,n,i){var a=n[0],e=n[1],o=n[2];return t[0]=a*i[0]+e*i[3]+o*i[6],t[1]=a*i[1]+e*i[4]+o*i[7],t[2]=a*i[2]+e*i[5]+o*i[8],t},e.transformQuat=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=i[0],r=i[1],u=i[2],h=i[3],c=h*a+r*o-u*e,l=h*e+u*a-s*o,f=h*o+s*e-r*a,d=-s*a-r*e-u*o;return t[0]=c*h+d*-s+l*-u-f*-r,t[1]=l*h+d*-r+f*-s-c*-u,t[2]=f*h+d*-u+c*-r-l*-s,t},e.rotateX=function(t,n,i,a){var e=[],o=[];return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],o[0]=e[0],o[1]=e[1]*Math.cos(a)-e[2]*Math.sin(a),o[2]=e[1]*Math.sin(a)+e[2]*Math.cos(a),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},e.rotateY=function(t,n,i,a){var e=[],o=[];return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],o[0]=e[2]*Math.sin(a)+e[0]*Math.cos(a),o[1]=e[1],o[2]=e[2]*Math.cos(a)-e[0]*Math.sin(a),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},e.rotateZ=function(t,n,i,a){var e=[],o=[];return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],o[0]=e[0]*Math.cos(a)-e[1]*Math.sin(a),o[1]=e[0]*Math.sin(a)+e[1]*Math.cos(a),o[2]=e[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},e.forEach=function(){var t=e.create();return function(n,i,a,e,o,s){var r,u;for(i||(i=3),a||(a=0),u=e?Math.min(e*i+a,n.length):n.length,r=a;r<u;r+=i)t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],o(t,t,s),n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2];return n}}(),e.angle=function(t,n){var i=e.fromValues(t[0],t[1],t[2]),a=e.fromValues(n[0],n[1],n[2]);e.normalize(i,i),e.normalize(a,a);var o=e.dot(i,a);return o>1?0:Math.acos(o)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=n[0],r=n[1],u=n[2];return Math.abs(i-s)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(e-r)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(o-u)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},t.exports=e},function(t,n,i){"use strict";function a(t,n){var i=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,i)}function e(t){return t instanceof Function}var o=i(1),s=i.n(o),r=i(10);class u{constructor(){this.components=[],this.components.remove=a,this.position=s.a.create(),this.velocity=s.a.create(),this.rotation=0,this.rotationAxis=s.a.fromValues(0,0,1),this._toBeRemoved=[]}addComponent(t){return e(t)&&(t={update:t}),this.components.push(t),t.init&&t.init(this),this}removeComponent(t){return this._toBeRemoved.push(t),this}removeComponentByName(t){for(var n=0;n<this.components.length;n++){const i=this.components[n];i.name!=t&&i.constructor.name!=t||this._toBeRemoved.push(i)}return this}removeComponentByTest(t){for(var n=0;n<this.components.length;n++)t(this.components[n])&&this._toBeRemoved.push(this.components[n]);return this}setPosition(t,n,i){return void 0==t&&(t=this.position[0]),void 0==n&&(n=this.position[1]),void 0==i&&(i=this.position[2]),s.a.set(this.position,t,n,i),this}setVelocity(t,n,i){return void 0==t&&(t=this.velocity[0]),void 0==n&&(n=this.velocity[1]),void 0==i&&(i=this.velocity[2]),s.a.set(this.velocity,t,n,i),this}setBounds(...t){return this.bounds=t,this}setRotation(t,n){return this.rotation=t,n&&3==n.length&&s.a.normalize(this.rotationAxis,n),this}hit(t){null==this.hitVictim&&(this.hitVictim=t)}hitBy(t){null==this.attackerHit&&(this.attackerHit=t)}update(t){for(var n=0,i=this.components.length,a=0,e=this._toBeRemoved.length;a<e;a++)for(n=0;n<i;n++)if(this.components[n]==this._toBeRemoved[a]){this.components.remove(n);break}for(this._toBeRemoved.length=0,i=this.components.length,n=0;n<i;n++)this.components[n].update(this,t)}toHTML(){var t,n=this.name;if("number"==typeof this.position.x&&(n+=" "+this.position),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}return n}}n.a=u,i.i(r.b)(u)},function(t,n){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.ENABLE_SIMD=!1,i.SIMD_AVAILABLE=i.ARRAY_TYPE===Float32Array&&"SIMD"in this,i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE,i.setMatrixArrayType=function(t){i.ARRAY_TYPE=t};var a=Math.PI/180;i.toRadian=function(t){return t*a},i.equals=function(t,n){return Math.abs(t-n)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))},t.exports=i},function(t,n,i){"use strict";var a=i(0),e=i(5);class o extends a.a{constructor(t,n,i,a=1e3,o=e["Linear"],s=2){super(),Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]),n.length=4,i.length=4,this.outputter=t,this.start=n,this.end=i,this.duration=a,this.easing=o,this.loop=s,this.elapsed=0,this.direction=1,this.out=Array(4)}reset(){this.elapsed=0}start(){this.direction=1}pause(){this.direction=0}stop(){this.pause(),this.reset()}update(t,n){const i=this.easing(this.elapsed/this.duration),a=this.start[0],e=this.start[1],o=this.start[2],s=this.start[3];this.out[0]=a+i*(this.end[0]-a),this.out[1]=e+i*(this.end[1]-e),this.out[2]=o+i*(this.end[2]-o),this.out[3]=s+i*(this.end[3]-s),this.outputter(t,this.out),this.elapsed+=n*this.direction,(this.elapsed>this.duration||this.elapsed<0)&&(2==this.loop?this.direction*=-1:1==this.loop&&(this.elapsed=0),this.elapsed=Math.min(Math.max(this.elapsed,0),this.duration))}}n.a=o},function(t,n,i){"use strict";function a(t){var n=1.70158;return t*t*((n+1)*t-n)}function e(t){var n=1.70158;return t-=1,t*t*((n+1)*t+n)+1}function o(t){var n=2.5949095;return t*=2,t<1?Math.pow(t,2)*((n+1)*t-n)/2:(t-=2,(Math.pow(t,2)*((n+1)*t+n)+2)/2)}function s(t){if(0==t||1==t)return t;var n=.3,i=n/4;return t-=1,-1*Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n)}function r(t){if(0==t||1==t)return t;var n=.3,i=n/4;return Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}function u(t){if(0==t)return 0;if(t*=2,2==t)return 1;var n=.3*1.5,i=n/4;return t<1?(t-=1,-.5*(Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n))):(t-=1,.5*(Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n))+1)}function h(t){const n=5;return 1-Math.cos(2*t*Math.PI*n)*(1-f(t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BackIn=a,n.BackOut=e,n.BackInOut=o,n.ElasticIn=s,n.ElasticOut=r,n.ElasticInOut=u,n.DampedOscillation=h;const c=t=>t;n.Linear=c;const l=t=>t*t;n.QuadIn=l;const f=t=>-t*(t-2);n.QuadOut=f;const d=t=>1-Math.sqrt(1-t*t);n.CircIn=d;const M=t=>Math.sqrt(1-(t-1)*(t-1));n.CircOut=M;const m=t=>t*t*(3-2*t);n.Smooth=m;const p=t=>-1*Math.cos(t*(Math.PI/2))+1;n.SineIn=p;const S=t=>Math.sin(t*(Math.PI/2));n.SineOut=S;const v=t=>-1*(Math.cos(Math.PI*t)-1)/2;n.SineInOut=v},function(t,n,i){"use strict";function a(){this.screen&&o(this.screen,t=>{const n=this.screen.offsetLeft,i=this.screen.offsetTop,a=t.touches&&t.touches[0],e=(a?a.pageX:t.pageX)-n,o=(a?a.pageY:t.pageY)-i;u.a.copy(this._nextClick,this.screenToWorld(e,o))})}function e(){this.keyboard&&this.keyboard.addEventListener("keydown",t=>{this._nextKey=t.which})}function o(t,n){const i=function(t){return t.stopPropagation(),t.preventDefault(),t.handled!==!0&&(n(t),void(t.handled=!0))};t.removeEventListener("touchstart",t.touchClick),t.removeEventListener("click",t.touchClick),t.addEventListener("touchstart",i),t.addEventListener("click",i),t.touchClick=i}var s=i(2),r=i(9),u=i.n(r),h=i(35),c=i.n(h);const l=u.a.create(),f=c.a.create();class d extends s.a{constructor(t,n,i){super(),this.screen=t,this.keyboard=n,this.camera=i,this.cameraSystem=i,this._nextClick=u.a.create(),this.lastClick=u.a.create(),this.hasClick=!1,this._nextKey=null,this.lastKey=null,a.call(this),e.call(this)}update(t){super.update(t),u.a.copy(this.lastClick,this._nextClick),u.a.set(this._nextClick,NaN,NaN),this.hasClick=!isNaN(this.lastClick[0]),this.lastKey=this._nextKey,this._nextKey=null}setScreen(t){this.screen=t,a.call(this)}screenToWorld(t,n){const i=this.camera,a=i.width,e=(i.height,this.screen),o=e.offsetWidth,s=e.offsetHeight,r=a/o;return u.a.set(l,t-o/2,n-s/2),u.a.scale(l,l,r),u.a.set(l,l[0]/i.scaleX,l[1]/i.scaleY),1==i.rotationAxis[2]&&(c.a.rotate(f,f,-i.rotation),u.a.transformMat2(l,l,f)),u.a.add(l,l,i.position),l}}n.a=d,d.Keys={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90}},function(t,n,i){"use strict";function a(t,n){const{context,renderQueue}=t,i=renderQueue[n];if(i){for(let n=0,a=i.length;n<a;n++)context.save(),i[n].call(t,context),context.restore();i.length=0}}var e=i(2);i(0);class o extends e.a{constructor(t,n){super(),this.context=t,this.canvas=t&&t.canvas,this.camera=n,this.cameraSystem=n,this.renderQueue=[],this.clearScreen=!0}push(t,n){n=void 0==n?1:n,this.renderQueue[n]||(this.renderQueue[n]=[]),this.renderQueue[n].push(t)}update(t){this.clearScreen&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save();var n,i,e=this.camera.position,o=this.canvas.width/2,s=this.canvas.height/2;for(this.context.translate(o,s),this.context.scale(this.camera.scaleX,this.camera.scaleY),1==this.camera.rotationAxis[2]&&this.context.rotate(-this.camera.rotation),this.context.translate(-e[0],-e[1]),n=0,i=this.renderQueue.length;n<i;n++)a(this,n);this.context.restore(),a(this,-1)}drawPath(t,n){var i=2,a=n.length;for(t.beginPath(),t.moveTo(n[0],n[1]);i<a-1;i+=2)t.lineTo(n[i],n[i+1])}strokePath(t,n,i){"undefined"==typeof n&&(n="#000"),"undefined"==typeof i&&(i=1),this.push(function(i){i.strokeStyle=n,this.drawPath(i,t),i.stroke()},i)}}n.a=o},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(t){super(),this.bounds=t}}n.a=e},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},e.clone=function(t){var n=new a.ARRAY_TYPE(2);return n[0]=t[0],n[1]=t[1],n},e.fromValues=function(t,n){var i=new a.ARRAY_TYPE(2);return i[0]=t,i[1]=n,i},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},e.set=function(t,n,i){return t[0]=n,t[1]=i,t},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t},e.sub=e.subtract,e.multiply=function(t,n,i){return t[0]=n[0]*i[0],t[1]=n[1]*i[1],t},e.mul=e.multiply,e.divide=function(t,n,i){return t[0]=n[0]/i[0],t[1]=n[1]/i[1],t},e.div=e.divide,e.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},e.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},e.min=function(t,n,i){return t[0]=Math.min(n[0],i[0]),t[1]=Math.min(n[1],i[1]),t},e.max=function(t,n,i){return t[0]=Math.max(n[0],i[0]),t[1]=Math.max(n[1],i[1]),t},e.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},e.scale=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t},e.scaleAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t},e.distance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(i*i+a*a)},e.dist=e.distance,e.squaredDistance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1];return i*i+a*a},e.sqrDist=e.squaredDistance,e.length=function(t){var n=t[0],i=t[1];return Math.sqrt(n*n+i*i)},e.len=e.length,e.squaredLength=function(t){var n=t[0],i=t[1];return n*n+i*i},e.sqrLen=e.squaredLength,e.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},e.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},e.normalize=function(t,n){var i=n[0],a=n[1],e=i*i+a*a;return e>0&&(e=1/Math.sqrt(e),t[0]=n[0]*e,t[1]=n[1]*e),t},e.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},e.cross=function(t,n,i){var a=n[0]*i[1]-n[1]*i[0];return t[0]=t[1]=0,t[2]=a,t},e.lerp=function(t,n,i,a){var e=n[0],o=n[1];return t[0]=e+a*(i[0]-e),t[1]=o+a*(i[1]-o),t},e.random=function(t,n){n=n||1;var i=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t},e.transformMat2=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[2]*e,t[1]=i[1]*a+i[3]*e,t},e.transformMat2d=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[2]*e+i[4],t[1]=i[1]*a+i[3]*e+i[5],t},e.transformMat3=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[3]*e+i[6],t[1]=i[1]*a+i[4]*e+i[7],t},e.transformMat4=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[4]*e+i[12],t[1]=i[1]*a+i[5]*e+i[13],t},e.forEach=function(){var t=e.create();return function(n,i,a,e,o,s){var r,u;for(i||(i=2),a||(a=0),u=e?Math.min(e*i+a,n.length):n.length,r=a;r<u;r+=i)t[0]=n[r],t[1]=n[r+1],o(t,t,s),n[r]=t[0],n[r+1]=t[1];return n}}(),e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]},e.equals=function(t,n){var i=t[0],e=t[1],o=n[0],s=n[1];return Math.abs(i-o)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(e-s)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))},t.exports=e},function(t,n,i){"use strict";function a(t){let n=t.match(o)||t.match(s);if(n){const t=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1];return t.format="hex",t}if(n=t.match(r)){const t=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return t.format="rgb",t}}function e(t){function n(t,n){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),this._events[t].push(n),this}function i(t,...n){this._events||(this._events={});var i=this._events[t];i&&i.length&&i.forEach(t=>{t.apply(this,n)})}t.prototype.on=n,t.prototype.fire=i}n.a=a,n.b=e;const o=/#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i,s=/#([0-9a-f])([0-9a-f])([0-9a-f])/i,r=/rgba?\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(?:,(0(?:.\d+)|1(?:.0)?))?\)/},function(t,n,i){"use strict";var a=i(2),e=i(1),o=i.n(e);class s extends a.a{constructor(){super(),this.pruneList=[],this.suspendedObjects=[],this.skewX=this.skew,this.skeyY=this.skew,this.scaleX=1,this.scaleY=1,this.rotation=0,this.rotationAxis=o.a.create(),o.a.set(this.rotationAxis,0,0,1)}setScale(t,n){n=n||t,this.scaleX=t,this.scaleY=n}setSize(t,n){this.width=t,this.height=n}addManagerForPruning(t){t instanceof GameObjectManager&&this.pruneList.push(t)}getTransformMatrix(){return this.transformMatrix}update(t){super.update(t)}}n.a=s},function(t,n,i){"use strict";function a(t,n){return t[0]*n[1]-t[1]*n[0]}var e=i(0),o=i(9),s=i.n(o);const r=s.a.create(),u=s.a.create(),h=s.a.create(),c=s.a.create(),l=s.a.create(),f=s.a.create(),d=s.a.create(),M=s.a.create(),m=s.a.create();class p extends e.a{constructor(t,n){super(),this.backgroundSystem=t,this.bounds=n,this.coefficientFriction=p.COEFFICIENT_FRICTION,this.coefficientRestitution=p.COEFFICIENT_RESTITUTION}update(t,n){var i,e,o,p,S,v=this.backgroundSystem.surfaces,I=0,x=v.length,D=this.coefficientFriction,b=this.coefficientRestitution,F=t.position[0],y=t.position[1];if(this.lastX&&Math.abs(this.lastX-F)<100&&Math.abs(this.lastY-y)<100)for(;I<x;I++)for(i=v[I],e=i.length,o=0;o<e-3;o+=2)if(s.a.set(c,i[o],i[o+1]),s.a.set(l,i[o+2],i[o+3]),s.a.subtract(l,l,c),s.a.set(f,this.lastX,this.lastY),s.a.subtract(d,t.position,f),s.a.subtract(M,f,c),p=a(M,d)/a(l,d),S=a(M,l)/a(l,d),p>=0&&p<=1&&S>=0&&S<=1){t.position[0]=this.lastX,t.position[1]=this.lastY,s.a.set(u,-l[1],l[0]),s.a.normalize(u,u),s.a.copy(m,t.velocity),s.a.scale(r,u,s.a.dot(u,m)),s.a.subtract(h,m,r),s.a.scale(h,h,D),s.a.scale(r,r,b),s.a.subtract(t.velocity,h,r);break}this.lastX=t.position[0],this.lastY=t.position[1]}}p.COEFFICIENT_FRICTION=.95,p.COEFFICIENT_RESTITUTION=.4,n.a=p},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);const s=o.a.create(),r=o.a.create(),u=o.a.create(),h=o.a.create(),c=o.a.create();class l extends a.a{constructor(){super(),this.cRestitution=.9}init(t){t.on("attack",n=>{const i=t.bounds[2]-t.bounds[0],a=t.bounds[3]-t.bounds[1],e=n.bounds[2]-n.bounds[0],l=n.bounds[3]-n.bounds[1],f=(i+a)/2,d=(e+l)/2,M=(f+d)/2,m=o.a.dist(t.position,n.position);if(m<M){o.a.subtract(s,t.position,n.position),o.a.scale(r,s,(M-m)/m);const i=1/(t.mass||1),a=1/(n.mass||1);o.a.scaleAndAdd(t.position,t.position,r,i/(i+a)),o.a.scaleAndAdd(n.position,n.position,r,-a/(i+a)),o.a.subtract(u,t.velocity,n.velocity),o.a.normalize(h,r);const e=o.a.dot(u,h);if(e>0)return;const l=-(1+this.cRestitution)*e/(i+a);o.a.scale(c,h,l),o.a.scaleAndAdd(t.velocity,t.velocity,c,i),o.a.scaleAndAdd(n.velocity,n.velocity,c,-a)}})}}n.a=l},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i){super(),this.collisionSystem=t,this.attack=n,this.vulnerable=i}update(t,n){this.attack&&this.collisionSystem.addAttackObject(t),this.vulnerable&&this.collisionSystem.addVulnerableObject(t)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n){super(),this.backgroundSystem=t,this.segments=n}update(t,n){for(var i,a,e,o,s=[],r=0,u=this.segments.length;r<u;r++){for(e=this.segments[r],a=e.length-1,o=[],i=0;i<a;i+=2)o.push(e[i]+t.position.x,e[i+1]+t.position.y);s.push(o)}this.backgroundSystem.addTemporarySurfaces(s)}}n.a=e},function(t,n,i){"use strict";function a(t,n){var i=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,i)}var e=i(2);class o extends e.a{constructor(){super(),this.objects=[],this._objectsToBeRemoved=[],this.objects.remove=a}addObject(t){return t instanceof e.a&&this.objects.push(t),t.parent=this,this}addObjectAt(t,n){return t instanceof e.a&&this.objects.splice(n,0,t),t.parent=this,this}removeObject(t){return t instanceof e.a&&this._objectsToBeRemoved.push(t),t.parent==this&&(t.parent=null),this}removeAll(){this.objects.length=0}update(t){super.update(t);var n,i=0,a=this.objects.length,e=0;for(i=0;i<a;i++)this.objects[i].update(t);for(n=this._objectsToBeRemoved.length;e<n;e++)for(i=0;i<a;i++)if(this.objects[i]==this._objectsToBeRemoved[e]){this.objects.remove(i),a--;break}this._objectsToBeRemoved.length=0}toHTML(){var t,n=this.name;if(this.objects.length>1&&(n+=" ("+this.objects.length+" items)"),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}if(this.objects.length){for(n+="<ul>",t=0;t<this.objects.length;t++)n+="<li>"+this.objects[t].toHTML();n+="</ul>"}return n}}n.a=o},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.inputSystem=t}update(t,n){if(t.bounds&&this.inputSystem.hasClick){const n=this.inputSystem.lastClick,i=t.position,a=t.bounds;a[0]+i[0]<n[0]&&a[1]+i[1]<n[1]&&a[2]+i[0]>n[0]&&a[3]+i[1]>n[1]&&this.fire("click",t)}}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const i=t.bounds,a=t.position,e=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(a[0],a[1]),i?t.scale(i[2]-i[0],i[3]-i[1]):e&&t.scale(e,e),t.arc(0,0,.5,0,2*Math.PI,!1),t.fill()})}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const i=t.bounds,a=t.position,e=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(a[0],a[1]),i?t.rect(i[0],i[1],i[2]-i[0],i[3]-i[1]):e&&t.rect(-e/2,-e/2,e,e),t.fill()})}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i,a,e="10px sans-serif",o="#000"){super(),this.renderSystem=t,this.text=n,this.font=e,this.color=o,this.setPosition(i,a)}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.translate(this.position[0],this.position[1]),n.fillStyle=this.color,n.font=this.font,n.fillText(this.text,0,0)})}}n.a=e},function(t,n,i){"use strict";var a=i(2),e=i(1),o=i.n(e),s=i(24),r=i.n(s);class u extends a.a{constructor(t,n,i,a,e){super(),this.context=t,this.canvasWidth=n,this.canvasHeight=i,this.cameraSystem=a,this.shaderProgram=e,this.mvMatrix=r.a.create(),this.pMatrix=r.a.create(),this.renderQueue=[],this.spareVector=o.a.create(),this.ambientLight=.3,this.pointLighting=1.4}push(t){this.renderQueue.push(t)}update(t){var n,i,a=this.context,e=this.cameraSystem;for(a.viewport(0,0,a.viewportWidth,a.viewportHeight),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),r.a.perspective(this.pMatrix,45*Math.PI/180,a.viewportWidth/a.viewportHeight,.1,1e4),r.a.translate(this.pMatrix,this.pMatrix,o.a.negate(this.spareVector,e.position)),e.rotation&&e.rotationAxis&&r.a.rotate(this.pMatrix,this.pMatrix,e.rotation,e.rotationAxis),a.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),n=0,i=this.renderQueue.length;n<i;n++)r.a.identity(this.mvMatrix),this.renderQueue[n].call(this,this.context,this.mvMatrix);this.renderQueue.length=0}setCanvasSize(t,n){this.canvasWidth=t,this.canvasHeight=n}}n.a=u},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i,a){super(),this.worldSystem=t,this.ax=(n||0)/2,this.ay=(i||0)/2,this.az=(a||0)/2,this.cRestitution=1,this.cFriction=1}update(t,n){var i=this.cRestitution,a=this.cFriction;t.bounds?(this.bx1=this.worldSystem.bounds[0]-t.bounds[0],this.by1=this.worldSystem.bounds[1]-t.bounds[1],this.bx2=this.worldSystem.bounds[2]-t.bounds[2],this.by2=this.worldSystem.bounds[3]-t.bounds[3],this.bz1=this.worldSystem.bounds[4]-t.bounds[4],this.bz2=this.worldSystem.bounds[5]-t.bounds[5]):(this.bx1=this.worldSystem.bounds[0]+this.ax,this.by1=this.worldSystem.bounds[1]+this.ay,this.bx2=this.worldSystem.bounds[2]-this.ax,this.by2=this.worldSystem.bounds[3]-this.ay,this.bz1=this.worldSystem.bounds[4]+this.az,this.bz2=this.worldSystem.bounds[5]-this.az),t.hasBounced=!1,t.position[0]<this.bx1?(t.position[0]=this.bx1,t.velocity[0]=-t.velocity[0]*i,t.velocity[1]=t.velocity[1]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=1):t.position[0]>this.bx2&&(t.position[0]=this.bx2,t.velocity[0]=-t.velocity[0]*i,t.velocity[1]=t.velocity[1]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=1),t.position[1]<this.by1?(t.position[1]=this.by1,t.velocity[1]=-t.velocity[1]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=2):t.position[1]>this.by2&&(t.position[1]=this.by2,t.velocity[1]=-t.velocity[1]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=2),t.position[2]<this.bz1?(t.position[2]=this.bz1,t.velocity[2]=-t.velocity[2]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[1]=t.velocity[1]*a,t.hasBounced=3):t.position[2]>this.bz2&&(t.position[2]=this.bz2,t.velocity[2]=-t.velocity[2]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[1]=t.velocity[1]*a,t.hasBounced=3)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.worldSystem=t}update(t,n){this.ax=this.worldSystem.bounds[0],this.ay=this.worldSystem.bounds[1],this.bx=this.worldSystem.bounds[2],this.by=this.worldSystem.bounds[3],this.az=this.worldSystem.bounds[4],this.bz=this.worldSystem.bounds[5],t.position[0]<this.ax&&t.velocity[0]<0?(t.position[0]=this.bx,this.fire("wrap",t)):t.position[0]>this.bx&&t.velocity[0]>0&&(t.position[0]=this.ax,this.fire("wrap",t)),t.position[1]<this.ay&&t.velocity[1]<0?(t.position[1]=this.by,this.fire("wrap",t)):t.position[1]>this.by&&t.velocity[1]>0&&(t.position[1]=this.ay,this.fire("wrap",t)),t.position[2]<this.az&&t.velocity[2]<0?(t.position[2]=this.bz,this.fire("wrap",t)):t.position[2]>this.bz&&t.velocity[2]>0&&(t.position[2]=this.az,this.fire("wrap",t))}}n.a=e},function(t,n,i){var a=i(3),e={scalar:{},SIMD:{}};e.create=function(){var t=new a.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var n=new a.ARRAY_TYPE(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.fromValues=function(t,n,i,e,o,s,r,u,h,c,l,f,d,M,m,p){var S=new a.ARRAY_TYPE(16);return S[0]=t,S[1]=n,S[2]=i,S[3]=e,S[4]=o,S[5]=s,S[6]=r,S[7]=u,S[8]=h,S[9]=c,S[10]=l,S[11]=f,S[12]=d,S[13]=M,S[14]=m,S[15]=p,S},e.set=function(t,n,i,a,e,o,s,r,u,h,c,l,f,d,M,m,p){return t[0]=n,t[1]=i,t[2]=a,t[3]=e,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=h,t[9]=c,t[10]=l,t[11]=f,t[12]=d,t[13]=M,t[14]=m,t[15]=p,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.scalar.transpose=function(t,n){if(t===n){var i=n[1],a=n[2],e=n[3],o=n[6],s=n[7],r=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=i,t[6]=n[9],t[7]=n[13],t[8]=a,t[9]=o,t[11]=n[14],t[12]=e,t[13]=s,t[14]=r}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},e.SIMD.transpose=function(t,n){var i,a,e,o,s,r,u,h,c,l;return i=SIMD.Float32x4.load(n,0),a=SIMD.Float32x4.load(n,4),e=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12),s=SIMD.Float32x4.shuffle(i,a,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),u=SIMD.Float32x4.shuffle(s,r,0,2,4,6),h=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,h),s=SIMD.Float32x4.shuffle(i,a,2,3,6,7),r=SIMD.Float32x4.shuffle(e,o,2,3,6,7),c=SIMD.Float32x4.shuffle(s,r,0,2,4,6),l=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,l),t},e.transpose=a.USE_SIMD?e.SIMD.transpose:e.scalar.transpose,e.scalar.invert=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],d=n[11],M=n[12],m=n[13],p=n[14],S=n[15],v=i*r-a*s,I=i*u-e*s,x=i*h-o*s,D=a*u-e*r,b=a*h-o*r,F=e*h-o*u,y=c*m-l*M,g=c*p-f*M,w=c*S-d*M,A=l*p-f*m,E=l*S-d*m,R=f*S-d*p,z=v*R-I*E+x*A+D*w-b*g+F*y;return z?(z=1/z,t[0]=(r*R-u*E+h*A)*z,t[1]=(e*E-a*R-o*A)*z,t[2]=(m*F-p*b+S*D)*z,t[3]=(f*b-l*F-d*D)*z,t[4]=(u*w-s*R-h*g)*z,t[5]=(i*R-e*w+o*g)*z,t[6]=(p*x-M*F-S*I)*z,t[7]=(c*F-f*x+d*I)*z,t[8]=(s*E-r*w+h*y)*z,t[9]=(a*w-i*E-o*y)*z,t[10]=(M*b-m*x+S*v)*z,t[11]=(l*x-c*b-d*v)*z,t[12]=(r*g-s*A-u*y)*z,t[13]=(i*A-a*g+e*y)*z,t[14]=(m*I-M*D-p*v)*z,t[15]=(c*D-l*I+f*v)*z,t):null},e.SIMD.invert=function(t,n){var i,a,e,o,s,r,u,h,c,l,f=SIMD.Float32x4.load(n,0),d=SIMD.Float32x4.load(n,4),M=SIMD.Float32x4.load(n,8),m=SIMD.Float32x4.load(n,12);return s=SIMD.Float32x4.shuffle(f,d,0,1,4,5),a=SIMD.Float32x4.shuffle(M,m,0,1,4,5),i=SIMD.Float32x4.shuffle(s,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,s,1,3,5,7),s=SIMD.Float32x4.shuffle(f,d,2,3,6,7),o=SIMD.Float32x4.shuffle(M,m,2,3,6,7),e=SIMD.Float32x4.shuffle(s,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,s,1,3,5,7),s=SIMD.Float32x4.mul(e,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.mul(a,s),u=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),r),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(a,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),r),c=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(o,s)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),r),h=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(e,s)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),s=SIMD.Float32x4.mul(i,a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),h),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,s),c),s=SIMD.Float32x4.swizzle(s,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,s),h),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(e,s)),s=SIMD.Float32x4.mul(i,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(e,s)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),h),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),u),
h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(a,s)),s=SIMD.Float32x4.mul(i,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,s)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),c),l=SIMD.Float32x4.mul(i,r),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,2,3,0,1),l),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,1,0,3,2),l),s=SIMD.Float32x4.reciprocalApproximation(l),l=SIMD.Float32x4.sub(SIMD.Float32x4.add(s,s),SIMD.Float32x4.mul(l,SIMD.Float32x4.mul(s,s))),(l=SIMD.Float32x4.swizzle(l,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(l,r)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(l,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(l,h)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(l,c)),t):null},e.invert=a.USE_SIMD?e.SIMD.invert:e.scalar.invert,e.scalar.adjoint=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],d=n[11],M=n[12],m=n[13],p=n[14],S=n[15];return t[0]=r*(f*S-d*p)-l*(u*S-h*p)+m*(u*d-h*f),t[1]=-(a*(f*S-d*p)-l*(e*S-o*p)+m*(e*d-o*f)),t[2]=a*(u*S-h*p)-r*(e*S-o*p)+m*(e*h-o*u),t[3]=-(a*(u*d-h*f)-r*(e*d-o*f)+l*(e*h-o*u)),t[4]=-(s*(f*S-d*p)-c*(u*S-h*p)+M*(u*d-h*f)),t[5]=i*(f*S-d*p)-c*(e*S-o*p)+M*(e*d-o*f),t[6]=-(i*(u*S-h*p)-s*(e*S-o*p)+M*(e*h-o*u)),t[7]=i*(u*d-h*f)-s*(e*d-o*f)+c*(e*h-o*u),t[8]=s*(l*S-d*m)-c*(r*S-h*m)+M*(r*d-h*l),t[9]=-(i*(l*S-d*m)-c*(a*S-o*m)+M*(a*d-o*l)),t[10]=i*(r*S-h*m)-s*(a*S-o*m)+M*(a*h-o*r),t[11]=-(i*(r*d-h*l)-s*(a*d-o*l)+c*(a*h-o*r)),t[12]=-(s*(l*p-f*m)-c*(r*p-u*m)+M*(r*f-u*l)),t[13]=i*(l*p-f*m)-c*(a*p-e*m)+M*(a*f-e*l),t[14]=-(i*(r*p-u*m)-s*(a*p-e*m)+M*(a*u-e*r)),t[15]=i*(r*f-u*l)-s*(a*f-e*l)+c*(a*u-e*r),t},e.SIMD.adjoint=function(t,n){var i,a,e,o,s,r,u,h,c,l,f,d,M,i=SIMD.Float32x4.load(n,0),a=SIMD.Float32x4.load(n,4),e=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12);return c=SIMD.Float32x4.shuffle(i,a,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),s=SIMD.Float32x4.shuffle(c,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,c,1,3,5,7),c=SIMD.Float32x4.shuffle(i,a,2,3,6,7),h=SIMD.Float32x4.shuffle(e,o,2,3,6,7),u=SIMD.Float32x4.shuffle(c,h,0,2,4,6),h=SIMD.Float32x4.shuffle(h,c,1,3,5,7),c=SIMD.Float32x4.mul(u,h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.mul(r,c),f=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,c),l),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(r,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),l),M=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(h,c)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),l),d=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(s,r),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),d),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),M),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,c),d),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(s,h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,c)),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),f),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(r,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(h,c)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,c),M),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,M),t},e.adjoint=a.USE_SIMD?e.SIMD.adjoint:e.scalar.adjoint,e.determinant=function(t){var n=t[0],i=t[1],a=t[2],e=t[3],o=t[4],s=t[5],r=t[6],u=t[7],h=t[8],c=t[9],l=t[10],f=t[11],d=t[12],M=t[13],m=t[14],p=t[15],S=n*s-i*o,v=n*r-a*o,I=n*u-e*o,x=i*r-a*s,D=i*u-e*s,b=a*u-e*r,F=h*M-c*d,y=h*m-l*d,g=h*p-f*d,w=c*m-l*M,A=c*p-f*M,E=l*p-f*m;return S*E-v*A+I*w+x*g-D*y+b*F},e.SIMD.multiply=function(t,n,i){var a=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4.load(i,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,3,3,3,3),s))));SIMD.Float32x4.store(t,0,u);var h=SIMD.Float32x4.load(i,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),s))));SIMD.Float32x4.store(t,4,c);var l=SIMD.Float32x4.load(i,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),s))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(i,12),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),s))));return SIMD.Float32x4.store(t,12,M),t},e.scalar.multiply=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=n[9],d=n[10],M=n[11],m=n[12],p=n[13],S=n[14],v=n[15],I=i[0],x=i[1],D=i[2],b=i[3];return t[0]=I*a+x*r+D*l+b*m,t[1]=I*e+x*u+D*f+b*p,t[2]=I*o+x*h+D*d+b*S,t[3]=I*s+x*c+D*M+b*v,I=i[4],x=i[5],D=i[6],b=i[7],t[4]=I*a+x*r+D*l+b*m,t[5]=I*e+x*u+D*f+b*p,t[6]=I*o+x*h+D*d+b*S,t[7]=I*s+x*c+D*M+b*v,I=i[8],x=i[9],D=i[10],b=i[11],t[8]=I*a+x*r+D*l+b*m,t[9]=I*e+x*u+D*f+b*p,t[10]=I*o+x*h+D*d+b*S,t[11]=I*s+x*c+D*M+b*v,I=i[12],x=i[13],D=i[14],b=i[15],t[12]=I*a+x*r+D*l+b*m,t[13]=I*e+x*u+D*f+b*p,t[14]=I*o+x*h+D*d+b*S,t[15]=I*s+x*c+D*M+b*v,t},e.multiply=a.USE_SIMD?e.SIMD.multiply:e.scalar.multiply,e.mul=e.multiply,e.scalar.translate=function(t,n,i){var a,e,o,s,r,u,h,c,l,f,d,M,m=i[0],p=i[1],S=i[2];return n===t?(t[12]=n[0]*m+n[4]*p+n[8]*S+n[12],t[13]=n[1]*m+n[5]*p+n[9]*S+n[13],t[14]=n[2]*m+n[6]*p+n[10]*S+n[14],t[15]=n[3]*m+n[7]*p+n[11]*S+n[15]):(a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=n[9],d=n[10],M=n[11],t[0]=a,t[1]=e,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=h,t[7]=c,t[8]=l,t[9]=f,t[10]=d,t[11]=M,t[12]=a*m+r*p+l*S+n[12],t[13]=e*m+u*p+f*S+n[13],t[14]=o*m+h*p+d*S+n[14],t[15]=s*m+c*p+M*S+n[15]),t},e.SIMD.translate=function(t,n,i){var a=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4(i[0],i[1],i[2],0);n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11]),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(r,0,0,0,0)),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(r,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(r,2,2,2,2));var u=SIMD.Float32x4.add(a,SIMD.Float32x4.add(e,SIMD.Float32x4.add(o,s)));return SIMD.Float32x4.store(t,12,u),t},e.translate=a.USE_SIMD?e.SIMD.translate:e.scalar.translate,e.scalar.scale=function(t,n,i){var a=i[0],e=i[1],o=i[2];return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.SIMD.scale=function(t,n,i){var a,e,o,s=SIMD.Float32x4(i[0],i[1],i[2],0);return a=SIMD.Float32x4.load(n,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,0,0,0,0))),e=SIMD.Float32x4.load(n,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(s,1,1,1,1))),o=SIMD.Float32x4.load(n,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2))),t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.scale=a.USE_SIMD?e.SIMD.scale:e.scalar.scale,e.rotate=function(t,n,i,e){var o,s,r,u,h,c,l,f,d,M,m,p,S,v,I,x,D,b,F,y,g,w,A,E,R=e[0],z=e[1],_=e[2],P=Math.sqrt(R*R+z*z+_*_);return Math.abs(P)<a.EPSILON?null:(P=1/P,R*=P,z*=P,_*=P,o=Math.sin(i),s=Math.cos(i),r=1-s,u=n[0],h=n[1],c=n[2],l=n[3],f=n[4],d=n[5],M=n[6],m=n[7],p=n[8],S=n[9],v=n[10],I=n[11],x=R*R*r+s,D=z*R*r+_*o,b=_*R*r-z*o,F=R*z*r-_*o,y=z*z*r+s,g=_*z*r+R*o,w=R*_*r+z*o,A=z*_*r-R*o,E=_*_*r+s,t[0]=u*x+f*D+p*b,t[1]=h*x+d*D+S*b,t[2]=c*x+M*D+v*b,t[3]=l*x+m*D+I*b,t[4]=u*F+f*y+p*g,t[5]=h*F+d*y+S*g,t[6]=c*F+M*y+v*g,t[7]=l*F+m*y+I*g,t[8]=u*w+f*A+p*E,t[9]=h*w+d*A+S*E,t[10]=c*w+M*A+v*E,t[11]=l*w+m*A+I*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},e.scalar.rotateX=function(t,n,i){var a=Math.sin(i),e=Math.cos(i),o=n[4],s=n[5],r=n[6],u=n[7],h=n[8],c=n[9],l=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*e+h*a,t[5]=s*e+c*a,t[6]=r*e+l*a,t[7]=u*e+f*a,t[8]=h*e-o*a,t[9]=c*e-s*a,t[10]=l*e-r*a,t[11]=f*e-u*a,t},e.SIMD.rotateX=function(t,n,i){var a=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i));n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,4),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,e),SIMD.Float32x4.mul(o,a))),t},e.rotateX=a.USE_SIMD?e.SIMD.rotateX:e.scalar.rotateX,e.scalar.rotateY=function(t,n,i){var a=Math.sin(i),e=Math.cos(i),o=n[0],s=n[1],r=n[2],u=n[3],h=n[8],c=n[9],l=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*e-h*a,t[1]=s*e-c*a,t[2]=r*e-l*a,t[3]=u*e-f*a,t[8]=o*a+h*e,t[9]=s*a+c*e,t[10]=r*a+l*e,t[11]=u*a+f*e,t},e.SIMD.rotateY=function(t,n,i){var a=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i));n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(s,e))),t},e.rotateY=a.USE_SIMD?e.SIMD.rotateY:e.scalar.rotateY,e.scalar.rotateZ=function(t,n,i){var a=Math.sin(i),e=Math.cos(i),o=n[0],s=n[1],r=n[2],u=n[3],h=n[4],c=n[5],l=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*e+h*a,t[1]=s*e+c*a,t[2]=r*e+l*a,t[3]=u*e+f*a,t[4]=h*e-o*a,t[5]=c*e-s*a,t[6]=l*e-r*a,t[7]=f*e-u*a,t},e.SIMD.rotateZ=function(t,n,i){var a=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i));n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,a))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,e),SIMD.Float32x4.mul(o,a))),t},e.rotateZ=a.USE_SIMD?e.SIMD.rotateZ:e.scalar.rotateZ,e.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,n,i){var e,o,s,r=i[0],u=i[1],h=i[2],c=Math.sqrt(r*r+u*u+h*h);return Math.abs(c)<a.EPSILON?null:(c=1/c,r*=c,u*=c,h*=c,e=Math.sin(n),o=Math.cos(n),s=1-o,t[0]=r*r*s+o,t[1]=u*r*s+h*e,t[2]=h*r*s-u*e,t[3]=0,t[4]=r*u*s-h*e,t[5]=u*u*s+o,t[6]=h*u*s+r*e,t[7]=0,t[8]=r*h*s+u*e,t[9]=u*h*s-r*e,t[10]=h*h*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=a+a,u=e+e,h=o+o,c=a*r,l=a*u,f=a*h,d=e*u,M=e*h,m=o*h,p=s*r,S=s*u,v=s*h;return t[0]=1-(d+m),t[1]=l+v,t[2]=f-S,t[3]=0,t[4]=l-v,t[5]=1-(c+m),t[6]=M+p,t[7]=0,t[8]=f+S,t[9]=M-p,t[10]=1-(c+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},e.getTranslation=function(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t},e.getRotation=function(t,n){var i=n[0]+n[5]+n[10],a=0;return i>0?(a=2*Math.sqrt(i+1),t[3]=.25*a,t[0]=(n[6]-n[9])/a,t[1]=(n[8]-n[2])/a,t[2]=(n[1]-n[4])/a):n[0]>n[5]&n[0]>n[10]?(a=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/a,t[0]=.25*a,t[1]=(n[1]+n[4])/a,t[2]=(n[8]+n[2])/a):n[5]>n[10]?(a=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/a,t[0]=(n[1]+n[4])/a,t[1]=.25*a,t[2]=(n[6]+n[9])/a):(a=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/a,t[0]=(n[8]+n[2])/a,t[1]=(n[6]+n[9])/a,t[2]=.25*a),t},e.fromRotationTranslationScale=function(t,n,i,a){var e=n[0],o=n[1],s=n[2],r=n[3],u=e+e,h=o+o,c=s+s,l=e*u,f=e*h,d=e*c,M=o*h,m=o*c,p=s*c,S=r*u,v=r*h,I=r*c,x=a[0],D=a[1],b=a[2];return t[0]=(1-(M+p))*x,t[1]=(f+I)*x,t[2]=(d-v)*x,t[3]=0,t[4]=(f-I)*D,t[5]=(1-(l+p))*D,t[6]=(m+S)*D,t[7]=0,t[8]=(d+v)*b,t[9]=(m-S)*b,t[10]=(1-(l+M))*b,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,n,i,a,e){var o=n[0],s=n[1],r=n[2],u=n[3],h=o+o,c=s+s,l=r+r,f=o*h,d=o*c,M=o*l,m=s*c,p=s*l,S=r*l,v=u*h,I=u*c,x=u*l,D=a[0],b=a[1],F=a[2],y=e[0],g=e[1],w=e[2];return t[0]=(1-(m+S))*D,t[1]=(d+x)*D,t[2]=(M-I)*D,t[3]=0,t[4]=(d-x)*b,t[5]=(1-(f+S))*b,t[6]=(p+v)*b,t[7]=0,t[8]=(M+I)*F,t[9]=(p-v)*F,t[10]=(1-(f+m))*F,t[11]=0,t[12]=i[0]+y-(t[0]*y+t[4]*g+t[8]*w),t[13]=i[1]+g-(t[1]*y+t[5]*g+t[9]*w),t[14]=i[2]+w-(t[2]*y+t[6]*g+t[10]*w),t[15]=1,t},e.fromQuat=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=i+i,r=a+a,u=e+e,h=i*s,c=a*s,l=a*r,f=e*s,d=e*r,M=e*u,m=o*s,p=o*r,S=o*u;return t[0]=1-l-M,t[1]=c+S,t[2]=f-p,t[3]=0,t[4]=c-S,t[5]=1-h-M,t[6]=d+m,t[7]=0,t[8]=f+p,t[9]=d-m,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,n,i,a,e,o,s){var r=1/(i-n),u=1/(e-a),h=1/(o-s);return t[0]=2*o*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+n)*r,t[9]=(e+a)*u,t[10]=(s+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*h,t[15]=0,t},e.perspective=function(t,n,i,a,e){var o=1/Math.tan(n/2),s=1/(a-e);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+a)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*a*s,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,n,i,a){var e=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),s=Math.tan(n.leftDegrees*Math.PI/180),r=Math.tan(n.rightDegrees*Math.PI/180),u=2/(s+r),h=2/(e+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-((s-r)*u*.5),t[9]=(e-o)*h*.5,t[10]=a/(i-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i/(i-a),t[15]=0,t},e.ortho=function(t,n,i,a,e,o,s){var r=1/(n-i),u=1/(a-e),h=1/(o-s);return t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(n+i)*r,t[13]=(e+a)*u,t[14]=(s+o)*h,t[15]=1,t},e.lookAt=function(t,n,i,o){var s,r,u,h,c,l,f,d,M,m,p=n[0],S=n[1],v=n[2],I=o[0],x=o[1],D=o[2],b=i[0],F=i[1],y=i[2];return Math.abs(p-b)<a.EPSILON&&Math.abs(S-F)<a.EPSILON&&Math.abs(v-y)<a.EPSILON?e.identity(t):(f=p-b,d=S-F,M=v-y,m=1/Math.sqrt(f*f+d*d+M*M),f*=m,d*=m,M*=m,s=x*M-D*d,r=D*f-I*M,u=I*d-x*f,m=Math.sqrt(s*s+r*r+u*u),m?(m=1/m,s*=m,r*=m,u*=m):(s=0,r=0,u=0),h=d*u-M*r,c=M*s-f*u,l=f*r-d*s,m=Math.sqrt(h*h+c*c+l*l),m?(m=1/m,h*=m,c*=m,l*=m):(h=0,c=0,l=0),t[0]=s,t[1]=h,t[2]=f,t[3]=0,t[4]=r,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=l,t[10]=M,t[11]=0,t[12]=-(s*p+r*S+u*v),t[13]=-(h*p+c*S+l*v),t[14]=-(f*p+d*S+M*v),t[15]=1,t)},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t[4]=n[4]+i[4],t[5]=n[5]+i[5],t[6]=n[6]+i[6],t[7]=n[7]+i[7],t[8]=n[8]+i[8],t[9]=n[9]+i[9],t[10]=n[10]+i[10],t[11]=n[11]+i[11],t[12]=n[12]+i[12],t[13]=n[13]+i[13],t[14]=n[14]+i[14],t[15]=n[15]+i[15],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t[4]=n[4]-i[4],t[5]=n[5]-i[5],t[6]=n[6]-i[6],t[7]=n[7]-i[7],t[8]=n[8]-i[8],t[9]=n[9]-i[9],t[10]=n[10]-i[10],t[11]=n[11]-i[11],t[12]=n[12]-i[12],t[13]=n[13]-i[13],t[14]=n[14]-i[14],t[15]=n[15]-i[15],t},e.sub=e.subtract,e.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=n[11]*i,t[12]=n[12]*i,t[13]=n[13]*i,t[14]=n[14]*i,t[15]=n[15]*i,t},e.multiplyScalarAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t[3]=n[3]+i[3]*a,t[4]=n[4]+i[4]*a,t[5]=n[5]+i[5]*a,t[6]=n[6]+i[6]*a,t[7]=n[7]+i[7]*a,t[8]=n[8]+i[8]*a,t[9]=n[9]+i[9]*a,t[10]=n[10]+i[10]*a,t[11]=n[11]+i[11]*a,t[12]=n[12]+i[12]*a,t[13]=n[13]+i[13]*a,t[14]=n[14]+i[14]*a,t[15]=n[15]+i[15]*a,t},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=t[3],r=t[4],u=t[5],h=t[6],c=t[7],l=t[8],f=t[9],d=t[10],M=t[11],m=t[12],p=t[13],S=t[14],v=t[15],I=n[0],x=n[1],D=n[2],b=n[3],F=n[4],y=n[5],g=n[6],w=n[7],A=n[8],E=n[9],R=n[10],z=n[11],_=n[12],P=n[13],C=n[14],T=n[15];return Math.abs(i-I)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(I))&&Math.abs(e-x)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(o-D)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(s-b)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(r-F)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(F))&&Math.abs(u-y)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-g)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(c-w)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(l-A)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-E)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(M-z)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(z))&&Math.abs(m-_)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(_))&&Math.abs(p-P)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(S-C)<=a.EPSILON*Math.max(1,Math.abs(S),Math.abs(C))&&Math.abs(v-T)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))},t.exports=e},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);const s=o.a.create(),r=o.a.create(),u=o.a.create(),h=o.a.create();class c extends a.a{constructor(t){super(),this.flock=t}update(t,n){o.a.set(u,0,0,0),o.a.set(r,0,0,0),o.a.set(s,0,0,0),o.a.set(h,0,0,0);let i=0;const a=this.flock.length;for(let e=0;e<a;e++){const n=this.flock[e],a=o.a.dist(n.position,t.position);a>0&&a<c.NEIGHBOUR_RADIUS&&(o.a.add(u,u,n.position),o.a.add(r,r,n.velocity),a<c.SEPARATION_RADIUS&&(o.a.subtract(h,t.position,n.position),o.a.normalize(h,h),o.a.scaleAndAdd(s,s,h,1/a)),i++)}if(i>0){o.a.scale(u,u,1/i),o.a.subtract(u,u,t.position),o.a.scaleAndAdd(t.velocity,t.velocity,u,c.COHESION_WEIGHT),o.a.scaleAndAdd(t.velocity,t.velocity,r,c.ALIGN_WEIGHT/i),o.a.scaleAndAdd(t.velocity,t.velocity,s,c.SEPARATION_WEIGHT/i);var l=o.a.length(t.velocity);l>c.MAX_SPEED&&o.a.scale(t.velocity,t.velocity,c.MAX_SPEED/l)}}}n.a=c,c.NEIGHBOUR_RADIUS=200,c.SEPARATION_RADIUS=150,c.MAX_SPEED=.1,c.COHESION_WEIGHT=.1*c.MAX_SPEED/c.NEIGHBOUR_RADIUS,c.ALIGN_WEIGHT=30*c.MAX_SPEED/c.NEIGHBOUR_RADIUS,c.SEPARATION_WEIGHT=100/c.SEPARATION_RADIUS},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super()}playSound(t){t.audio&&t.audio.play()}}n.a=e},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(4),e=i(39),o=i(37),s=i(38),r=i(40);i.d(n,"PropertyAnimationComponent",function(){return a.a}),i.d(n,"PositionAnimationComponent",function(){return e.a}),i.d(n,"BoundsAnimationComponent",function(){return o.a}),i.d(n,"ColorAnimationComponent",function(){return s.a}),i.d(n,"RotationAnimationComponent",function(){return r.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(43);i.d(n,"MoveComponent",function(){return a.a});var e=i(44);i.d(n,"PhysicsComponent",function(){return e.a});var o=i(42);i.d(n,"GravityComponent",function(){return o.a});var s=i(45);i.d(n,"PointGravityComponent",function(){return s.a});var r=i(54);i.d(n,"TerminalVelocityComponent",function(){return r.a});var u=i(41);i.d(n,"FollowComponent",function(){return u.a});var h=i(51);i.d(n,"RotationComponent",function(){return h.a});var c=i(50);i.d(n,"RotateToHeadingComponent",function(){return c.a});var l=i(55);i.d(n,"TrackRotationComponent",function(){return l.a});var f=i(48);i.d(n,"RandomPositionComponent",function(){return f.a});var d=i(49);i.d(n,"RandomVelocityComponent",function(){return d.a});var M=i(47);i.d(n,"RandomImpulseComponent",function(){return M.a});var m=i(25);i.d(n,"FlockingComponent",function(){return m.a});var p=i(53);i.d(n,"SwitchComponent",function(){return p.a});var S=i(46);i.d(n,"PositionInterpolatorComponent",function(){return S.a});var v=i(52);i.d(n,"RotationInterpolatorComponent",function(){return v.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(57);i.d(n,"CollisionSystem",function(){return a.a});var e=i(14);i.d(n,"CollisionComponent",function(){return e.a});var o=i(13);i.d(n,"BounceComponent",function(){return o.a});var s=i(56);i.d(n,"BackgroundCollisionSystem",function(){return s.a});var r=i(12);i.d(n,"BackgroundCollisionComponent",function(){return r.a});var u=i(15);i.d(n,"SolidComponent",function(){return u.a})},function(t,n,i){"use strict";function a(t){function n(i){if(i&&t.time==i)return void console.log("Multiple calls: "+i);t.time=i,t.frame++;try{t.root.update(Math.min(i-t._lastTime,100)),t.state==f&&p(n),t._lastTime=i}catch(t){window.console&&console.error(t.stack||t)}}n(t._lastTime)}function e(t,n){t._loaded++,t.fire("resourcesProgress",t._loaded/t._toLoad),t._toLoad-t._loaded<=0&&t.fire("resourcesLoaded")}var o=(i(2),i(16)),s=(i(0),i(11)),r=i(7),u=i(8),h=i(6),c=i(10);const l=0,f=1,d=2,M=3;let m=0;const p="undefined"!=typeof window&&window.requestAnimationFrame||function(t,n){var i=(new Date).getTime(),a=Math.max(0,16-(i-m)),e=setTimeout(function(){t(i+a)},a);return m=i+a,e};class S{constructor(t={}){this.canvas=t.canvas,this.width=t.width||this.canvas&&this.canvas.width||0,this.height=t.height||this.canvas&&this.canvas.height||0,this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.root=new o.a,this.textures=[],this.sounds=[],this.frame=0,this.time=0,this.score=t.score||0,this.lives=t.lives||0,this.level=t.level||0,this._toLoad=0,this._lastTime=0,this._loaded=0,this._autosizeCallback=(()=>{if(this.canvas){const t=this.canvas.offsetWidth,n=this.canvas.offsetHeight;this.setSize(t,n),this.cameraSystem&&this.cameraSystem.setPosition(t/2,n/2),this.worldSystem&&this.worldSystem.setBounds(0,0,t,n)}}),t.autosize&&this.setAutosize(!0)}setCanvas(t){this.canvas=t,this.canvas&&(this.width=this.width||this.canvas.width,this.height=this.height||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height)}loadTextures(t){this._toLoad+=t.length;var n=this;return t.map(function(t){var i={image:new Image,width:0,height:0,loaded:!1};return i.image.onload=function(){i.width=i.image.width,i.height=i.image.height,i.loaded=!0,e(n,i)},i.image.onerror=function(){throw new Error("Failed to load a texture: "+t)},i.image.src=t,n.textures.push(i),i})}loadAudio(t){this._toLoad+=t.length;var n=this;return t.map(function(t){var i={audio:new Audio,length:0,laoded:!1};return i.audio.addEventListener("canplaythrough",()=>{i.loaded||(i.length=i.audio.duration,i.loaded=!0,e(n,i))}),i.audio.onerror=function(){throw new Error("Failed to load a sound: "+t)},i.audio.src=t,n.sounds.push(i),i})}start(){this.nextLevel(),this.state=f,a(this)}stop(){this.state=d}getDefaultCamera(){return this.cameraSystem||(this.cameraSystem=new s.a,this.cameraSystem.setPosition(this.width/2,this.height/2)),this.cameraSystem}getDefaultRenderer(){if(!this.renderSystem){this.cameraSystem||this.getDefaultCamera();let t;this.canvas&&(t=this.canvas.getContext("2d")),this.renderSystem=new r.a(t,this.cameraSystem)}return this.renderSystem}getDefaultWorld(t=0,n=t){const i=[-t,-n,this.width+t,this.height+n];return this.worldSystem?this.worldSystem.setBounds(...i):this.worldSystem=new u.a(i),this.worldSystem}getDefaultInput(){return this.inputSystem||(this.cameraSystem||this.getDefaultCamera(),this.inputSystem=new h.a(this.canvas,"undefined"!=typeof document&&document,this.cameraSystem)),this.inputSystem}setScore(t){this.score=t,this.fire("score",this.score)}nextLevel(){this.level++,this.fire("loadLevel",this.level)}setLevel(t){this.level=t,this.fire("loadLevel",this.level)}completeLevel(){this.fire("levelComplete",this.level)}setSize(t,n){this.width=t,this.height=n,this.canvas&&(this.canvas.width=t,this.canvas.height=n)}setAutosize(t){t?window.addEventListener("resize",this._autosizeCallback):window.removeEventListener("resize",this._autosizeCallback)}}n.a=S,i.i(c.b)(S),S.STATE_PAUSED=l,S.STATE_PLAYING=f,S.STATE_STOPPED=d,S.STATE_DEAD=M},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(58);i.d(n,"DebugDrawBoundsComponent",function(){return a.a});var e=i(59);i.d(n,"DebugDrawPathComponent",function(){return e.a});var o=i(60);i.d(n,"DebugDrawSurfacesComponent",function(){return o.a});var s=i(61);i.d(n,"DebugFlockingComponent",function(){return s.a});var r=i(62);i.d(n,"PositionRenderComponent",function(){return r.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(6);i.d(n,"InputSystem",function(){return a.a});var e=i(17);i.d(n,"ClickComponent",function(){return e.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(7);i.d(n,"CanvasRenderSystem",function(){return a.a});var e=i(18);i.d(n,"DotRenderComponent",function(){return e.a});var o=i(19);i.d(n,"RectangleRenderComponent",function(){return o.a});var s=i(20);i.d(n,"TextRenderComponent",function(){return s.a});var r=i(21);i.d(n,"WebGLRenderSystem",function(){return r.a});var u=i(63);i.d(n,"PolyShapeRenderComponent",function(){return u.a});var h=i(64);i.d(n,"TileComponent",function(){return h.a}),i.d(n,"SpriteRenderingComponent",function(){return h.b}),i.d(n,"SpriteAnimationComponent",function(){return h.c}),i.d(n,"Sprite",function(){return h.d}),i.d(n,"AnimatedSpriteComponent",function(){return h.e}),i.d(n,"CanvasSpriteRenderingComponent",function(){return h.f})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(8);i.d(n,"WorldSystem",function(){return a.a});var e=i(22);i.d(n,"WorldBounceComponent",function(){return e.a});var o=i(23);i.d(n,"WorldWrapComponent",function(){return o.a})},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var n=new a.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,n,i,e){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=n,o[2]=i,o[3]=e,o},e.set=function(t,n,i,a,e){return t[0]=n,t[1]=i,t[2]=a,t[3]=e,t},e.transpose=function(t,n){if(t===n){var i=n[1];t[1]=n[2],t[2]=i}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},e.invert=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=i*o-e*a;return s?(s=1/s,t[0]=o*s,t[1]=-a*s,t[2]=-e*s,t[3]=i*s,t):null},e.adjoint=function(t,n){var i=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=i,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=i[0],u=i[1],h=i[2],c=i[3];return t[0]=a*r+o*u,t[1]=e*r+s*u,t[2]=a*h+o*c,t[3]=e*h+s*c,t},e.mul=e.multiply,e.rotate=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=Math.sin(i),u=Math.cos(i);return t[0]=a*u+o*r,t[1]=e*u+s*r,t[2]=a*-r+o*u,t[3]=e*-r+s*u,t},e.scale=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=i[0],u=i[1];return t[0]=a*r,t[1]=e*r,t[2]=o*u,t[3]=s*u,t},e.fromRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=i,t[2]=-i,t[3]=a,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,n,i,a){return t[2]=a[2]/a[0],i[0]=a[0],i[1]=a[1],i[3]=a[3]-t[2]*i[1],[t,n,i]},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t},e.sub=e.subtract,e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=t[3],r=n[0],u=n[1],h=n[2],c=n[3];return Math.abs(i-r)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(e-u)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(o-h)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-c)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))},e.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t},e.multiplyScalarAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t[3]=n[3]+i[3]*a,t},t.exports=e},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},e.clone=function(t){var n=new a.ARRAY_TYPE(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},e.fromValues=function(t,n,i,e,o,s,r,u,h){var c=new a.ARRAY_TYPE(9);return c[0]=t,c[1]=n,c[2]=i,c[3]=e,c[4]=o,c[5]=s,c[6]=r,c[7]=u,c[8]=h,c},e.set=function(t,n,i,a,e,o,s,r,u,h){return t[0]=n,t[1]=i,t[2]=a,t[3]=e,t[4]=o,t[5]=s,t[6]=r,t[7]=u,
t[8]=h,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,n){if(t===n){var i=n[1],a=n[2],e=n[5];t[1]=n[3],t[2]=n[6],t[3]=i,t[5]=n[7],t[6]=a,t[7]=e}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},e.invert=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=c*s-r*h,f=-c*o+r*u,d=h*o-s*u,M=i*l+a*f+e*d;return M?(M=1/M,t[0]=l*M,t[1]=(-c*a+e*h)*M,t[2]=(r*a-e*s)*M,t[3]=f*M,t[4]=(c*i-e*u)*M,t[5]=(-r*i+e*o)*M,t[6]=d*M,t[7]=(-h*i+a*u)*M,t[8]=(s*i-a*o)*M,t):null},e.adjoint=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8];return t[0]=s*c-r*h,t[1]=e*h-a*c,t[2]=a*r-e*s,t[3]=r*u-o*c,t[4]=i*c-e*u,t[5]=e*o-i*r,t[6]=o*h-s*u,t[7]=a*u-i*h,t[8]=i*s-a*o,t},e.determinant=function(t){var n=t[0],i=t[1],a=t[2],e=t[3],o=t[4],s=t[5],r=t[6],u=t[7],h=t[8];return n*(h*o-s*u)+i*(-h*e+s*r)+a*(u*e-o*r)},e.multiply=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=i[0],d=i[1],M=i[2],m=i[3],p=i[4],S=i[5],v=i[6],I=i[7],x=i[8];return t[0]=f*a+d*s+M*h,t[1]=f*e+d*r+M*c,t[2]=f*o+d*u+M*l,t[3]=m*a+p*s+S*h,t[4]=m*e+p*r+S*c,t[5]=m*o+p*u+S*l,t[6]=v*a+I*s+x*h,t[7]=v*e+I*r+x*c,t[8]=v*o+I*u+x*l,t},e.mul=e.multiply,e.translate=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=i[0],d=i[1];return t[0]=a,t[1]=e,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=f*a+d*s+h,t[7]=f*e+d*r+c,t[8]=f*o+d*u+l,t},e.rotate=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=Math.sin(i),d=Math.cos(i);return t[0]=d*a+f*s,t[1]=d*e+f*r,t[2]=d*o+f*u,t[3]=d*s-f*a,t[4]=d*r-f*e,t[5]=d*u-f*o,t[6]=h,t[7]=c,t[8]=l,t},e.scale=function(t,n,i){var a=i[0],e=i[1];return t[0]=a*n[0],t[1]=a*n[1],t[2]=a*n[2],t[3]=e*n[3],t[4]=e*n[4],t[5]=e*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},e.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t},e.fromRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=i,t[2]=0,t[3]=-i,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},e.fromQuat=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=i+i,r=a+a,u=e+e,h=i*s,c=a*s,l=a*r,f=e*s,d=e*r,M=e*u,m=o*s,p=o*r,S=o*u;return t[0]=1-l-M,t[3]=c-S,t[6]=f+p,t[1]=c+S,t[4]=1-h-M,t[7]=d-m,t[2]=f-p,t[5]=d+m,t[8]=1-h-l,t},e.normalFromMat4=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],d=n[11],M=n[12],m=n[13],p=n[14],S=n[15],v=i*r-a*s,I=i*u-e*s,x=i*h-o*s,D=a*u-e*r,b=a*h-o*r,F=e*h-o*u,y=c*m-l*M,g=c*p-f*M,w=c*S-d*M,A=l*p-f*m,E=l*S-d*m,R=f*S-d*p,z=v*R-I*E+x*A+D*w-b*g+F*y;return z?(z=1/z,t[0]=(r*R-u*E+h*A)*z,t[1]=(u*w-s*R-h*g)*z,t[2]=(s*E-r*w+h*y)*z,t[3]=(e*E-a*R-o*A)*z,t[4]=(i*R-e*w+o*g)*z,t[5]=(a*w-i*E-o*y)*z,t[6]=(m*F-p*b+S*D)*z,t[7]=(p*x-M*F-S*I)*z,t[8]=(M*b-m*x+S*v)*z,t):null},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t[4]=n[4]+i[4],t[5]=n[5]+i[5],t[6]=n[6]+i[6],t[7]=n[7]+i[7],t[8]=n[8]+i[8],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t[4]=n[4]-i[4],t[5]=n[5]-i[5],t[6]=n[6]-i[6],t[7]=n[7]-i[7],t[8]=n[8]-i[8],t},e.sub=e.subtract,e.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*i,t},e.multiplyScalarAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t[3]=n[3]+i[3]*a,t[4]=n[4]+i[4]*a,t[5]=n[5]+i[5]*a,t[6]=n[6]+i[6]*a,t[7]=n[7]+i[7]*a,t[8]=n[8]+i[8]*a,t},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=t[3],r=t[4],u=t[5],h=t[6],c=t[7],l=t[8],f=n[0],d=n[1],M=n[2],m=n[3],p=n[4],S=n[5],v=t[6],I=n[7],x=n[8];return Math.abs(i-f)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(e-d)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(o-M)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-m)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(r-p)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(u-S)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-v)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-I)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(l-x)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))},t.exports=e},function(t,n,i){"use strict";var a=i(4);const e=(t,n)=>{t.setBounds(...n)};class o extends a.a{constructor(t,n,i=undefined,a=undefined){super(e,t,n,i,a)}}n.a=o},function(t,n,i){"use strict";function a(t,n){t.color=`rgba(${0|n[0]}, ${0|n[1]}, ${0|n[2]}, ${n[3]})`}var e=i(4),o=i(10);class s extends e.a{constructor(t,n,e=undefined,s=undefined){super(a,i.i(o.a)(t),i.i(o.a)(n),e,s)}}n.a=s},function(t,n,i){"use strict";var a=i(4);const e=(t,n)=>{t.setPosition(...n)};class o extends a.a{constructor(t,n,i=undefined,a=undefined){super(e,t,n,i,a)}}n.a=o},function(t,n,i){"use strict";var a=i(4);const e=(t,n)=>{t.setRotation(n[0])};class o extends a.a{constructor(t,n,i=undefined,a=undefined,o=undefined){super(e,t,n,i,a,o)}update(t,n){this.end[0]=this.rotation,super.update(t,n)}setRotation(t){this.start[0]=this.rotation,this.end[0]=t,this.reset(),super.setRotation(t)}}n.a=o},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t){super(),this.target=t}update(t,n){o.a.add(t.position,this.target.position,this.position)}setTarget(t){this.target=t}}n.a=s},function(t,n,i){"use strict";var a=i(0);class e extends a.a{update(t,n){"undefined"==typeof t.velocity[1]&&(t.velocity[1]=0),t.velocity[1]+=e.GRAVITATIONAL_CONSTANT*n}}n.a=e,e.GRAVITATIONAL_CONSTANT=3e-4},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{update(t,n){o.a.scaleAndAdd(t.position,t.position,t.velocity,n)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{init(t){t.impulse=o.a.create()}update(t,n){o.a.add(t.velocity,t.velocity,t.impulse),o.a.set(t.impulse,0,0,0)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t){super(),this.target=t,this.vector=o.a.create()}update(t,n){o.a.subtract(this.vector,this.target.position,t.position);var i=this.target.mass*n/o.a.squaredLength(this.vector);o.a.normalize(this.vector,this.vector),o.a.scaleAndAdd(t.velocity,t.velocity,this.vector,i)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e),s=i(5);class r extends a.a{constructor(t,n){super(),this.duration=t,this.easing=n||s.Linear,this.elapsed=0,this.running=!1,this.starting=!1,this.start=o.a.create(),this.position=o.a.create()}update(t,n){if(this.starting&&(isNaN(this.position[0])&&(this.position[0]=t.position[0]),isNaN(this.position[1])&&(this.position[1]=t.position[1]),isNaN(this.position[2])&&(this.position[2]=t.position[2]),o.a.copy(this.start,t.position),this.running=!0,this.starting=!1,this.elapsed=0),this.running){var i=this.elapsed/this.duration,a=this.easing(i);i>1?(o.a.copy(t.position,this.position),this.running=!1):(o.a.lerp(t.position,this.start,this.position,a),this.elapsed+=n)}}setPosition(t,n,i){super.setPosition(t,n,i),this.starting=!0}}n.a=r},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t=.001,n=.1){super(),this.probability=t,this.maximumImpulse=n}init(t){t.impulse=t.impulse||o.a.create()}update(t,n){Math.random()<this.probability&&o.a.random(t.impulse,Math.random()*this.maximumImpulse)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t,n=.001){super(),this.world=t,this.probability=n}update(t,n){if(Math.random()<this.probability){const n=this.world.bounds,i=Math.random()*(n[2]-n[0]),a=Math.random()*(n[3]-n[1]),e=Math.random()*(n[5]-n[4]);o.a.set(t.position,i,a,e)}}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t=.001,n=.1){super(),this.probability=t,this.maximumVelocity=n}update(t,n){Math.random()<this.probability&&o.a.random(t.velocity,Math.random()*this.maximumVelocity)}}n.a=s},function(t,n,i){"use strict";var a=i(0);class e extends a.a{update(t,n){t.setRotation(Math.atan2(t.velocity[0],-t.velocity[1]))}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.rotationSpeed=t}update(t,n){var i=t.rotationSpeed||this.rotationSpeed||0;t.setRotation(t.rotation+i*n)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{update(t,n){var i=t.rotation,a=this.rotation,e=a-i,o=.01;e>Math.PI?e-=2*Math.PI:e<-Math.PI&&(e+=2*Math.PI),t.rotation=i+e*n*o}}n.a=e},function(t,n,i){"use strict";var a=i(2),e=i(0),o=a.a.prototype.addComponent;class s extends e.a{constructor(t,n){super(),this.positiveComponents=[],this.negativeComponents=[],this.active=!0,this.object=t,this.prop=n}addComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addPositiveComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addNegativeComponent(t){this.components=this.negativeComponents,o.call(this,t),this.components=void 0}addComponents(t,n){t.forEach(this.addPositiveComponent.bind(this)),n.forEach(this.addNegativeComponent.bind(this))}flip(){this.setActive(!this.active)}setActive(t){this.active=t,this.object&&(this.object[this.prop]=this.active)}update(t,n){var i,a=0;if(this.object&&(this.active=this.object[this.prop]),this.active)for(i=this.positiveComponents.length;a<i;a++)this.positiveComponents[a].update(t,n);else for(i=this.negativeComponents.length;a<i;a++)this.negativeComponents[a].update(t,n)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t){super(),this.velocityMagnitude=t}update(t,n){const i=o.a.length(t.velocity);if(i>this.velocityMagnitude){const n=this.velocityMagnitude/i;o.a.scale(t.velocity,t.velocity,n)}}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1);i.n(e);class o extends a.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=this.target.rotation+this.rotation}}n.a=o},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super(),this.surfaces=[],this.temporarySurfaces=[]}addSurface(t){this.surfaces.push(t)}addSurfaces(t){for(var n=0;n<t.length;n++)this.surfaces.push(t[n])}clearSurfaces(){this.surfaces.length=0}addTemporarySurface(t){this.temporarySurfaces.push(t)}update(t){super.update(t),this.temporarySurfaces.length=0}}n.a=e},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super(),this.attackObjects=[],this.vulnerableObjects=[]}addAttackObject(t){this.attackObjects.push(t)}addVulnerableObject(t){this.vulnerableObjects.push(t)}update(t){const n=this.attackObjects.length,i=this.vulnerableObjects.length;for(let a=0;a<n;a++){const t=this.attackObjects[a],n=t.position[0],e=t.position[1],o=t.bounds,s=[n+o[0],e+o[1],n+o[2],e+o[3]];for(let r=0;r<i;r++){const n=this.vulnerableObjects[r],i=n.position[0],a=n.position[1],e=n.bounds,o=[i+e[0],a+e[1],i+e[2],a+e[3]];t!==n&&s[0]<o[2]&&s[1]<o[3]&&s[2]>o[0]&&s[3]>o[1]&&(t.fire("attack",n),n.fire("attackedBy",t))}}this.attackObjects.length=0,this.vulnerableObjects.length=0}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.renderSystem=t}update(t,n){const i=t.bounds;i&&this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.rect(t.bounds[0],t.bounds[1],t.bounds[2]-t.bounds[0],t.bounds[3]-t.bounds[1]),n.strokeStyle="#000",n.stroke()})}}n.a=e},function(t,n,i){"use strict";var a=(i(2),i(0)),e=i(9);i.n(e);const o=1e3;class s extends a.a{constructor(t){super(),this.path=[],this.currIndex=0,this.lastVx=0,this.lastVy=0,this.renderSystem=t,this.path.length=o}update(t,n){const i=t.position[0],a=t.position[1],e=t.velocity[0],s=t.velocity[1],r=(e-this.lastVx)/n,u=(s-this.lastVy)/n,h=this.path,c=(this.currIndex-2+o)%o,l=Math.abs(h[c]-i),f=Math.abs(h[c+1]-a);(l>100||f>100)&&(h[this.currIndex]=NaN,h[this.currIndex+1]=NaN,this.currIndex=(this.currIndex+2)%o),h[this.currIndex]=i,h[this.currIndex+1]=a,this.renderSystem.push(t=>{t.beginPath(),t.moveTo(h[this.currIndex],h[this.currIndex+1]);for(let n=2;n<o;n+=2){let i=(this.currIndex+n)%o;h[i]?t.lineTo(h[i],h[i+1]):(n+=2,i=(this.currIndex+n)%o,t.moveTo(h[i],h[i+1]))}t.strokeStyle="#CCC",t.stroke()}),this.currIndex=(this.currIndex+2)%o,this.renderSystem.strokePath([i,a,i+100*e,a+100*s],"rgba(0,128,255,0.7)",0),this.renderSystem.strokePath([i,a,i+4e5*r,a+4e5*u],"rgba(0,255,0,0.7)",0),this.lastVx=e,this.lastVy=s}}n.a=s},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n){super(),this.renderSystem=t,this.colour=n||"#000"}update(t,n){for(var i,a,e,o=t.surfaces,s=0,r=o.length;s<r;s++)this.renderSystem.strokePath(o[s],t.colour||this.colour);for(s=0;s<r;s++)for(a=t.surfaces[s],e=a.length,i=0;i<e-3;i+=2){var u=a[i],h=a[i+1],c=a[i+2],l=a[i+3],f=c-u,d=l-h,M=u+.5*f,m=h+.5*d,p=d/Math.sqrt(d*d+f*f),S=-f/Math.sqrt(d*d+f*f);this.renderSystem.strokePath([M,m,M+30*p,m+30*S],"#08f")}}}n.a=e},function(t,n,i){"use strict";var a=i(0),e=i(25);class o extends a.a{constructor(t){super(),this.renderSystem=t}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.arc(0,0,e.a.NEIGHBOUR_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#008",n.stroke(),n.beginPath(),n.arc(0,0,e.a.SEPARATION_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#800",n.stroke()})}}n.a=o},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n="10px sans-serif",i="#000"){super(),this.renderSystem=t,this.font=n,this.color=i,this.size=parseInt(n,10)}update(t,n){const i=t.position,a=this.size;this.renderSystem.push(t=>{t.translate(i[0],i[1]),t.strokeStyle="#888",t.lineWidth=2,t.beginPath(),t.moveTo(-a,0),t.lineTo(a,0),t.moveTo(0,-a),t.lineTo(0,a),t.stroke(),t.fillStyle=this.color,t.font=this.font,t.fillText(`${0|i[0]}, ${0|i[1]}`,a/2,-a/2)})}}n.a=e},function(t,n,i){"use strict";var a=i(0),e=i(36),o=i.n(e),s=i(24),r=i.n(s);class u extends a.a{constructor(t,n,i,a,e){super();var o=t.context;this.renderSystem=t,this.vertexBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.STATIC_DRAW),this.vertexBuffer.itemSize=3,this.vertexBuffer.numItems=Math.floor(n.length/this.vertexBuffer.itemSize),this.textureBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.textureBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(i),o.STATIC_DRAW),this.textureBuffer.itemSize=2,this.textureBuffer.numItems=Math.floor(i.length/this.textureBuffer.itemSize),this.vertexNormalBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexNormalBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(a),o.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=Math.floor(a.length/this.vertexNormalBuffer.itemSize),this.vertexIndexBuffer=o.createBuffer(),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),o.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=e.length}update(t,n){var i=this.vertexBuffer,a=this.textureBuffer,e=this.vertexNormalBuffer,s=this.vertexIndexBuffer,u=this.lighting||t.lighting,h=this.renderSystem.shaderProgram,c=this.texture||t.texture;this.renderSystem.push(function(n,l){r.a.translate(l,l,t.position),t.rotation&&t.rotationAxis&&r.a.rotate(l,l,t.rotation,t.rotationAxis);var f=o.a.create();o.a.fromMat4(f,l),o.a.invert(f,f),o.a.transpose(f,f),n.uniformMatrix3fv(h.nMatrixUniform,!1,f),t.size&&r.a.scale(l,l,t.size),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(h.vertexPositionAttribute,i.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,a),n.vertexAttribPointer(h.textureCoordAttribute,a.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,e),n.vertexAttribPointer(h.vertexNormalAttribute,e.itemSize,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,c),n.uniform1i(h.samplerUniform,0),n.uniform1i(h.useLightingUniform,u),u&&(n.uniform3f(h.ambientColorUniform,this.ambientLight,this.ambientLight,this.ambientLight),n.uniform3f(h.pointLightingLocationUniform,0,0,0),n.uniform3f(h.pointLightingColorUniform,this.pointLighting,this.pointLighting,this.pointLighting)),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,s),n.uniformMatrix4fv(h.mvMatrixUniform,!1,l),n.drawElements(n.TRIANGLES,s.numItems,n.UNSIGNED_SHORT,0)})}}n.a=u,u.createCube=function(t){var n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],i=[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],a=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],e=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return new u(t,n,i,a,e)},u.createSphere=function(t,n,i){var a,e,o,s,r,h,c,l,f,d,M,m,p,S,v,I,x=[],D=[],b=[];for(a=0;a<=n;a++)for(e=a*Math.PI/n,o=Math.sin(e),s=Math.cos(e),r=0;r<=i;r++)h=2*r*Math.PI/i,c=Math.sin(h),l=Math.cos(h),f=l*o,d=s,M=c*o,m=1-r/i,p=1-a/n,D.push(f),D.push(d),D.push(M),b.push(m),b.push(p),x.push(f),x.push(d),x.push(M);for(S=[],a=0;a<n;a++)for(r=0;r<i;r++)v=a*(i+1)+r,I=v+i+1,S.push(v),S.push(I),S.push(v+1),S.push(I),S.push(I+1),S.push(v+1);return new u(t,x,b,x,S)}},function(t,n,i){"use strict";function a(t,n){this.images=t,this.delay=1e3/n,this.lastChange=0,this.imageIndex=0}function e(t){this.renderSystem=t}var o=i(0);n.e=a,n.f=e;class s extends o.a{constructor(t,n,i){super(),this.renderSystem=t,this.texture=n,this.bounds=i}update(t,n){for(var i,a=this.renderSystem,e=this.texture,o=this.bounds,s=e.width,r=e.height,u=t.position[0]%s,h=(t.position[1]%r,o[1]),c=o[2],l=o[3],f=function(t,n,i){return function(a){a.drawImage(t.image,n,i)}};h<l+r;h+=r)for(i=o[0]+u-s;i<c+s;i+=s)a.push(f(e,i,h))}}n.a=s;class r extends o.a{constructor(t,n,i){super(),this.renderSystem=t,this.layer=n,this.sprite=i}update(t,n){super.update(n);var i=this.sprite||t.sprite,a=i&&i.t.image;i&&this.renderSystem.push(function(n){var e=t.position[0],o=t.position[1],s=i.w,r=i.h;n.translate(e,o),n.rotate(t.rotation),n.drawImage(a,i.x,i.y,s,r,-i.ox,-i.oy,s,r)},this.layer)}}n.b=r;class u extends o.a{constructor(t,n){super(),this.duration=t,this.spriteIndex=0,this.playing=!0,this.sprites=n}init(t){this.sprites&&(t.sprites=this.sprites),t.sprites.length&&(t.sprite=t.sprites[0]),t.spriteCountdown=t.sprite&&t.sprite.d||this.duration}update(t,n){var i,a,e=t.sprites.length;this.playing&&(t.spriteCountdown-=n,t.spriteCountdown<=0&&(this.spriteIndex=(this.spriteIndex+1)%e,i=t.sprites[this.spriteIndex],t.sprite=i,a=i.d||this.duration,t.spriteCountdown=a))}play(){this.playing=!0}stop(){this.playing=!1,this.spriteIndex=0}pause(){this.playing=!1}}n.c=u;const h={};n.d=h,h.generateSpriteSheet=function(t,n,i){var a,e,o=[];for(a=0;a<n;a++)for(e=0;e<i;e++)o.push({t:t.t,x:e*t.w,y:a*t.h,w:t.w,h:t.h,ox:t.ox,oy:t.oy,d:t.d});return o},a.prototype=new o.a,a.prototype.update=function(t,n){this.lastChange>this.delay?(this.imageIndex=(this.imageIndex+1)%this.images.length,t.sprite=this.images[this.imageIndex],this.lastChange=0):this.lastChange+=n},e.prototype=new o.a,e.prototype.update=function(t,n){this.renderSystem.push(function(n){var i=t.position[0],a=t.position[1],e=t.sprite.width,o=t.sprite.height;n.translate(i,a),n.rotate(t.rotation),n.drawImage(t.sprite,-e/2,-o/2)})}},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(2);i.d(n,"GameObject",function(){return a.a});var e=i(16);i.d(n,"GameObjectManager",function(){return e.a});var o=i(0);i.d(n,"GameComponent",function(){return o.a});var s=i(11);i.d(n,"CameraSystem",function(){return s.a});var r=i(7);i.d(n,"CanvasRenderSystem",function(){return r.a});var u=i(8);i.d(n,"WorldSystem",function(){return u.a});var h=i(6);i.d(n,"InputSystem",function(){return h.a});var c=i(26);i.d(n,"AudioSystem",function(){return c.a});var l=i(30);i.d(n,"Game",function(){return l.a});var f=i(28),d=i(27),M=i(5);i.d(n,"Easing",function(){return M});var m=i(34);i.d(n,"World",function(){return m});var p=i(22),S=i(23),v=i(32);i.d(n,"Input",function(){return v});var I=i(17),x=i(29);i.d(n,"Collision",function(){return x});var D=i(14),b=i(13),F=i(12),y=i(15),g=i(33);i.d(n,"Render",function(){return g});var w=i(21);i.d(n,"WebGLRenderSystem",function(){return w.a});var A=i(18),E=i(19),R=i(20),z=i(31);i.d(n,"Debug",function(){return z});const _={};n.Components=_;for(let P in f)_[P]=f[P];for(let P in d)_[P]=d[P];_.WorldBounceComponent=p.a,_.WorldWrapComponent=S.a,_.ClickComponent=I.a,_.CollisionComponent=D.a,_.BounceComponent=b.a,_.BackgroundCollisionComponent=F.a,_.SolidComponent=y.a,_.DotRenderComponent=A.a,_.RectangleRenderComponent=E.a,_.TextRenderComponent=R.a}])});
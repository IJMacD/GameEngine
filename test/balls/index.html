<!doctype html>
<html>
  <head>
    <title>Ball Test</title>
    <style>
      html, body, canvas {
        height: 100%;
        width: 100%;
        margin: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <script src="../../dist/ijmacd-game-engine.js"></script>
    <script>
      const canvas = document.getElementById('canvas');
      const game = new IGE.Game({
        canvas,
        width: canvas.offsetWidth,
        height: canvas.offsetHeight
      });

      const renderSystem = game.getDefaultRenderer();

      renderSystem.context.globalCompositeOperation = "screen";

      function ballFactory (game, renderSystem, color) {
        const ball = new IGE.GameObject();
        ball.setPosition(Math.random() * game.width, Math.random() * game.height);
        ball.setVelocity(Math.random()*0.1 - 0.05, Math.random()*0.1 - 0.05);
        const rx = Math.random() * 20 + 20;
        const ry = Math.random() * 20 + 20;
        ball.setBounds(-rx, -ry, rx, ry);
        ball.addComponent(new IGE.Components.MoveComponent());
        ball.addComponent(new IGE.Components.WorldBounceComponent(game.getDefaultWorld()));
        ball.addComponent(new IGE.Components.DotRenderComponent(renderSystem, color));
        return ball;
      }

      for(let i = 0; i < 10; i++) {
        const r = Math.random() * 255;
        const g = Math.random() * 255;
        const b = Math.random() * 255;
        game.root.addObject(ballFactory(game, renderSystem, `rgba(${r|0},${g|0},${b|0},0.5)`));
      }
      game.root.addObject(renderSystem);

      game.start();
    </script>
  </body>
</html>
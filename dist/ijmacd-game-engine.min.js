!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.IGE=n():t.IGE=n()}(this,function(){return function(t){function n(a){if(i[a])return i[a].exports;var e=i[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var i={};return n.m=t,n.c=i,n.i=function(t){return t},n.d=function(t,i,a){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:a})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=71)}([function(t,n,i){"use strict";var a=i(2);class e extends a.a{init(t){}update(t,n){return"number"==typeof t?super.update(t):"number"==typeof n?super.update(n):void 0}toHTML(){return this.name}}n.a=e},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},e.clone=function(t){var n=new a.ARRAY_TYPE(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},e.fromValues=function(t,n,i){var e=new a.ARRAY_TYPE(3);return e[0]=t,e[1]=n,e[2]=i,e},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},e.set=function(t,n,i,a){return t[0]=n,t[1]=i,t[2]=a,t},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t},e.sub=e.subtract,e.multiply=function(t,n,i){return t[0]=n[0]*i[0],t[1]=n[1]*i[1],t[2]=n[2]*i[2],t},e.mul=e.multiply,e.divide=function(t,n,i){return t[0]=n[0]/i[0],t[1]=n[1]/i[1],t[2]=n[2]/i[2],t},e.div=e.divide,e.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},e.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},e.min=function(t,n,i){return t[0]=Math.min(n[0],i[0]),t[1]=Math.min(n[1],i[1]),t[2]=Math.min(n[2],i[2]),t},e.max=function(t,n,i){return t[0]=Math.max(n[0],i[0]),t[1]=Math.max(n[1],i[1]),t[2]=Math.max(n[2],i[2]),t},e.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},e.scale=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t},e.scaleAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t},e.distance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return Math.sqrt(i*i+a*a+e*e)},e.dist=e.distance,e.squaredDistance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return i*i+a*a+e*e},e.sqrDist=e.squaredDistance,e.length=function(t){var n=t[0],i=t[1],a=t[2];return Math.sqrt(n*n+i*i+a*a)},e.len=e.length,e.squaredLength=function(t){var n=t[0],i=t[1],a=t[2];return n*n+i*i+a*a},e.sqrLen=e.squaredLength,e.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},e.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},e.normalize=function(t,n){var i=n[0],a=n[1],e=n[2],o=i*i+a*a+e*e;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t},e.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},e.cross=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=i[0],r=i[1],u=i[2];return t[0]=e*u-o*r,t[1]=o*s-a*u,t[2]=a*r-e*s,t},e.lerp=function(t,n,i,a){var e=n[0],o=n[1],s=n[2];return t[0]=e+a*(i[0]-e),t[1]=o+a*(i[1]-o),t[2]=s+a*(i[2]-s),t},e.hermite=function(t,n,i,a,e,o){var s=o*o,r=s*(2*o-3)+1,u=s*(o-2)+o,c=s*(o-1),h=s*(3-2*o);return t[0]=n[0]*r+i[0]*u+a[0]*c+e[0]*h,t[1]=n[1]*r+i[1]*u+a[1]*c+e[1]*h,t[2]=n[2]*r+i[2]*u+a[2]*c+e[2]*h,t},e.bezier=function(t,n,i,a,e,o){var s=1-o,r=s*s,u=o*o,c=r*s,h=3*o*r,l=3*u*s,f=u*o;return t[0]=n[0]*c+i[0]*h+a[0]*l+e[0]*f,t[1]=n[1]*c+i[1]*h+a[1]*l+e[1]*f,t[2]=n[2]*c+i[2]*h+a[2]*l+e[2]*f,t},e.random=function(t,n){n=n||1;var i=2*a.RANDOM()*Math.PI,e=2*a.RANDOM()-1,o=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=e*n,t},e.transformMat4=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=i[3]*a+i[7]*e+i[11]*o+i[15];return s=s||1,t[0]=(i[0]*a+i[4]*e+i[8]*o+i[12])/s,t[1]=(i[1]*a+i[5]*e+i[9]*o+i[13])/s,t[2]=(i[2]*a+i[6]*e+i[10]*o+i[14])/s,t},e.transformMat3=function(t,n,i){var a=n[0],e=n[1],o=n[2];return t[0]=a*i[0]+e*i[3]+o*i[6],t[1]=a*i[1]+e*i[4]+o*i[7],t[2]=a*i[2]+e*i[5]+o*i[8],t},e.transformQuat=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=i[0],r=i[1],u=i[2],c=i[3],h=c*a+r*o-u*e,l=c*e+u*a-s*o,f=c*o+s*e-r*a,d=-s*a-r*e-u*o;return t[0]=h*c+d*-s+l*-u-f*-r,t[1]=l*c+d*-r+f*-s-h*-u,t[2]=f*c+d*-u+h*-r-l*-s,t},e.rotateX=function(t,n,i,a){var e=[],o=[];return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],o[0]=e[0],o[1]=e[1]*Math.cos(a)-e[2]*Math.sin(a),o[2]=e[1]*Math.sin(a)+e[2]*Math.cos(a),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},e.rotateY=function(t,n,i,a){var e=[],o=[];return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],o[0]=e[2]*Math.sin(a)+e[0]*Math.cos(a),o[1]=e[1],o[2]=e[2]*Math.cos(a)-e[0]*Math.sin(a),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},e.rotateZ=function(t,n,i,a){var e=[],o=[];return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],o[0]=e[0]*Math.cos(a)-e[1]*Math.sin(a),o[1]=e[0]*Math.sin(a)+e[1]*Math.cos(a),o[2]=e[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},e.forEach=function(){var t=e.create();return function(n,i,a,e,o,s){var r,u;for(i||(i=3),a||(a=0),u=e?Math.min(e*i+a,n.length):n.length,r=a;r<u;r+=i)t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],o(t,t,s),n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2];return n}}(),e.angle=function(t,n){var i=e.fromValues(t[0],t[1],t[2]),a=e.fromValues(n[0],n[1],n[2]);e.normalize(i,i),e.normalize(a,a);var o=e.dot(i,a);return o>1?0:Math.acos(o)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=n[0],r=n[1],u=n[2];return Math.abs(i-s)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(e-r)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(o-u)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},t.exports=e},function(t,n,i){"use strict";function a(t,n){var i=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,i)}var e=i(1),o=i.n(e),s=i(10);class r{constructor(){this.components=[],this.position=o.a.create(),this.velocity=o.a.create(),this.rotation=0,this.rotationAxis=o.a.fromValues(0,0,1),this.rotationSpeed=0,this._toBeRemoved=[],this._events={}}addComponent(t){return t instanceof Function&&(t={update:t}),this.components.push(t),t.init&&t.init(this),this}removeComponent(t){return this._toBeRemoved.push(t),this}removeComponentByName(t){for(var n=0;n<this.components.length;n++){const i=this.components[n];i.name!=t&&i.constructor.name!=t||this._toBeRemoved.push(i)}return this}removeComponentByTest(t){for(var n=0;n<this.components.length;n++)t(this.components[n])&&this._toBeRemoved.push(this.components[n]);return this}setPosition(t,n,i){return void 0==t&&(t=this.position[0]),void 0==n&&(n=this.position[1]),void 0==i&&(i=this.position[2]),o.a.set(this.position,t,n,i),this}setVelocity(t,n,i){return void 0==t&&(t=this.velocity[0]),void 0==n&&(n=this.velocity[1]),void 0==i&&(i=this.velocity[2]),o.a.set(this.velocity,t,n,i),this}setBounds(...t){return this.bounds=t,this}setRotation(t,n){this.rotation=t,n&&o.a.normalize(this.rotationAxis,n)}update(t){for(var n=0,i=this.components.length,e=0,o=this._toBeRemoved.length;e<o;e++)for(n=0;n<i;n++)if(this.components[n]==this._toBeRemoved[e]){a.call(this.components,n);break}for(this._toBeRemoved.length=0,i=this.components.length,n=0;n<i;n++)this.components[n].update(this,t)}toHTML(){var t,n=this.name;if("number"==typeof this.position.x&&(n+=" "+this.position),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}return n}}n.a=r,i.i(s.b)(r,s.c)},function(t,n){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.ENABLE_SIMD=!1,i.SIMD_AVAILABLE=i.ARRAY_TYPE===Float32Array&&"SIMD"in this,i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE,i.setMatrixArrayType=function(t){i.ARRAY_TYPE=t};var a=Math.PI/180;i.toRadian=function(t){return t*a},i.equals=function(t,n){return Math.abs(t-n)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))},t.exports=i},function(t,n,i){"use strict";var a=i(0),e=i(9);class o extends a.a{constructor(t,n,i,a=1e3,o=e["Linear"],s=2){super(),Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]),n.length=4,i.length=4,this.outputter=t,this.start=n,this.end=i,this.duration=a,this.easing=o,this.loop=s,this.elapsed=0,this.direction=1,this.out=Array(4)}reset(){this.elapsed=0}start(){this.direction=1}pause(){this.direction=0}stop(){this.pause(),this.reset()}update(t,n){const i=this.easing(this.elapsed/this.duration),a=this.start[0],e=this.start[1],o=this.start[2],s=this.start[3];this.out[0]=a+i*(this.end[0]-a),this.out[1]=e+i*(this.end[1]-e),this.out[2]=o+i*(this.end[2]-o),this.out[3]=s+i*(this.end[3]-s),this.outputter(t,this.out),this.elapsed+=n*this.direction,(this.elapsed>this.duration||this.elapsed<0)&&(2==this.loop?this.direction*=-1:1==this.loop&&(this.elapsed=0),this.elapsed=Math.min(Math.max(this.elapsed,0),this.duration))}}n.a=o},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},e.clone=function(t){var n=new a.ARRAY_TYPE(2);return n[0]=t[0],n[1]=t[1],n},e.fromValues=function(t,n){var i=new a.ARRAY_TYPE(2);return i[0]=t,i[1]=n,i},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},e.set=function(t,n,i){return t[0]=n,t[1]=i,t},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t},e.sub=e.subtract,e.multiply=function(t,n,i){return t[0]=n[0]*i[0],t[1]=n[1]*i[1],t},e.mul=e.multiply,e.divide=function(t,n,i){return t[0]=n[0]/i[0],t[1]=n[1]/i[1],t},e.div=e.divide,e.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},e.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},e.min=function(t,n,i){return t[0]=Math.min(n[0],i[0]),t[1]=Math.min(n[1],i[1]),t},e.max=function(t,n,i){return t[0]=Math.max(n[0],i[0]),t[1]=Math.max(n[1],i[1]),t},e.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},e.scale=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t},e.scaleAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t},e.distance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(i*i+a*a)},e.dist=e.distance,e.squaredDistance=function(t,n){var i=n[0]-t[0],a=n[1]-t[1];return i*i+a*a},e.sqrDist=e.squaredDistance,e.length=function(t){var n=t[0],i=t[1];return Math.sqrt(n*n+i*i)},e.len=e.length,e.squaredLength=function(t){var n=t[0],i=t[1];return n*n+i*i},e.sqrLen=e.squaredLength,e.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},e.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},e.normalize=function(t,n){var i=n[0],a=n[1],e=i*i+a*a;return e>0&&(e=1/Math.sqrt(e),t[0]=n[0]*e,t[1]=n[1]*e),t},e.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},e.cross=function(t,n,i){var a=n[0]*i[1]-n[1]*i[0];return t[0]=t[1]=0,t[2]=a,t},e.lerp=function(t,n,i,a){var e=n[0],o=n[1];return t[0]=e+a*(i[0]-e),t[1]=o+a*(i[1]-o),t},e.random=function(t,n){n=n||1;var i=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t},e.transformMat2=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[2]*e,t[1]=i[1]*a+i[3]*e,t},e.transformMat2d=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[2]*e+i[4],t[1]=i[1]*a+i[3]*e+i[5],t},e.transformMat3=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[3]*e+i[6],t[1]=i[1]*a+i[4]*e+i[7],t},e.transformMat4=function(t,n,i){var a=n[0],e=n[1];return t[0]=i[0]*a+i[4]*e+i[12],t[1]=i[1]*a+i[5]*e+i[13],t},e.forEach=function(){var t=e.create();return function(n,i,a,e,o,s){var r,u;for(i||(i=2),a||(a=0),u=e?Math.min(e*i+a,n.length):n.length,r=a;r<u;r+=i)t[0]=n[r],t[1]=n[r+1],o(t,t,s),n[r]=t[0],n[r+1]=t[1];return n}}(),e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]},e.equals=function(t,n){var i=t[0],e=t[1],o=n[0],s=n[1];return Math.abs(i-o)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(e-s)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))},t.exports=e},function(t,n,i){"use strict";function a(t,n){const i=function(t){return t.stopPropagation(),t.preventDefault(),t.handled!==!0&&(n(t),void(t.handled=!0))};e(t),t.addEventListener("touchstart",i),t.addEventListener("click",i),t.touchClick=i}function e(t){t.removeEventListener("touchstart",t.touchClick),t.removeEventListener("click",t.touchClick)}var o=i(2),s=i(5),r=i.n(s),u=i(37),c=i.n(u);const h=r.a.create(),l=c.a.create();class f extends o.a{constructor(t,n,i){super(),this._nextClick=r.a.fromValues(NaN,NaN),this.lastClick=r.a.create(),this.hasClick=!1,this._nextKey=null,this.lastKey=null,this.screen=t,this.keyboard=n,this.camera=i,this.initScreen(),this.initKeyboard()}update(t){super.update(t),r.a.copy(this.lastClick,this._nextClick),r.a.set(this._nextClick,NaN,NaN),this.hasClick=!isNaN(this.lastClick[0]),this.hasClick&&this.fire("click",this.lastClick),this.lastKey=this._nextKey,this._nextKey=null,this.lastKey&&this.fire("keypress",this.lastKey)}setScreen(t){this.screen&&this.destroyScreen(),this.screen=t,this.initScreen()}screenToWorld(t,n){const i=this.camera,a=this.screen,e=a.offsetWidth,o=a.offsetHeight;return r.a.set(h,t-e/2,n-o/2),r.a.set(h,h[0]/i.scaleX,h[1]/i.scaleY),1==i.rotationAxis[2]&&(c.a.rotate(l,l,-i.rotation),r.a.transformMat2(h,h,l)),r.a.add(h,h,i.position),h}initScreen(){this.screen&&a(this.screen,t=>{const n=this.screen.offsetLeft,i=this.screen.offsetTop,a=t.touches&&t.touches[0],e=(a?a.pageX:t.pageX)-n,o=(a?a.pageY:t.pageY)-i;r.a.copy(this._nextClick,this.screenToWorld(e,o))})}initKeyboard(){this.keyboard&&this.keyboard.addEventListener("keydown",t=>{this._nextKey=t.which})}destroyScreen(){const t=this.screen;t&&e(t)}}n.a=f,f.Keys={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90}},function(t,n,i){"use strict";function a(t,n){const{context,renderQueue}=t,i=renderQueue[n];if(i){for(let n=0,a=i.length;n<a;n++)context.save(),i[n].call(t,context),context.restore();i.length=0}}var e=i(2);class o extends e.a{constructor(t,n){super(),this.renderQueue=[],this.clearScreen=!0,this.context=t,this.canvas=t&&t.canvas,this.camera=n}push(t,n=1){this.renderQueue[n]||(this.renderQueue[n]=[]),this.renderQueue[n].push(t)}update(t){this.clearScreen&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save();var n,i,e=this.camera.position,o=this.canvas.width/2,s=this.canvas.height/2;for(this.context.translate(o,s),this.context.scale(this.camera.scaleX,this.camera.scaleY),1==this.camera.rotationAxis[2]&&this.context.rotate(-this.camera.rotation),this.context.translate(-e[0],-e[1]),n=0,i=this.renderQueue.length;n<i;n++)a(this,n);this.context.restore(),a(this,-1)}drawPath(t,n){var i=2,a=n.length;for(t.beginPath(),t.moveTo(n[0],n[1]);i<a-1;i+=2)t.lineTo(n[i],n[i+1])}strokePath(t,n="#000",i=1){this.push(function(i){i.strokeStyle=n,this.drawPath(i,t),i.stroke()},i)}}n.a=o},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(t){super(),this.bounds=t}}n.a=e},function(t,n,i){"use strict";function a(t){var n=1.70158;return t*t*((n+1)*t-n)}function e(t){var n=1.70158;return t-=1,t*t*((n+1)*t+n)+1}function o(t){var n=2.5949095;return t*=2,t<1?Math.pow(t,2)*((n+1)*t-n)/2:(t-=2,(Math.pow(t,2)*((n+1)*t+n)+2)/2)}function s(t){if(0==t||1==t)return t;var n=.3,i=n/4;return t-=1,-1*Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n)}function r(t){if(0==t||1==t)return t;var n=.3,i=n/4;return Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}function u(t){if(0==t)return 0;if(t*=2,2==t)return 1;var n=.3*1.5,i=n/4;return t<1?(t-=1,-.5*(Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n))):(t-=1,.5*(Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n))+1)}function c(t){const n=5;return 1-Math.cos(2*t*Math.PI*n)*(1-f(t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BackIn=a,n.BackOut=e,n.BackInOut=o,n.ElasticIn=s,n.ElasticOut=r,n.ElasticInOut=u,n.DampedOscillation=c;const h=t=>t;n.Linear=h;const l=t=>t*t;n.QuadIn=l;const f=t=>-t*(t-2);n.QuadOut=f;const d=t=>1-Math.sqrt(1-t*t);n.CircIn=d;const M=t=>Math.sqrt(1-(t-1)*(t-1));n.CircOut=M;const p=t=>t*t*(3-2*t);n.Smooth=p;const m=t=>-1*Math.cos(t*(Math.PI/2))+1;n.SineIn=m;const S=t=>Math.sin(t*(Math.PI/2));n.SineOut=S;const v=t=>-1*(Math.cos(Math.PI*t)-1)/2;n.SineInOut=v},function(t,n,i){"use strict";function a(t){let n=t.match(o)||t.match(s);if(n){const t=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1];return t}if(n=t.match(r)){const t=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return t}}function e(t,n){Object.getOwnPropertyNames(n.prototype).forEach(i=>{t.prototype[i]=n.prototype[i]})}n.a=a,n.b=e;const o=/#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i,s=/#([0-9a-f])([0-9a-f])([0-9a-f])/i,r=/rgba?\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(?:,(0(?:.\d+)|1(?:.0)?))?\)/;class u{constructor(){this._events={}}on(t,n){this._events[t]||(this._events[t]=[]),this._events[t].push(n)}fire(t,...n){var i=this._events[t];i&&i.length&&i.forEach(t=>{t.apply(this,n)})}}n.c=u},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super(...arguments),this.pruneList=[],this.suspendedObjects=[],this.skewX=0,this.skeyY=0,this.scaleX=1,this.scaleY=1}setScale(t,n){n=n||t,this.scaleX=t,this.scaleY=n}addManagerForPruning(t){this.pruneList.push(t)}}n.a=e},function(t,n,i){"use strict";function a(t,n){return t[0]*n[1]-t[1]*n[0]}var e=i(0),o=i(5),s=i.n(o);const r=s.a.create(),u=s.a.create(),c=s.a.create(),h=s.a.create(),l=s.a.create(),f=s.a.create(),d=s.a.create(),M=s.a.create(),p=s.a.create();class m extends e.a{constructor(t,n){super(),this.coefficientFriction=m.COEFFICIENT_FRICTION,this.coefficientRestitution=m.COEFFICIENT_RESTITUTION,this.background=t,this.bounds=n}update(t,n){var i,e,o,m,S,v=this.background.surfaces,I=0,x=v.length,D=this.coefficientFriction,F=this.coefficientRestitution,b=t.position[0],y=t.position[1],g=this.position;if(g[0]&&Math.abs(g[0]-b)<100&&Math.abs(g[1]-y)<100)for(;I<x;I++)for(i=v[I],e=i.length,o=0;o<e-3;o+=2)if(s.a.set(h,i[o],i[o+1]),s.a.set(l,i[o+2],i[o+3]),s.a.subtract(l,l,h),s.a.copy(f,g),s.a.subtract(d,t.position,f),s.a.subtract(M,f,h),m=a(M,d)/a(l,d),S=a(M,l)/a(l,d),m>=0&&m<=1&&S>=0&&S<=1){s.a.copy(t.position,g),s.a.set(u,-l[1],l[0]),s.a.normalize(u,u),s.a.copy(p,t.velocity),s.a.scale(r,u,s.a.dot(u,p)),s.a.subtract(c,p,r),s.a.scale(c,c,D),s.a.scale(r,r,F),s.a.subtract(t.velocity,c,r);break}s.a.copy(t.position,g)}}n.a=m,m.COEFFICIENT_FRICTION=.95,m.COEFFICIENT_RESTITUTION=.4},function(t,n,i){"use strict";function a(t,n){var i=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,i)}var e=i(2);class o extends e.a{constructor(){super(...arguments),this.objects=[],this._objectsToBeRemoved=[]}addObject(t){return t instanceof e.a&&this.objects.push(t),this}addObjectAt(t,n){return t instanceof e.a&&this.objects.splice(n,0,t),this}removeObject(t){return t instanceof e.a&&this._objectsToBeRemoved.push(t),this}removeAll(){this.objects.length=0}update(t){super.update(t);var n,i=0,e=this.objects.length,o=0;for(i=0;i<e;i++)this.objects[i].update(t);for(n=this._objectsToBeRemoved.length;o<n;o++)for(i=0;i<e;i++)if(this.objects[i]==this._objectsToBeRemoved[o]){a.call(this.objects,i),e--;break}this._objectsToBeRemoved.length=0}toHTML(){var t,n=this.name;if(this.objects.length>1&&(n+=" ("+this.objects.length+" items)"),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}if(this.objects.length){for(n+="<ul>",t=0;t<this.objects.length;t++)n+="<li>"+this.objects[t].toHTML();n+="</ul>"}return n}}n.a=o},function(t,n,i){"use strict";var a=i(0),e=i(5),o=i.n(e);class s extends a.a{constructor(t){super(),this.input=t}update(t,n){this.input.hasClick&&o.a.copy(t.position,this.input.lastClick)}}n.a=s},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n=0,i=0,a=0){super(),this.cRestitution=1,this.cFriction=1,this.worldSystem=t,this.ax=n/2,this.ay=i/2,this.az=a/2}update(t,n){const i=this.cRestitution,a=this.cFriction,e=this.worldSystem.bounds,o=t.bounds;let s,r,u,c,h,l;o?(s=e[0]-o[0],r=e[1]-o[1],u=e[2]-o[2],c=e[3]-o[3],h=e[4]-o[4],l=e[5]-o[5]):(s=e[0]+this.ax,r=e[1]+this.ay,u=e[2]-this.ax,c=e[3]-this.ay,h=e[4]+this.az,l=e[5]-this.az),t.hasBounced=!1,t.position[0]<s?(t.position[0]=s,t.velocity[0]=-t.velocity[0]*i,t.velocity[1]=t.velocity[1]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=1):t.position[0]>u&&(t.position[0]=u,t.velocity[0]=-t.velocity[0]*i,t.velocity[1]=t.velocity[1]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=1),t.position[1]<r?(t.position[1]=r,t.velocity[1]=-t.velocity[1]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=2):t.position[1]>c&&(t.position[1]=c,t.velocity[1]=-t.velocity[1]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[2]=t.velocity[2]*a,t.hasBounced=2),t.position[2]<h?(t.position[2]=h,t.velocity[2]=-t.velocity[2]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[1]=t.velocity[1]*a,t.hasBounced=3):t.position[2]>l&&(t.position[2]=l,t.velocity[2]=-t.velocity[2]*i,t.velocity[0]=t.velocity[0]*a,t.velocity[1]=t.velocity[1]*a,t.hasBounced=3)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.worldSystem=t}update(t,n){const i=this.worldSystem.bounds[0],a=this.worldSystem.bounds[1],e=this.worldSystem.bounds[2],o=this.worldSystem.bounds[3],s=this.worldSystem.bounds[4],r=this.worldSystem.bounds[5];t.position[0]<i&&t.velocity[0]<0?(t.position[0]=e,this.fire("wrap",t)):t.position[0]>e&&t.velocity[0]>0&&(t.position[0]=i,this.fire("wrap",t)),t.position[1]<a&&t.velocity[1]<0?(t.position[1]=o,this.fire("wrap",t)):t.position[1]>o&&t.velocity[1]>0&&(t.position[1]=a,this.fire("wrap",t)),t.position[2]<s&&t.velocity[2]<0?(t.position[2]=r,this.fire("wrap",t)):t.position[2]>r&&t.velocity[2]>0&&(t.position[2]=s,this.fire("wrap",t))}}n.a=e},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);const s=o.a.create(),r=o.a.create(),u=o.a.create(),c=o.a.create(),h=o.a.create();class l extends a.a{constructor(){super(),this.cRestitution=.9}init(t){t.on("attack",n=>{const i=t.bounds[2]-t.bounds[0],a=t.bounds[3]-t.bounds[1],e=n.bounds[2]-n.bounds[0],l=n.bounds[3]-n.bounds[1],f=(i+a)/2,d=(e+l)/2,M=(f+d)/2,p=o.a.dist(t.position,n.position);if(p<M){o.a.subtract(s,t.position,n.position),o.a.scale(r,s,(M-p)/p);const i=1/(t.mass||1),a=1/(n.mass||1);o.a.scaleAndAdd(t.position,t.position,r,i/(i+a)),o.a.scaleAndAdd(n.position,n.position,r,-a/(i+a)),o.a.subtract(u,t.velocity,n.velocity),o.a.normalize(c,r);const e=o.a.dot(u,c);if(e>0)return;const l=-(1+this.cRestitution)*e/(i+a);o.a.scale(h,c,l),o.a.scaleAndAdd(t.velocity,t.velocity,h,i),o.a.scaleAndAdd(n.velocity,n.velocity,h,-a)}})}}n.a=l},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i){super(),this.collisionSystem=t,this.attack=n,this.vulnerable=i}update(t,n){this.attack&&this.collisionSystem.addAttackObject(t),this.vulnerable&&this.collisionSystem.addVulnerableObject(t)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n){super(),this.backgroundSystem=t,this.segments=n}update(t,n){for(var i,a,e,o,s=[],r=0,u=this.segments.length;r<u;r++){for(e=this.segments[r],a=e.length-1,o=[],i=0;i<a;i+=2)o.push(e[i]+t.position.x,e[i+1]+t.position.y);s.push(o)}this.backgroundSystem.addTemporarySurfaces(s)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.inputSystem=t}update(t,n){if(t.bounds&&this.inputSystem.hasClick){const n=this.inputSystem.lastClick,i=t.position,a=t.bounds;a[0]+i[0]<n[0]&&a[1]+i[1]<n[1]&&a[2]+i[0]>n[0]&&a[3]+i[1]>n[1]&&this.fire("click",t)}}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const i=t.bounds,a=t.position,e=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(a[0],a[1]),i?t.scale(i[2]-i[0],i[3]-i[1]):e&&t.scale(e,e),t.arc(0,0,.5,0,2*Math.PI,!1),t.fill()})}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const i=t.bounds,a=t.position,e=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(a[0],a[1]),i?t.rect(i[0],i[1],i[2]-i[0],i[3]-i[1]):e&&t.rect(-e/2,-e/2,e,e),t.fill()})}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i,a,e="10px sans-serif",o="#000"){super(),this.renderSystem=t,this.text=n,this.font=e,this.color=o,this.setPosition(i,a)}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.translate(this.position[0],this.position[1]),n.fillStyle=this.color,n.font=this.font,n.fillText(this.text,0,0)})}}n.a=e},function(t,n,i){"use strict";var a=i(2),e=i(1),o=i.n(e),s=i(25),r=i.n(s);class u extends a.a{constructor(t,n,i,a,e){super(),this.context=t,this.canvasWidth=n,this.canvasHeight=i,this.cameraSystem=a,this.shaderProgram=e,this.mvMatrix=r.a.create(),this.pMatrix=r.a.create(),this.renderQueue=[],this.spareVector=o.a.create(),this.ambientLight=.3,this.pointLighting=1.4}push(t){this.renderQueue.push(t)}update(t){var n,i,a=this.context,e=this.cameraSystem;for(a.viewport(0,0,a.viewportWidth,a.viewportHeight),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),r.a.perspective(this.pMatrix,45*Math.PI/180,a.viewportWidth/a.viewportHeight,.1,1e4),r.a.translate(this.pMatrix,this.pMatrix,o.a.negate(this.spareVector,e.position)),e.rotation&&e.rotationAxis&&r.a.rotate(this.pMatrix,this.pMatrix,e.rotation,e.rotationAxis),a.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),n=0,i=this.renderQueue.length;n<i;n++)r.a.identity(this.mvMatrix),this.renderQueue[n].call(this,this.context,this.mvMatrix);this.renderQueue.length=0}setCanvasSize(t,n){this.canvasWidth=t,this.canvasHeight=n}}n.a=u},function(t,n,i){var a=i(3),e={scalar:{},SIMD:{}};e.create=function(){var t=new a.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var n=new a.ARRAY_TYPE(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.fromValues=function(t,n,i,e,o,s,r,u,c,h,l,f,d,M,p,m){var S=new a.ARRAY_TYPE(16);return S[0]=t,S[1]=n,S[2]=i,S[3]=e,S[4]=o,S[5]=s,S[6]=r,S[7]=u,S[8]=c,S[9]=h,S[10]=l,S[11]=f,S[12]=d,S[13]=M,S[14]=p,S[15]=m,S},e.set=function(t,n,i,a,e,o,s,r,u,c,h,l,f,d,M,p,m){return t[0]=n,t[1]=i,t[2]=a,t[3]=e,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=c,t[9]=h,t[10]=l,t[11]=f,t[12]=d,t[13]=M,t[14]=p,t[15]=m,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.scalar.transpose=function(t,n){if(t===n){var i=n[1],a=n[2],e=n[3],o=n[6],s=n[7],r=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=i,t[6]=n[9],t[7]=n[13],t[8]=a,t[9]=o,t[11]=n[14],t[12]=e,t[13]=s,t[14]=r}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},e.SIMD.transpose=function(t,n){var i,a,e,o,s,r,u,c,h,l;return i=SIMD.Float32x4.load(n,0),a=SIMD.Float32x4.load(n,4),e=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12),s=SIMD.Float32x4.shuffle(i,a,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),u=SIMD.Float32x4.shuffle(s,r,0,2,4,6),c=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,c),s=SIMD.Float32x4.shuffle(i,a,2,3,6,7),r=SIMD.Float32x4.shuffle(e,o,2,3,6,7),h=SIMD.Float32x4.shuffle(s,r,0,2,4,6),l=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,8,h),SIMD.Float32x4.store(t,12,l),t},e.transpose=a.USE_SIMD?e.SIMD.transpose:e.scalar.transpose,e.scalar.invert=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],c=n[7],h=n[8],l=n[9],f=n[10],d=n[11],M=n[12],p=n[13],m=n[14],S=n[15],v=i*r-a*s,I=i*u-e*s,x=i*c-o*s,D=a*u-e*r,F=a*c-o*r,b=e*c-o*u,y=h*p-l*M,g=h*m-f*M,w=h*S-d*M,A=l*m-f*p,E=l*S-d*p,R=f*S-d*m,_=v*R-I*E+x*A+D*w-F*g+b*y;return _?(_=1/_,t[0]=(r*R-u*E+c*A)*_,t[1]=(e*E-a*R-o*A)*_,t[2]=(p*b-m*F+S*D)*_,t[3]=(f*F-l*b-d*D)*_,t[4]=(u*w-s*R-c*g)*_,t[5]=(i*R-e*w+o*g)*_,t[6]=(m*x-M*b-S*I)*_,t[7]=(h*b-f*x+d*I)*_,t[8]=(s*E-r*w+c*y)*_,t[9]=(a*w-i*E-o*y)*_,t[10]=(M*F-p*x+S*v)*_,t[11]=(l*x-h*F-d*v)*_,t[12]=(r*g-s*A-u*y)*_,t[13]=(i*A-a*g+e*y)*_,t[14]=(p*I-M*D-m*v)*_,t[15]=(h*D-l*I+f*v)*_,t):null},e.SIMD.invert=function(t,n){var i,a,e,o,s,r,u,c,h,l,f=SIMD.Float32x4.load(n,0),d=SIMD.Float32x4.load(n,4),M=SIMD.Float32x4.load(n,8),p=SIMD.Float32x4.load(n,12);return s=SIMD.Float32x4.shuffle(f,d,0,1,4,5),a=SIMD.Float32x4.shuffle(M,p,0,1,4,5),i=SIMD.Float32x4.shuffle(s,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,s,1,3,5,7),s=SIMD.Float32x4.shuffle(f,d,2,3,6,7),o=SIMD.Float32x4.shuffle(M,p,2,3,6,7),e=SIMD.Float32x4.shuffle(s,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,s,1,3,5,7),s=SIMD.Float32x4.mul(e,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.mul(a,s),u=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),r),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(a,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),r),h=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(o,s)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),r),c=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(e,s)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),s=SIMD.Float32x4.mul(i,a),s=SIMD.Float32x4.swizzle(s,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),c),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,s),h),s=SIMD.Float32x4.swizzle(s,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,s),c),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(e,s)),s=SIMD.Float32x4.mul(i,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(e,s)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),c),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,s)),s=SIMD.Float32x4.mul(i,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(a,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,s)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,s),h),l=SIMD.Float32x4.mul(i,r),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,2,3,0,1),l),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,1,0,3,2),l),s=SIMD.Float32x4.reciprocalApproximation(l),l=SIMD.Float32x4.sub(SIMD.Float32x4.add(s,s),SIMD.Float32x4.mul(l,SIMD.Float32x4.mul(s,s))),(l=SIMD.Float32x4.swizzle(l,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(l,r)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(l,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(l,c)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(l,h)),t):null},e.invert=a.USE_SIMD?e.SIMD.invert:e.scalar.invert,
e.scalar.adjoint=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],c=n[7],h=n[8],l=n[9],f=n[10],d=n[11],M=n[12],p=n[13],m=n[14],S=n[15];return t[0]=r*(f*S-d*m)-l*(u*S-c*m)+p*(u*d-c*f),t[1]=-(a*(f*S-d*m)-l*(e*S-o*m)+p*(e*d-o*f)),t[2]=a*(u*S-c*m)-r*(e*S-o*m)+p*(e*c-o*u),t[3]=-(a*(u*d-c*f)-r*(e*d-o*f)+l*(e*c-o*u)),t[4]=-(s*(f*S-d*m)-h*(u*S-c*m)+M*(u*d-c*f)),t[5]=i*(f*S-d*m)-h*(e*S-o*m)+M*(e*d-o*f),t[6]=-(i*(u*S-c*m)-s*(e*S-o*m)+M*(e*c-o*u)),t[7]=i*(u*d-c*f)-s*(e*d-o*f)+h*(e*c-o*u),t[8]=s*(l*S-d*p)-h*(r*S-c*p)+M*(r*d-c*l),t[9]=-(i*(l*S-d*p)-h*(a*S-o*p)+M*(a*d-o*l)),t[10]=i*(r*S-c*p)-s*(a*S-o*p)+M*(a*c-o*r),t[11]=-(i*(r*d-c*l)-s*(a*d-o*l)+h*(a*c-o*r)),t[12]=-(s*(l*m-f*p)-h*(r*m-u*p)+M*(r*f-u*l)),t[13]=i*(l*m-f*p)-h*(a*m-e*p)+M*(a*f-e*l),t[14]=-(i*(r*m-u*p)-s*(a*m-e*p)+M*(a*u-e*r)),t[15]=i*(r*f-u*l)-s*(a*f-e*l)+h*(a*u-e*r),t},e.SIMD.adjoint=function(t,n){var i,a,e,o,s,r,u,c,h,l,f,d,M,i=SIMD.Float32x4.load(n,0),a=SIMD.Float32x4.load(n,4),e=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12);return h=SIMD.Float32x4.shuffle(i,a,0,1,4,5),r=SIMD.Float32x4.shuffle(e,o,0,1,4,5),s=SIMD.Float32x4.shuffle(h,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,h,1,3,5,7),h=SIMD.Float32x4.shuffle(i,a,2,3,6,7),c=SIMD.Float32x4.shuffle(e,o,2,3,6,7),u=SIMD.Float32x4.shuffle(h,c,0,2,4,6),c=SIMD.Float32x4.shuffle(c,h,1,3,5,7),h=SIMD.Float32x4.mul(u,c),h=SIMD.Float32x4.swizzle(h,1,0,3,2),l=SIMD.Float32x4.mul(r,h),f=SIMD.Float32x4.mul(s,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,h),l),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,h),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),h=SIMD.Float32x4.mul(r,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),l),M=SIMD.Float32x4.mul(s,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(c,h)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,h),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),c),h=SIMD.Float32x4.swizzle(h,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),l),d=SIMD.Float32x4.mul(s,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(u,h)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,h),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),h=SIMD.Float32x4.mul(s,r),h=SIMD.Float32x4.swizzle(h,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),d),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,h),M),h=SIMD.Float32x4.swizzle(h,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),d),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,h)),h=SIMD.Float32x4.mul(s,c),h=SIMD.Float32x4.swizzle(h,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,h)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,h),d),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,h)),h=SIMD.Float32x4.mul(s,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),f),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(r,h)),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,h)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,h),M),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,M),t},e.adjoint=a.USE_SIMD?e.SIMD.adjoint:e.scalar.adjoint,e.determinant=function(t){var n=t[0],i=t[1],a=t[2],e=t[3],o=t[4],s=t[5],r=t[6],u=t[7],c=t[8],h=t[9],l=t[10],f=t[11],d=t[12],M=t[13],p=t[14],m=t[15],S=n*s-i*o,v=n*r-a*o,I=n*u-e*o,x=i*r-a*s,D=i*u-e*s,F=a*u-e*r,b=c*M-h*d,y=c*p-l*d,g=c*m-f*d,w=h*p-l*M,A=h*m-f*M,E=l*m-f*p;return S*E-v*A+I*w+x*g-D*y+F*b},e.SIMD.multiply=function(t,n,i){var a=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4.load(i,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,3,3,3,3),s))));SIMD.Float32x4.store(t,0,u);var c=SIMD.Float32x4.load(i,4),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),s))));SIMD.Float32x4.store(t,4,h);var l=SIMD.Float32x4.load(i,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),s))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(i,12),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),s))));return SIMD.Float32x4.store(t,12,M),t},e.scalar.multiply=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],c=n[6],h=n[7],l=n[8],f=n[9],d=n[10],M=n[11],p=n[12],m=n[13],S=n[14],v=n[15],I=i[0],x=i[1],D=i[2],F=i[3];return t[0]=I*a+x*r+D*l+F*p,t[1]=I*e+x*u+D*f+F*m,t[2]=I*o+x*c+D*d+F*S,t[3]=I*s+x*h+D*M+F*v,I=i[4],x=i[5],D=i[6],F=i[7],t[4]=I*a+x*r+D*l+F*p,t[5]=I*e+x*u+D*f+F*m,t[6]=I*o+x*c+D*d+F*S,t[7]=I*s+x*h+D*M+F*v,I=i[8],x=i[9],D=i[10],F=i[11],t[8]=I*a+x*r+D*l+F*p,t[9]=I*e+x*u+D*f+F*m,t[10]=I*o+x*c+D*d+F*S,t[11]=I*s+x*h+D*M+F*v,I=i[12],x=i[13],D=i[14],F=i[15],t[12]=I*a+x*r+D*l+F*p,t[13]=I*e+x*u+D*f+F*m,t[14]=I*o+x*c+D*d+F*S,t[15]=I*s+x*h+D*M+F*v,t},e.multiply=a.USE_SIMD?e.SIMD.multiply:e.scalar.multiply,e.mul=e.multiply,e.scalar.translate=function(t,n,i){var a,e,o,s,r,u,c,h,l,f,d,M,p=i[0],m=i[1],S=i[2];return n===t?(t[12]=n[0]*p+n[4]*m+n[8]*S+n[12],t[13]=n[1]*p+n[5]*m+n[9]*S+n[13],t[14]=n[2]*p+n[6]*m+n[10]*S+n[14],t[15]=n[3]*p+n[7]*m+n[11]*S+n[15]):(a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],c=n[6],h=n[7],l=n[8],f=n[9],d=n[10],M=n[11],t[0]=a,t[1]=e,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=c,t[7]=h,t[8]=l,t[9]=f,t[10]=d,t[11]=M,t[12]=a*p+r*m+l*S+n[12],t[13]=e*p+u*m+f*S+n[13],t[14]=o*p+c*m+d*S+n[14],t[15]=s*p+h*m+M*S+n[15]),t},e.SIMD.translate=function(t,n,i){var a=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4(i[0],i[1],i[2],0);n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11]),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(r,0,0,0,0)),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(r,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(r,2,2,2,2));var u=SIMD.Float32x4.add(a,SIMD.Float32x4.add(e,SIMD.Float32x4.add(o,s)));return SIMD.Float32x4.store(t,12,u),t},e.translate=a.USE_SIMD?e.SIMD.translate:e.scalar.translate,e.scalar.scale=function(t,n,i){var a=i[0],e=i[1],o=i[2];return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.SIMD.scale=function(t,n,i){var a,e,o,s=SIMD.Float32x4(i[0],i[1],i[2],0);return a=SIMD.Float32x4.load(n,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,0,0,0,0))),e=SIMD.Float32x4.load(n,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(s,1,1,1,1))),o=SIMD.Float32x4.load(n,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2))),t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},e.scale=a.USE_SIMD?e.SIMD.scale:e.scalar.scale,e.rotate=function(t,n,i,e){var o,s,r,u,c,h,l,f,d,M,p,m,S,v,I,x,D,F,b,y,g,w,A,E,R=e[0],_=e[1],P=e[2],z=Math.sqrt(R*R+_*_+P*P);return Math.abs(z)<a.EPSILON?null:(z=1/z,R*=z,_*=z,P*=z,o=Math.sin(i),s=Math.cos(i),r=1-s,u=n[0],c=n[1],h=n[2],l=n[3],f=n[4],d=n[5],M=n[6],p=n[7],m=n[8],S=n[9],v=n[10],I=n[11],x=R*R*r+s,D=_*R*r+P*o,F=P*R*r-_*o,b=R*_*r-P*o,y=_*_*r+s,g=P*_*r+R*o,w=R*P*r+_*o,A=_*P*r-R*o,E=P*P*r+s,t[0]=u*x+f*D+m*F,t[1]=c*x+d*D+S*F,t[2]=h*x+M*D+v*F,t[3]=l*x+p*D+I*F,t[4]=u*b+f*y+m*g,t[5]=c*b+d*y+S*g,t[6]=h*b+M*y+v*g,t[7]=l*b+p*y+I*g,t[8]=u*w+f*A+m*E,t[9]=c*w+d*A+S*E,t[10]=h*w+M*A+v*E,t[11]=l*w+p*A+I*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},e.scalar.rotateX=function(t,n,i){var a=Math.sin(i),e=Math.cos(i),o=n[4],s=n[5],r=n[6],u=n[7],c=n[8],h=n[9],l=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*e+c*a,t[5]=s*e+h*a,t[6]=r*e+l*a,t[7]=u*e+f*a,t[8]=c*e-o*a,t[9]=h*e-s*a,t[10]=l*e-r*a,t[11]=f*e-u*a,t},e.SIMD.rotateX=function(t,n,i){var a=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i));n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,4),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,e),SIMD.Float32x4.mul(o,a))),t},e.rotateX=a.USE_SIMD?e.SIMD.rotateX:e.scalar.rotateX,e.scalar.rotateY=function(t,n,i){var a=Math.sin(i),e=Math.cos(i),o=n[0],s=n[1],r=n[2],u=n[3],c=n[8],h=n[9],l=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*e-c*a,t[1]=s*e-h*a,t[2]=r*e-l*a,t[3]=u*e-f*a,t[8]=o*a+c*e,t[9]=s*a+h*e,t[10]=r*a+l*e,t[11]=u*a+f*e,t},e.SIMD.rotateY=function(t,n,i){var a=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i));n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(s,e))),t},e.rotateY=a.USE_SIMD?e.SIMD.rotateY:e.scalar.rotateY,e.scalar.rotateZ=function(t,n,i){var a=Math.sin(i),e=Math.cos(i),o=n[0],s=n[1],r=n[2],u=n[3],c=n[4],h=n[5],l=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*e+c*a,t[1]=s*e+h*a,t[2]=r*e+l*a,t[3]=u*e+f*a,t[4]=c*e-o*a,t[5]=h*e-s*a,t[6]=l*e-r*a,t[7]=f*e-u*a,t},e.SIMD.rotateZ=function(t,n,i){var a=SIMD.Float32x4.splat(Math.sin(i)),e=SIMD.Float32x4.splat(Math.cos(i));n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,a))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,e),SIMD.Float32x4.mul(o,a))),t},e.rotateZ=a.USE_SIMD?e.SIMD.rotateZ:e.scalar.rotateZ,e.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,n,i){var e,o,s,r=i[0],u=i[1],c=i[2],h=Math.sqrt(r*r+u*u+c*c);return Math.abs(h)<a.EPSILON?null:(h=1/h,r*=h,u*=h,c*=h,e=Math.sin(n),o=Math.cos(n),s=1-o,t[0]=r*r*s+o,t[1]=u*r*s+c*e,t[2]=c*r*s-u*e,t[3]=0,t[4]=r*u*s-c*e,t[5]=u*u*s+o,t[6]=c*u*s+r*e,t[7]=0,t[8]=r*c*s+u*e,t[9]=u*c*s-r*e,t[10]=c*c*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=a+a,u=e+e,c=o+o,h=a*r,l=a*u,f=a*c,d=e*u,M=e*c,p=o*c,m=s*r,S=s*u,v=s*c;return t[0]=1-(d+p),t[1]=l+v,t[2]=f-S,t[3]=0,t[4]=l-v,t[5]=1-(h+p),t[6]=M+m,t[7]=0,t[8]=f+S,t[9]=M-m,t[10]=1-(h+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},e.getTranslation=function(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t},e.getRotation=function(t,n){var i=n[0]+n[5]+n[10],a=0;return i>0?(a=2*Math.sqrt(i+1),t[3]=.25*a,t[0]=(n[6]-n[9])/a,t[1]=(n[8]-n[2])/a,t[2]=(n[1]-n[4])/a):n[0]>n[5]&n[0]>n[10]?(a=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/a,t[0]=.25*a,t[1]=(n[1]+n[4])/a,t[2]=(n[8]+n[2])/a):n[5]>n[10]?(a=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/a,t[0]=(n[1]+n[4])/a,t[1]=.25*a,t[2]=(n[6]+n[9])/a):(a=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/a,t[0]=(n[8]+n[2])/a,t[1]=(n[6]+n[9])/a,t[2]=.25*a),t},e.fromRotationTranslationScale=function(t,n,i,a){var e=n[0],o=n[1],s=n[2],r=n[3],u=e+e,c=o+o,h=s+s,l=e*u,f=e*c,d=e*h,M=o*c,p=o*h,m=s*h,S=r*u,v=r*c,I=r*h,x=a[0],D=a[1],F=a[2];return t[0]=(1-(M+m))*x,t[1]=(f+I)*x,t[2]=(d-v)*x,t[3]=0,t[4]=(f-I)*D,t[5]=(1-(l+m))*D,t[6]=(p+S)*D,t[7]=0,t[8]=(d+v)*F,t[9]=(p-S)*F,t[10]=(1-(l+M))*F,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,n,i,a,e){var o=n[0],s=n[1],r=n[2],u=n[3],c=o+o,h=s+s,l=r+r,f=o*c,d=o*h,M=o*l,p=s*h,m=s*l,S=r*l,v=u*c,I=u*h,x=u*l,D=a[0],F=a[1],b=a[2],y=e[0],g=e[1],w=e[2];return t[0]=(1-(p+S))*D,t[1]=(d+x)*D,t[2]=(M-I)*D,t[3]=0,t[4]=(d-x)*F,t[5]=(1-(f+S))*F,t[6]=(m+v)*F,t[7]=0,t[8]=(M+I)*b,t[9]=(m-v)*b,t[10]=(1-(f+p))*b,t[11]=0,t[12]=i[0]+y-(t[0]*y+t[4]*g+t[8]*w),t[13]=i[1]+g-(t[1]*y+t[5]*g+t[9]*w),t[14]=i[2]+w-(t[2]*y+t[6]*g+t[10]*w),t[15]=1,t},e.fromQuat=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=i+i,r=a+a,u=e+e,c=i*s,h=a*s,l=a*r,f=e*s,d=e*r,M=e*u,p=o*s,m=o*r,S=o*u;return t[0]=1-l-M,t[1]=h+S,t[2]=f-m,t[3]=0,t[4]=h-S,t[5]=1-c-M,t[6]=d+p,t[7]=0,t[8]=f+m,t[9]=d-p,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,n,i,a,e,o,s){var r=1/(i-n),u=1/(e-a),c=1/(o-s);return t[0]=2*o*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+n)*r,t[9]=(e+a)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t},e.perspective=function(t,n,i,a,e){var o=1/Math.tan(n/2),s=1/(a-e);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+a)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*a*s,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,n,i,a){var e=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),s=Math.tan(n.leftDegrees*Math.PI/180),r=Math.tan(n.rightDegrees*Math.PI/180),u=2/(s+r),c=2/(e+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((s-r)*u*.5),t[9]=(e-o)*c*.5,t[10]=a/(i-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i/(i-a),t[15]=0,t},e.ortho=function(t,n,i,a,e,o,s){var r=1/(n-i),u=1/(a-e),c=1/(o-s);return t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+i)*r,t[13]=(e+a)*u,t[14]=(s+o)*c,t[15]=1,t},e.lookAt=function(t,n,i,o){var s,r,u,c,h,l,f,d,M,p,m=n[0],S=n[1],v=n[2],I=o[0],x=o[1],D=o[2],F=i[0],b=i[1],y=i[2];return Math.abs(m-F)<a.EPSILON&&Math.abs(S-b)<a.EPSILON&&Math.abs(v-y)<a.EPSILON?e.identity(t):(f=m-F,d=S-b,M=v-y,p=1/Math.sqrt(f*f+d*d+M*M),f*=p,d*=p,M*=p,s=x*M-D*d,r=D*f-I*M,u=I*d-x*f,p=Math.sqrt(s*s+r*r+u*u),p?(p=1/p,s*=p,r*=p,u*=p):(s=0,r=0,u=0),c=d*u-M*r,h=M*s-f*u,l=f*r-d*s,p=Math.sqrt(c*c+h*h+l*l),p?(p=1/p,c*=p,h*=p,l*=p):(c=0,h=0,l=0),t[0]=s,t[1]=c,t[2]=f,t[3]=0,t[4]=r,t[5]=h,t[6]=d,t[7]=0,t[8]=u,t[9]=l,t[10]=M,t[11]=0,t[12]=-(s*m+r*S+u*v),t[13]=-(c*m+h*S+l*v),t[14]=-(f*m+d*S+M*v),t[15]=1,t)},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t[4]=n[4]+i[4],t[5]=n[5]+i[5],t[6]=n[6]+i[6],t[7]=n[7]+i[7],t[8]=n[8]+i[8],t[9]=n[9]+i[9],t[10]=n[10]+i[10],t[11]=n[11]+i[11],t[12]=n[12]+i[12],t[13]=n[13]+i[13],t[14]=n[14]+i[14],t[15]=n[15]+i[15],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t[4]=n[4]-i[4],t[5]=n[5]-i[5],t[6]=n[6]-i[6],t[7]=n[7]-i[7],t[8]=n[8]-i[8],t[9]=n[9]-i[9],t[10]=n[10]-i[10],t[11]=n[11]-i[11],t[12]=n[12]-i[12],t[13]=n[13]-i[13],t[14]=n[14]-i[14],t[15]=n[15]-i[15],t},e.sub=e.subtract,e.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=n[11]*i,t[12]=n[12]*i,t[13]=n[13]*i,t[14]=n[14]*i,t[15]=n[15]*i,t},e.multiplyScalarAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t[3]=n[3]+i[3]*a,t[4]=n[4]+i[4]*a,t[5]=n[5]+i[5]*a,t[6]=n[6]+i[6]*a,t[7]=n[7]+i[7]*a,t[8]=n[8]+i[8]*a,t[9]=n[9]+i[9]*a,t[10]=n[10]+i[10]*a,t[11]=n[11]+i[11]*a,t[12]=n[12]+i[12]*a,t[13]=n[13]+i[13]*a,t[14]=n[14]+i[14]*a,t[15]=n[15]+i[15]*a,t},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=t[3],r=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=t[9],d=t[10],M=t[11],p=t[12],m=t[13],S=t[14],v=t[15],I=n[0],x=n[1],D=n[2],F=n[3],b=n[4],y=n[5],g=n[6],w=n[7],A=n[8],E=n[9],R=n[10],_=n[11],P=n[12],z=n[13],T=n[14],C=n[15];return Math.abs(i-I)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(I))&&Math.abs(e-x)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(o-D)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(s-F)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(r-b)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(u-y)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-g)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-w)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(l-A)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-E)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(M-_)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(_))&&Math.abs(p-P)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(m-z)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(S-T)<=a.EPSILON*Math.max(1,Math.abs(S),Math.abs(T))&&Math.abs(v-C)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(C))},t.exports=e},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);const s=o.a.create(),r=o.a.create(),u=o.a.create(),c=o.a.create();class h extends a.a{constructor(t){super(),this.flock=t}update(t,n){o.a.set(u,0,0,0),o.a.set(r,0,0,0),o.a.set(s,0,0,0),o.a.set(c,0,0,0);let i=0;const a=this.flock.length;for(let e=0;e<a;e++){const n=this.flock[e],a=o.a.dist(n.position,t.position);a>0&&a<h.NEIGHBOUR_RADIUS&&(o.a.add(u,u,n.position),o.a.add(r,r,n.velocity),a<h.SEPARATION_RADIUS&&(o.a.subtract(c,t.position,n.position),o.a.normalize(c,c),o.a.scaleAndAdd(s,s,c,1/a)),i++)}if(i>0){o.a.scale(u,u,1/i),o.a.subtract(u,u,t.position),o.a.scaleAndAdd(t.velocity,t.velocity,u,h.COHESION_WEIGHT),o.a.scaleAndAdd(t.velocity,t.velocity,r,h.ALIGN_WEIGHT/i),o.a.scaleAndAdd(t.velocity,t.velocity,s,h.SEPARATION_WEIGHT/i);var l=o.a.length(t.velocity);l>h.MAX_SPEED&&o.a.scale(t.velocity,t.velocity,h.MAX_SPEED/l)}}}n.a=h,h.NEIGHBOUR_RADIUS=200,h.SEPARATION_RADIUS=150,h.MAX_SPEED=.1,h.COHESION_WEIGHT=.1*h.MAX_SPEED/h.NEIGHBOUR_RADIUS,h.ALIGN_WEIGHT=30*h.MAX_SPEED/h.NEIGHBOUR_RADIUS,h.SEPARATION_WEIGHT=100/h.SEPARATION_RADIUS},function(t,n,i){"use strict";class a{constructor(t,n){this.image=new Image,this.width=0,this.height=0,this.loaded=!1,this.loadPromise=new Promise((i,a)=>{this.image.onload=(()=>{this.width=this.image.width,this.height=this.image.height,this.loaded=!0,n&&n(this),i(this)}),this.image.onerror=function(){throw new Error("Failed to load a texture: "+t)},this.image.src=t})}load(){return this.loadPromise}}n.a=a},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super()}playSound(t){t.audio&&t.audio.play()}}n.a=e},function(t,n,i){"use strict";var a,e=i(13),o=i(11),s=i(7),r=i(8),u=i(6),c=i(27),h=i(10);!function(t){t[t.STATE_PAUSED=0]="STATE_PAUSED",t[t.STATE_PLAYING=1]="STATE_PLAYING",t[t.STATE_STOPPED=2]="STATE_STOPPED",t[t.STATE_DEAD=3]="STATE_DEAD"}(a||(a={}));let l=0;const f="undefined"!=typeof window&&window.requestAnimationFrame||function(t,n){var i=(new Date).getTime(),a=Math.max(0,16-(i-l)),e=setTimeout(function(){t(i+a)},a);return l=i+a,e};class d{constructor({canvas,width,height,score,lives,level,autosize}={canvas:null,width:0,height:0,score:0,lives:0,level:0,autosize:false}){this.root=new e.a,this.textures=[],this.sounds=[],this.frame=0,this.time=0,this.score=0,this.lives=0,this.level=0,this._toLoad=0,this._lastTime=0,this._loaded=0,this._generalObjects=null,this._autosizeCallback=(()=>{if(this.canvas){const t=this.canvas.offsetWidth,n=this.canvas.offsetHeight;this.setSize(t,n),this.cameraSystem&&this.cameraSystem.setPosition(t/2,n/2),this.worldSystem&&this.worldSystem.setBounds(0,0,t,n)}}),this._events={},this.canvas=canvas,this.width=width||this.canvas&&this.canvas.width||0,this.height=height||this.canvas&&this.canvas.height||0,this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.score=score,this.lives=lives,this.level=level,autosize&&this.setAutosize(!0)}addObject(t){this._initialiseGeneralObjects(),this._generalObjects.addObject(t)}setCanvas(t){this.canvas=t,this.canvas&&(this.width=this.width||this.canvas.width,this.height=this.height||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height)}loadTextures(t){return this._toLoad+=t.length,t.map(t=>{const n=new c.a(t,t=>this._resourceLoaded(t));return this.textures.push(n),n})}loadAudio(t){return this._toLoad+=t.length,t.map(t=>{const n={audio:new Audio,length:0,loaded:!1};return n.audio.addEventListener("canplaythrough",()=>{n.loaded||(n.length=n.audio.duration,n.loaded=!0,this._resourceLoaded(n))}),n.audio.onerror=function(){throw new Error("Failed to load a sound: "+t)},n.audio.src=t,this.sounds.push(n),n})}start(){this.nextLevel(),this.state=a.STATE_PLAYING,this._loop()}stop(){this.state=a.STATE_STOPPED}getDefaultCamera(){return this.cameraSystem||(this.cameraSystem=new o.a,this.cameraSystem.setPosition(this.width/2,this.height/2),this._initialiseGeneralObjects(),this.root.addObject(this.cameraSystem)),this.cameraSystem}getDefaultRenderer(){if(!this.renderSystem){this.cameraSystem||this.getDefaultCamera();let t;this.canvas&&(t=this.canvas.getContext("2d")),this.renderSystem=new s.a(t,this.cameraSystem),this._initialiseGeneralObjects(),this.root.addObject(this.renderSystem)}return this.renderSystem}getDefaultWorld(t=0,n=t){const i=[-t,-n,this.width+t,this.height+n];return this.worldSystem?this.worldSystem.setBounds(...i):(this.worldSystem=new r.a(i),this._initialiseGeneralObjects(),this.root.addObject(this.worldSystem)),this.worldSystem}getDefaultInput(){return this.inputSystem||(this.cameraSystem||this.getDefaultCamera(),this.inputSystem=new u.a(this.canvas,"undefined"!=typeof document&&document,this.cameraSystem),this._initialiseGeneralObjects(),this.root.addObject(this.inputSystem)),this.inputSystem}setScore(t){this.score=t,this.fire("score",this.score)}nextLevel(){this.level++,this.fire("loadLevel",this.level)}setLevel(t){this.level=t,this.fire("loadLevel",this.level)}completeLevel(){this.fire("levelComplete",this.level)}setSize(t,n){this.width=t,this.height=n,this.canvas&&(this.canvas.width=t,this.canvas.height=n)}setAutosize(t){"undefined"!=typeof window&&(t?window.addEventListener("resize",this._autosizeCallback):window.removeEventListener("resize",this._autosizeCallback))}_loop(){const t=n=>{if(n&&this.time==n)return void console.log("Multiple calls: "+n);this.time=n,this.frame++;try{this.root.update(Math.min(n-this._lastTime,100)),this.state==a.STATE_PLAYING&&f(t),this._lastTime=n}catch(t){window.console&&console.error(t.stack||t)}};t(this._lastTime)}_resourceLoaded(t){this._loaded++,this.fire("resourcesProgress",this._loaded/this._toLoad),this._toLoad-this._loaded<=0&&this.fire("resourcesLoaded")}_initialiseGeneralObjects(){this._generalObjects||(this._generalObjects=new e.a,this.root.addObjectAt(this._generalObjects,0))}}n.a=d,d.State=a,i.i(h.b)(d,h.c)},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(4),e=i(47),o=i(45),s=i(46),r=i(48);i.d(n,"PropertyAnimationComponent",function(){return a.a}),i.d(n,"PositionAnimationComponent",function(){return e.a}),i.d(n,"BoundsAnimationComponent",function(){return o.a}),i.d(n,"ColorAnimationComponent",function(){return s.a}),i.d(n,"RotationAnimationComponent",function(){return r.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(50);i.d(n,"MoveComponent",function(){return a.a});var e=i(51);i.d(n,"PhysicsComponent",function(){return e.a});var o=i(39);i.d(n,"GravityComponent",function(){return o.a});var s=i(52);i.d(n,"PointGravityComponent",function(){return s.a});var r=i(62);i.d(n,"TerminalVelocityComponent",function(){return r.a});var u=i(49);i.d(n,"FollowComponent",function(){return u.a});var c=i(58);i.d(n,"RotationComponent",function(){return c.a});var h=i(57);i.d(n,"RotateToHeadingComponent",function(){return h.a});var l=i(63);i.d(n,"TrackRotationComponent",function(){return l.a});var f=i(55);i.d(n,"RandomPositionComponent",function(){return f.a});var d=i(56);i.d(n,"RandomVelocityComponent",function(){return d.a});var M=i(54);i.d(n,"RandomImpulseComponent",function(){return M.a});var p=i(26);i.d(n,"FlockingComponent",function(){return p.a});var m=i(61);i.d(n,"SwitchComponent",function(){return m.a});var S=i(53);i.d(n,"PositionInterpolatorComponent",function(){return S.a});var v=i(59);i.d(n,"SmoothPositionComponent",function(){return v.a});var I=i(60);i.d(n,"SmoothRotationComponent",function(){return I.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(64);i.d(n,"CollisionSystem",function(){return a.a});var e=i(18);i.d(n,"CollisionComponent",function(){return e.a});var o=i(17);i.d(n,"BounceComponent",function(){return o.a});var s=i(40);i.d(n,"BackgroundCollisionSystem",function(){return s.a});var r=i(12);i.d(n,"BackgroundCollisionComponent",function(){return r.a});var u=i(19);i.d(n,"SolidComponent",function(){return u.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(65);i.d(n,"DebugDrawBoundsComponent",function(){return a.a});var e=i(66);i.d(n,"DebugDrawPathComponent",function(){return e.a});var o=i(67);i.d(n,"DebugDrawSurfacesComponent",function(){return o.a});var s=i(68);i.d(n,"DebugFlockingComponent",function(){return s.a});var r=i(69);i.d(n,"PositionRenderComponent",function(){return r.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(6);i.d(n,"InputSystem",function(){return a.a});var e=i(20);i.d(n,"ClickComponent",function(){return e.a});var o=i(14);i.d(n,"MoveToClickComponent",function(){return o.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(7);i.d(n,"CanvasRenderSystem",function(){return a.a});var e=i(21);i.d(n,"DotRenderComponent",function(){return e.a});var o=i(22);i.d(n,"RectangleRenderComponent",function(){return o.a});var s=i(23);i.d(n,"TextRenderComponent",function(){return s.a});var r=i(24);i.d(n,"WebGLRenderSystem",function(){return r.a});var u=i(70);i.d(n,"PolyShapeRenderComponent",function(){return u.a});var c=i(44);i.d(n,"TileRenderComponent",function(){return c.a});var h=i(43);i.d(n,"SpriteRenderComponent",function(){return h.a});var l=i(42);i.d(n,"SpriteAnimationComponent",function(){return l.a});var f=i(41);i.d(n,"Sprite",function(){return f.a});var d=i(27);i.d(n,"Texture",function(){return d.a})},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(8);i.d(n,"WorldSystem",function(){return a.a});var e=i(15);i.d(n,"WorldBounceComponent",function(){return e.a});var o=i(16);i.d(n,"WorldWrapComponent",function(){return o.a})},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var n=new a.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,n,i,e){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=n,o[2]=i,o[3]=e,o},e.set=function(t,n,i,a,e){return t[0]=n,t[1]=i,t[2]=a,t[3]=e,t},e.transpose=function(t,n){if(t===n){var i=n[1];t[1]=n[2],t[2]=i}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},e.invert=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=i*o-e*a;return s?(s=1/s,t[0]=o*s,t[1]=-a*s,t[2]=-e*s,t[3]=i*s,t):null},e.adjoint=function(t,n){var i=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=i,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=i[0],u=i[1],c=i[2],h=i[3];return t[0]=a*r+o*u,t[1]=e*r+s*u,t[2]=a*c+o*h,t[3]=e*c+s*h,t},e.mul=e.multiply,e.rotate=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=Math.sin(i),u=Math.cos(i);return t[0]=a*u+o*r,t[1]=e*u+s*r,t[2]=a*-r+o*u,t[3]=e*-r+s*u,t},e.scale=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=i[0],u=i[1];return t[0]=a*r,t[1]=e*r,t[2]=o*u,t[3]=s*u,t},e.fromRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=i,t[2]=-i,t[3]=a,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,n,i,a){return t[2]=a[2]/a[0],i[0]=a[0],i[1]=a[1],i[3]=a[3]-t[2]*i[1],[t,n,i]},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t},e.sub=e.subtract,e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=t[3],r=n[0],u=n[1],c=n[2],h=n[3];return Math.abs(i-r)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(e-u)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(o-c)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-h)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))},e.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t},e.multiplyScalarAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t[3]=n[3]+i[3]*a,t},t.exports=e},function(t,n,i){var a=i(3),e={};e.create=function(){var t=new a.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},e.clone=function(t){var n=new a.ARRAY_TYPE(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},e.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],
t[7]=n[7],t[8]=n[8],t},e.fromValues=function(t,n,i,e,o,s,r,u,c){var h=new a.ARRAY_TYPE(9);return h[0]=t,h[1]=n,h[2]=i,h[3]=e,h[4]=o,h[5]=s,h[6]=r,h[7]=u,h[8]=c,h},e.set=function(t,n,i,a,e,o,s,r,u,c){return t[0]=n,t[1]=i,t[2]=a,t[3]=e,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=c,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,n){if(t===n){var i=n[1],a=n[2],e=n[5];t[1]=n[3],t[2]=n[6],t[3]=i,t[5]=n[7],t[6]=a,t[7]=e}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},e.invert=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],c=n[7],h=n[8],l=h*s-r*c,f=-h*o+r*u,d=c*o-s*u,M=i*l+a*f+e*d;return M?(M=1/M,t[0]=l*M,t[1]=(-h*a+e*c)*M,t[2]=(r*a-e*s)*M,t[3]=f*M,t[4]=(h*i-e*u)*M,t[5]=(-r*i+e*o)*M,t[6]=d*M,t[7]=(-c*i+a*u)*M,t[8]=(s*i-a*o)*M,t):null},e.adjoint=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],c=n[7],h=n[8];return t[0]=s*h-r*c,t[1]=e*c-a*h,t[2]=a*r-e*s,t[3]=r*u-o*h,t[4]=i*h-e*u,t[5]=e*o-i*r,t[6]=o*c-s*u,t[7]=a*u-i*c,t[8]=i*s-a*o,t},e.determinant=function(t){var n=t[0],i=t[1],a=t[2],e=t[3],o=t[4],s=t[5],r=t[6],u=t[7],c=t[8];return n*(c*o-s*u)+i*(-c*e+s*r)+a*(u*e-o*r)},e.multiply=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],c=n[6],h=n[7],l=n[8],f=i[0],d=i[1],M=i[2],p=i[3],m=i[4],S=i[5],v=i[6],I=i[7],x=i[8];return t[0]=f*a+d*s+M*c,t[1]=f*e+d*r+M*h,t[2]=f*o+d*u+M*l,t[3]=p*a+m*s+S*c,t[4]=p*e+m*r+S*h,t[5]=p*o+m*u+S*l,t[6]=v*a+I*s+x*c,t[7]=v*e+I*r+x*h,t[8]=v*o+I*u+x*l,t},e.mul=e.multiply,e.translate=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],c=n[6],h=n[7],l=n[8],f=i[0],d=i[1];return t[0]=a,t[1]=e,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=f*a+d*s+c,t[7]=f*e+d*r+h,t[8]=f*o+d*u+l,t},e.rotate=function(t,n,i){var a=n[0],e=n[1],o=n[2],s=n[3],r=n[4],u=n[5],c=n[6],h=n[7],l=n[8],f=Math.sin(i),d=Math.cos(i);return t[0]=d*a+f*s,t[1]=d*e+f*r,t[2]=d*o+f*u,t[3]=d*s-f*a,t[4]=d*r-f*e,t[5]=d*u-f*o,t[6]=c,t[7]=h,t[8]=l,t},e.scale=function(t,n,i){var a=i[0],e=i[1];return t[0]=a*n[0],t[1]=a*n[1],t[2]=a*n[2],t[3]=e*n[3],t[4]=e*n[4],t[5]=e*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},e.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t},e.fromRotation=function(t,n){var i=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=i,t[2]=0,t[3]=-i,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},e.fromQuat=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=i+i,r=a+a,u=e+e,c=i*s,h=a*s,l=a*r,f=e*s,d=e*r,M=e*u,p=o*s,m=o*r,S=o*u;return t[0]=1-l-M,t[3]=h-S,t[6]=f+m,t[1]=h+S,t[4]=1-c-M,t[7]=d-p,t[2]=f-m,t[5]=d+p,t[8]=1-c-l,t},e.normalFromMat4=function(t,n){var i=n[0],a=n[1],e=n[2],o=n[3],s=n[4],r=n[5],u=n[6],c=n[7],h=n[8],l=n[9],f=n[10],d=n[11],M=n[12],p=n[13],m=n[14],S=n[15],v=i*r-a*s,I=i*u-e*s,x=i*c-o*s,D=a*u-e*r,F=a*c-o*r,b=e*c-o*u,y=h*p-l*M,g=h*m-f*M,w=h*S-d*M,A=l*m-f*p,E=l*S-d*p,R=f*S-d*m,_=v*R-I*E+x*A+D*w-F*g+b*y;return _?(_=1/_,t[0]=(r*R-u*E+c*A)*_,t[1]=(u*w-s*R-c*g)*_,t[2]=(s*E-r*w+c*y)*_,t[3]=(e*E-a*R-o*A)*_,t[4]=(i*R-e*w+o*g)*_,t[5]=(a*w-i*E-o*y)*_,t[6]=(p*b-m*F+S*D)*_,t[7]=(m*x-M*b-S*I)*_,t[8]=(M*F-p*x+S*v)*_,t):null},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t[3]=n[3]+i[3],t[4]=n[4]+i[4],t[5]=n[5]+i[5],t[6]=n[6]+i[6],t[7]=n[7]+i[7],t[8]=n[8]+i[8],t},e.subtract=function(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t[3]=n[3]-i[3],t[4]=n[4]-i[4],t[5]=n[5]-i[5],t[6]=n[6]-i[6],t[7]=n[7]-i[7],t[8]=n[8]-i[8],t},e.sub=e.subtract,e.multiplyScalar=function(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=n[3]*i,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*i,t},e.multiplyScalarAndAdd=function(t,n,i,a){return t[0]=n[0]+i[0]*a,t[1]=n[1]+i[1]*a,t[2]=n[2]+i[2]*a,t[3]=n[3]+i[3]*a,t[4]=n[4]+i[4]*a,t[5]=n[5]+i[5]*a,t[6]=n[6]+i[6]*a,t[7]=n[7]+i[7]*a,t[8]=n[8]+i[8]*a,t},e.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]},e.equals=function(t,n){var i=t[0],e=t[1],o=t[2],s=t[3],r=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=n[0],d=n[1],M=n[2],p=n[3],m=n[4],S=n[5],v=t[6],I=n[7],x=n[8];return Math.abs(i-f)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(e-d)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(o-M)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(r-m)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(u-S)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-v)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-I)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(l-x)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))},t.exports=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{update(t,n){"undefined"==typeof t.velocity[1]&&(t.velocity[1]=0),t.velocity[1]+=e.GRAVITATIONAL_CONSTANT*n}}n.a=e,e.GRAVITATIONAL_CONSTANT=3e-4},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super(...arguments),this.surfaces=[],this.temporarySurfaces=[]}addSurface(t){this.surfaces.push(t)}addSurfaces(t){for(var n=0;n<t.length;n++)this.surfaces.push(t[n])}clearSurfaces(){this.surfaces.length=0}addTemporarySurface(t){this.temporarySurfaces.push(t)}update(t){super.update(t),this.temporarySurfaces.length=0}}n.a=e},function(t,n,i){"use strict";class a{constructor(t){this.x=0,this.y=0,this.w=0,this.h=0,this.ox=0,this.oy=0,this.t=t,t.load().then(t=>{this.w=t.width,this.h=t.height,this.ox=t.width/2,this.oy=t.height/2})}static generateSpriteSheet(t,n,i){var a,e,o=[];for(a=0;a<n;a++)for(e=0;e<i;e++)o.push({t:t.t,x:e*t.w,y:a*t.h,w:t.w,h:t.h,ox:t.ox,oy:t.oy,d:t.d});return o}}n.a=a},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n){super(),this.duration=t,this.spriteIndex=0,this.playing=!0,this.sprites=n}init(t){this.sprites&&(t.sprites=this.sprites),t.sprites.length&&(t.sprite=t.sprites[0]),t.spriteCountdown=t.sprite&&t.sprite.d||this.duration}update(t,n){var i,a,e=t.sprites.length;this.playing&&(t.spriteCountdown-=n,t.spriteCountdown<=0&&(this.spriteIndex=(this.spriteIndex+1)%e,i=t.sprites[this.spriteIndex],t.sprite=i,a=i.d||this.duration,t.spriteCountdown=a))}play(){this.playing=!0}stop(){this.playing=!1,this.spriteIndex=0}pause(){this.playing=!1}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i=1){super(),this.renderSystem=t,this.layer=i,this.sprite=n}update(t,n){super.update(n);var i=this.sprite||t.sprite,a=i&&i.t.image;i&&this.renderSystem.push(function(n){var e=t.position[0],o=t.position[1],s=i.w,r=i.h;n.translate(e,o),n.rotate(t.rotation),n.drawImage(a,i.x,i.y,s,r,-i.ox,-i.oy,s,r)},this.layer)}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n,i){super(),this.renderSystem=t,this.texture=n,this.bounds=i}update(t,n){for(var i,a=this.renderSystem,e=this.texture,o=this.bounds,s=e.width,r=e.height,u=t.position[0]%s,c=(t.position[1]%r,o[1]),h=o[2],l=o[3],f=function(t,n,i){return function(a){a.drawImage(t.image,n,i)}};c<l+r;c+=r)for(i=o[0]+u-s;i<h+s;i+=s)a.push(f(e,i,c))}}n.a=e},function(t,n,i){"use strict";var a=i(4);const e=(t,n)=>{t.setBounds(...n)};class o extends a.a{constructor(t,n,i=undefined,a=undefined){super(e,t,n,i,a)}}n.a=o},function(t,n,i){"use strict";function a(t,n){t.color=`rgba(${0|n[0]}, ${0|n[1]}, ${0|n[2]}, ${n[3]})`}var e=i(4),o=i(10);class s extends e.a{constructor(t,n,e=undefined,s=undefined){super(a,i.i(o.a)(t),i.i(o.a)(n),e,s)}}n.a=s},function(t,n,i){"use strict";var a=i(4);const e=(t,n)=>{t.setPosition(...n)};class o extends a.a{constructor(t,n,i=undefined,a=undefined){super(e,t,n,i,a)}}n.a=o},function(t,n,i){"use strict";var a=i(4);const e=(t,n)=>{t.setRotation(n[0])};class o extends a.a{constructor(t,n,i=undefined,a=undefined,o=undefined){super(e,t,n,i,a,o)}update(t,n){this.end[0]=this.rotation,super.update(t,n)}setRotation(t){this.start[0]=this.rotation,this.end[0]=t,this.reset(),super.setRotation(t)}}n.a=o},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t){super(),this.target=t}update(t,n){o.a.add(t.position,this.target.position,this.position)}setTarget(t){this.target=t}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{update(t,n){o.a.scaleAndAdd(t.position,t.position,t.velocity,n)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{init(t){t.impulse=o.a.create()}update(t,n){o.a.add(t.velocity,t.velocity,t.impulse),o.a.set(t.impulse,0,0,0)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t){super(),this.target=t,this.vector=o.a.create()}update(t,n){o.a.subtract(this.vector,this.target.position,t.position);var i=this.target.mass*n/o.a.squaredLength(this.vector);o.a.normalize(this.vector,this.vector),o.a.scaleAndAdd(t.velocity,t.velocity,this.vector,i)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e),s=i(9);class r extends a.a{constructor(t,n){super(),this.duration=t,this.easing=n||s.Linear,this.elapsed=0,this.running=!1,this.starting=!1,this.start=o.a.create(),this.position=o.a.create()}update(t,n){if(this.starting&&(isNaN(this.position[0])&&(this.position[0]=t.position[0]),isNaN(this.position[1])&&(this.position[1]=t.position[1]),isNaN(this.position[2])&&(this.position[2]=t.position[2]),o.a.copy(this.start,t.position),this.running=!0,this.starting=!1,this.elapsed=0),this.running){var i=this.elapsed/this.duration,a=this.easing(i);i>1?(o.a.copy(t.position,this.position),this.running=!1):(o.a.lerp(t.position,this.start,this.position,a),this.elapsed+=n)}}setPosition(t,n,i){super.setPosition(t,n,i),this.starting=!0}}n.a=r},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t=.001,n=.1){super(),this.probability=t,this.maximumImpulse=n}init(t){t.impulse=t.impulse||o.a.create()}update(t,n){Math.random()<this.probability&&o.a.random(t.impulse,Math.random()*this.maximumImpulse)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t,n=.001){super(),this.world=t,this.probability=n}update(t,n){if(Math.random()<this.probability){const n=this.world.bounds,i=Math.random()*(n[2]-n[0]),a=Math.random()*(n[3]-n[1]),e=Math.random()*(n[5]-n[4]);o.a.set(t.position,i,a,e)}}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t=.001,n=.1){super(),this.probability=t,this.maximumVelocity=n}update(t,n){Math.random()<this.probability&&o.a.random(t.velocity,Math.random()*this.maximumVelocity)}}n.a=s},function(t,n,i){"use strict";var a=i(0);class e extends a.a{update(t,n){t.setRotation(Math.atan2(t.velocity[0],-t.velocity[1]))}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.rotationSpeed=t}update(t,n){var i=t.rotationSpeed||this.rotationSpeed||0;t.setRotation(t.rotation+i*n)}}n.a=e},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);const s=o.a.create();class r extends a.a{constructor(){super(),this.speed=.01}update(t,n){super.update(this,n);const i=t.position,a=this.position,e=this.speed;o.a.subtract(s,a,i),o.a.scaleAndAdd(t.position,i,s,n*e)}}n.a=r},function(t,n,i){"use strict";var a=i(0);class e extends a.a{update(t,n){if(this.rotation!=t.rotation){var i=this.rotation,a=t.rotation,e=a-i,o=.01;e>Math.PI?e-=2*Math.PI:e<-Math.PI&&(e+=2*Math.PI),t.rotation=i+e*n*o,this.rotation=t.rotation}}}n.a=e},function(t,n,i){"use strict";var a=i(2),e=i(0),o=a.a.prototype.addComponent;class s extends e.a{constructor(t,n){super(),this.positiveComponents=[],this.negativeComponents=[],this.active=!0,this.object=t,this.prop=n}addComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addPositiveComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addNegativeComponent(t){this.components=this.negativeComponents,o.call(this,t),this.components=void 0}addComponents(t,n){t.forEach(this.addPositiveComponent.bind(this)),n.forEach(this.addNegativeComponent.bind(this))}flip(){this.setActive(!this.active)}setActive(t){this.active=t,this.object&&(this.object[this.prop]=this.active)}update(t,n){var i,a=0;if(this.object&&(this.active=this.object[this.prop]),this.active)for(i=this.positiveComponents.length;a<i;a++)this.positiveComponents[a].update(t,n);else for(i=this.negativeComponents.length;a<i;a++)this.negativeComponents[a].update(t,n)}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1),o=i.n(e);class s extends a.a{constructor(t){super(),this.velocityMagnitude=t}update(t,n){const i=o.a.length(t.velocity);if(i>this.velocityMagnitude){const n=this.velocityMagnitude/i;o.a.scale(t.velocity,t.velocity,n)}}}n.a=s},function(t,n,i){"use strict";var a=i(0),e=i(1);i.n(e);class o extends a.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=this.target.rotation+this.rotation}}n.a=o},function(t,n,i){"use strict";var a=i(2);class e extends a.a{constructor(){super(),this.attackObjects=[],this.vulnerableObjects=[]}addAttackObject(t){this.attackObjects.push(t)}addVulnerableObject(t){this.vulnerableObjects.push(t)}update(t){const n=this.attackObjects.length,i=this.vulnerableObjects.length;for(let a=0;a<n;a++){const t=this.attackObjects[a],n=t.position[0],e=t.position[1],o=t.bounds,s=[n+o[0],e+o[1],n+o[2],e+o[3]];for(let r=0;r<i;r++){const n=this.vulnerableObjects[r],i=n.position[0],a=n.position[1],e=n.bounds,o=[i+e[0],a+e[1],i+e[2],a+e[3]];t!==n&&s[0]<o[2]&&s[1]<o[3]&&s[2]>o[0]&&s[3]>o[1]&&(t.fire("attack",n),n.fire("attackedBy",t))}}this.attackObjects.length=0,this.vulnerableObjects.length=0}}n.a=e},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t){super(),this.renderSystem=t}update(t,n){const i=t.bounds;i&&this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.rect(t.bounds[0],t.bounds[1],t.bounds[2]-t.bounds[0],t.bounds[3]-t.bounds[1]),n.strokeStyle="#000",n.stroke()})}}n.a=e},function(t,n,i){"use strict";var a=(i(2),i(0)),e=i(5);i.n(e);const o=1e3;class s extends a.a{constructor(t){super(),this.path=[],this.currIndex=0,this.lastVx=0,this.lastVy=0,this.renderSystem=t,this.path.length=o}update(t,n){const i=t.position[0],a=t.position[1],e=t.velocity[0],s=t.velocity[1],r=(e-this.lastVx)/n,u=(s-this.lastVy)/n,c=this.path,h=(this.currIndex-2+o)%o,l=Math.abs(c[h]-i),f=Math.abs(c[h+1]-a);(l>100||f>100)&&(c[this.currIndex]=NaN,c[this.currIndex+1]=NaN,this.currIndex=(this.currIndex+2)%o),c[this.currIndex]=i,c[this.currIndex+1]=a,this.renderSystem.push(t=>{t.beginPath(),t.moveTo(c[this.currIndex],c[this.currIndex+1]);for(let n=2;n<o;n+=2){let i=(this.currIndex+n)%o;c[i]?t.lineTo(c[i],c[i+1]):(n+=2,i=(this.currIndex+n)%o,t.moveTo(c[i],c[i+1]))}t.strokeStyle="#CCC",t.stroke()}),this.currIndex=(this.currIndex+2)%o,this.renderSystem.strokePath([i,a,i+100*e,a+100*s],"rgba(0,128,255,0.7)",0),this.renderSystem.strokePath([i,a,i+4e5*r,a+4e5*u],"rgba(0,255,0,0.7)",0),this.lastVx=e,this.lastVy=s}}n.a=s},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n){super(),this.renderSystem=t,this.colour=n||"#000"}update(t,n){for(var i,a,e,o=t.surfaces,s=0,r=o.length;s<r;s++)this.renderSystem.strokePath(o[s],t.colour||this.colour);for(s=0;s<r;s++)for(a=t.surfaces[s],e=a.length,i=0;i<e-3;i+=2){var u=a[i],c=a[i+1],h=a[i+2],l=a[i+3],f=h-u,d=l-c,M=u+.5*f,p=c+.5*d,m=d/Math.sqrt(d*d+f*f),S=-f/Math.sqrt(d*d+f*f);this.renderSystem.strokePath([M,p,M+30*m,p+30*S],"#08f")}}}n.a=e},function(t,n,i){"use strict";var a=i(0),e=i(26);class o extends a.a{constructor(t){super(),this.renderSystem=t}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.arc(0,0,e.a.NEIGHBOUR_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#008",n.stroke(),n.beginPath(),n.arc(0,0,e.a.SEPARATION_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#800",n.stroke()})}}n.a=o},function(t,n,i){"use strict";var a=i(0);class e extends a.a{constructor(t,n="10px sans-serif",i="#000"){super(),this.renderSystem=t,this.font=n,this.color=i,this.size=parseInt(n,10)}update(t,n){const i=t.position,a=this.size;this.renderSystem.push(t=>{t.translate(i[0],i[1]),t.strokeStyle="#888",t.lineWidth=2,t.beginPath(),t.moveTo(-a,0),t.lineTo(a,0),t.moveTo(0,-a),t.lineTo(0,a),t.stroke(),t.fillStyle=this.color,t.font=this.font,t.fillText(`${0|i[0]}, ${0|i[1]}`,a/2,-a/2)})}}n.a=e},function(t,n,i){"use strict";var a=i(0),e=i(38),o=i.n(e),s=i(25),r=i.n(s);class u extends a.a{constructor(t,n,i,a,e){super();var o=t.context;this.renderSystem=t,this.vertexBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.STATIC_DRAW),this.vertexBuffer.itemSize=3,this.vertexBuffer.numItems=Math.floor(n.length/this.vertexBuffer.itemSize),this.textureBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.textureBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(i),o.STATIC_DRAW),this.textureBuffer.itemSize=2,this.textureBuffer.numItems=Math.floor(i.length/this.textureBuffer.itemSize),this.vertexNormalBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexNormalBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(a),o.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=Math.floor(a.length/this.vertexNormalBuffer.itemSize),this.vertexIndexBuffer=o.createBuffer(),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),o.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=e.length}update(t,n){var i=this.vertexBuffer,a=this.textureBuffer,e=this.vertexNormalBuffer,s=this.vertexIndexBuffer,u=this.lighting||t.lighting,c=this.renderSystem.shaderProgram,h=this.texture||t.texture;this.renderSystem.push(function(n,l){r.a.translate(l,l,t.position),t.rotation&&t.rotationAxis&&r.a.rotate(l,l,t.rotation,t.rotationAxis);var f=o.a.create();o.a.fromMat4(f,l),o.a.invert(f,f),o.a.transpose(f,f),n.uniformMatrix3fv(c.nMatrixUniform,!1,f),t.size&&r.a.scale(l,l,t.size),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(c.vertexPositionAttribute,i.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,a),n.vertexAttribPointer(c.textureCoordAttribute,a.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,e),n.vertexAttribPointer(c.vertexNormalAttribute,e.itemSize,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,h),n.uniform1i(c.samplerUniform,0),n.uniform1i(c.useLightingUniform,u),u&&(n.uniform3f(c.ambientColorUniform,this.ambientLight,this.ambientLight,this.ambientLight),n.uniform3f(c.pointLightingLocationUniform,0,0,0),n.uniform3f(c.pointLightingColorUniform,this.pointLighting,this.pointLighting,this.pointLighting)),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,s),n.uniformMatrix4fv(c.mvMatrixUniform,!1,l),n.drawElements(n.TRIANGLES,s.numItems,n.UNSIGNED_SHORT,0)})}}n.a=u,u.createCube=function(t){var n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],i=[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],a=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],e=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return new u(t,n,i,a,e)},u.createSphere=function(t,n,i){var a,e,o,s,r,c,h,l,f,d,M,p,m,S,v,I,x=[],D=[],F=[];for(a=0;a<=n;a++)for(e=a*Math.PI/n,o=Math.sin(e),s=Math.cos(e),r=0;r<=i;r++)c=2*r*Math.PI/i,h=Math.sin(c),l=Math.cos(c),f=l*o,d=s,M=h*o,p=1-r/i,m=1-a/n,D.push(f),D.push(d),D.push(M),F.push(p),F.push(m),x.push(f),x.push(d),x.push(M);for(S=[],a=0;a<n;a++)for(r=0;r<i;r++)v=a*(i+1)+r,I=v+i+1,S.push(v),S.push(I),S.push(v+1),S.push(I),S.push(I+1),S.push(v+1);return new u(t,x,F,x,S)}},function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=i(2);i.d(n,"GameObject",function(){return a.a});var e=i(13);i.d(n,"GameObjectManager",function(){return e.a});var o=i(0);i.d(n,"GameComponent",function(){return o.a});var s=i(11);i.d(n,"CameraSystem",function(){return s.a});var r=i(7);i.d(n,"CanvasRenderSystem",function(){return r.a});var u=i(8);i.d(n,"WorldSystem",function(){return u.a});var c=i(6);i.d(n,"InputSystem",function(){return c.a});var h=i(28);i.d(n,"AudioSystem",function(){return h.a});var l=i(29);i.d(n,"Game",function(){return l.a});var f=i(31),d=i(30),M=i(9);i.d(n,"Easing",function(){return M});var p=i(36);i.d(n,"World",function(){return p});var m=i(15),S=i(16),v=i(34);i.d(n,"Input",function(){return v});var I=i(20),x=i(14),D=i(32);i.d(n,"Collision",function(){return D});var F=i(18),b=i(17),y=i(12),g=i(19),w=i(35);i.d(n,"Render",function(){return w});var A=i(24);i.d(n,"WebGLRenderSystem",function(){return A.a});var E=i(21),R=i(22),_=i(23),P=i(33);i.d(n,"Debug",function(){return P});const z={};n.Components=z;for(let T in f)z[T]=f[T];for(let T in d)z[T]=d[T];z.WorldBounceComponent=m.a,z.WorldWrapComponent=S.a,z.ClickComponent=I.a,z.MoveToClickComponent=x.a,z.CollisionComponent=F.a,z.BounceComponent=b.a,z.BackgroundCollisionComponent=y.a,z.SolidComponent=g.a,z.DotRenderComponent=E.a,z.RectangleRenderComponent=R.a,z.TextRenderComponent=_.a}])});
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.IGE=n():t.IGE=n()}(this,function(){return function(t){function n(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var a={};return n.m=t,n.c=a,n.i=function(t){return t},n.d=function(t,a,e){n.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(a,"a",a),a},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=50)}([function(t,n,a){"use strict";var e=a(1);class i extends e.a{init(t){}update(t,n){}toHTML(){return this.name}}i.create=function(t,n){t.prototype=new i;for(var a in n)t.prototype[a]=n[a];var e=t.name;return e||(e=t.toString().match(/^function ([a-z_]+)/i)[1],t.name=e),t},n.a=i},function(t,n,a){"use strict";function e(t,n){var a=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,a)}function i(t){return t instanceof Function}var o=a(2),s=a.n(o),r=a(9);class u{constructor(){this.components=[],this.components.remove=e,this.position=s.a.create(),this.velocity=s.a.create(),this.rotation=0,this.rotationAxis=s.a.fromValues(0,0,1),this._toBeRemoved=[]}addComponent(t){return i(t)&&(t={update:t}),this.components.push(t),t.init&&t.init(this),this}removeComponent(t){return this._toBeRemoved.push(t),this}removeComponentByName(t){for(var n=0;n<this.components.length;n++){const a=this.components[n];a.name!=t&&a.constructor.name!=t||this._toBeRemoved.push(a)}return this}removeComponentByTest(t){for(var n=0;n<this.components.length;n++)t(this.components[n])&&this._toBeRemoved.push(this.components[n]);return this}setPosition(t,n,a){return void 0==t&&(t=this.position[0]),void 0==n&&(n=this.position[1]),void 0==a&&(a=this.position[2]),s.a.set(this.position,t,n,a),this}setVelocity(t,n,a){return void 0==t&&(t=this.velocity[0]),void 0==n&&(n=this.velocity[1]),void 0==a&&(a=this.velocity[2]),s.a.set(this.velocity,t,n,a),this}setBounds(...t){return this.bounds=t,this}setRotation(t,n){return this.rotation=t,n&&3==n.length&&s.a.normalize(this.rotationAxis,n),this}hit(t){null==this.hitVictim&&(this.hitVictim=t)}hitBy(t){null==this.attackerHit&&(this.attackerHit=t)}update(t){for(var n=0,a=this.components.length,e=0,i=this._toBeRemoved.length;e<i;e++)for(n=0;n<a;n++)if(this.components[n]==this._toBeRemoved[e]){this.components.remove(n);break}for(this._toBeRemoved.length=0,a=this.components.length,n=0;n<a;n++)this.components[n].update(this,t)}toHTML(){var t,n=this.name;if("number"==typeof this.position.x&&(n+=" "+this.position),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}return n}}n.a=u,a.i(r.b)(u)},function(t,n,a){var e=a(3),i={};i.create=function(){var t=new e.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var n=new e.ARRAY_TYPE(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},i.fromValues=function(t,n,a){var i=new e.ARRAY_TYPE(3);return i[0]=t,i[1]=n,i[2]=a,i},i.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},i.set=function(t,n,a,e){return t[0]=n,t[1]=a,t[2]=e,t},i.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t},i.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t},i.sub=i.subtract,i.multiply=function(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t},i.mul=i.multiply,i.divide=function(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t},i.div=i.divide,i.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},i.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},i.min=function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t},i.max=function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t},i.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},i.scale=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t},i.scaleAndAdd=function(t,n,a,e){return t[0]=n[0]+a[0]*e,t[1]=n[1]+a[1]*e,t[2]=n[2]+a[2]*e,t},i.distance=function(t,n){var a=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(a*a+e*e+i*i)},i.dist=i.distance,i.squaredDistance=function(t,n){var a=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return a*a+e*e+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var n=t[0],a=t[1],e=t[2];return Math.sqrt(n*n+a*a+e*e)},i.len=i.length,i.squaredLength=function(t){var n=t[0],a=t[1],e=t[2];return n*n+a*a+e*e},i.sqrLen=i.squaredLength,i.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},i.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},i.normalize=function(t,n){var a=n[0],e=n[1],i=n[2],o=a*a+e*e+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t},i.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},i.cross=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=a[0],r=a[1],u=a[2];return t[0]=i*u-o*r,t[1]=o*s-e*u,t[2]=e*r-i*s,t},i.lerp=function(t,n,a,e){var i=n[0],o=n[1],s=n[2];return t[0]=i+e*(a[0]-i),t[1]=o+e*(a[1]-o),t[2]=s+e*(a[2]-s),t},i.hermite=function(t,n,a,e,i,o){var s=o*o,r=s*(2*o-3)+1,u=s*(o-2)+o,h=s*(o-1),c=s*(3-2*o);return t[0]=n[0]*r+a[0]*u+e[0]*h+i[0]*c,t[1]=n[1]*r+a[1]*u+e[1]*h+i[1]*c,t[2]=n[2]*r+a[2]*u+e[2]*h+i[2]*c,t},i.bezier=function(t,n,a,e,i,o){var s=1-o,r=s*s,u=o*o,h=r*s,c=3*o*r,l=3*u*s,f=u*o;return t[0]=n[0]*h+a[0]*c+e[0]*l+i[0]*f,t[1]=n[1]*h+a[1]*c+e[1]*l+i[1]*f,t[2]=n[2]*h+a[2]*c+e[2]*l+i[2]*f,t},i.random=function(t,n){n=n||1;var a=2*e.RANDOM()*Math.PI,i=2*e.RANDOM()-1,o=Math.sqrt(1-i*i)*n;return t[0]=Math.cos(a)*o,t[1]=Math.sin(a)*o,t[2]=i*n,t},i.transformMat4=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=a[3]*e+a[7]*i+a[11]*o+a[15];return s=s||1,t[0]=(a[0]*e+a[4]*i+a[8]*o+a[12])/s,t[1]=(a[1]*e+a[5]*i+a[9]*o+a[13])/s,t[2]=(a[2]*e+a[6]*i+a[10]*o+a[14])/s,t},i.transformMat3=function(t,n,a){var e=n[0],i=n[1],o=n[2];return t[0]=e*a[0]+i*a[3]+o*a[6],t[1]=e*a[1]+i*a[4]+o*a[7],t[2]=e*a[2]+i*a[5]+o*a[8],t},i.transformQuat=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=a[0],r=a[1],u=a[2],h=a[3],c=h*e+r*o-u*i,l=h*i+u*e-s*o,f=h*o+s*i-r*e,d=-s*e-r*i-u*o;return t[0]=c*h+d*-s+l*-u-f*-r,t[1]=l*h+d*-r+f*-s-c*-u,t[2]=f*h+d*-u+c*-r-l*-s,t},i.rotateX=function(t,n,a,e){var i=[],o=[];return i[0]=n[0]-a[0],i[1]=n[1]-a[1],i[2]=n[2]-a[2],o[0]=i[0],o[1]=i[1]*Math.cos(e)-i[2]*Math.sin(e),o[2]=i[1]*Math.sin(e)+i[2]*Math.cos(e),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},i.rotateY=function(t,n,a,e){var i=[],o=[];return i[0]=n[0]-a[0],i[1]=n[1]-a[1],i[2]=n[2]-a[2],o[0]=i[2]*Math.sin(e)+i[0]*Math.cos(e),o[1]=i[1],o[2]=i[2]*Math.cos(e)-i[0]*Math.sin(e),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},i.rotateZ=function(t,n,a,e){var i=[],o=[];return i[0]=n[0]-a[0],i[1]=n[1]-a[1],i[2]=n[2]-a[2],o[0]=i[0]*Math.cos(e)-i[1]*Math.sin(e),o[1]=i[0]*Math.sin(e)+i[1]*Math.cos(e),o[2]=i[2],t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},i.forEach=function(){var t=i.create();return function(n,a,e,i,o,s){var r,u;for(a||(a=3),e||(e=0),u=i?Math.min(i*a+e,n.length):n.length,r=e;r<u;r+=a)t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],o(t,t,s),n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2];return n}}(),i.angle=function(t,n){var a=i.fromValues(t[0],t[1],t[2]),e=i.fromValues(n[0],n[1],n[2]);i.normalize(a,a),i.normalize(e,e);var o=i.dot(a,e);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},i.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},i.equals=function(t,n){var a=t[0],i=t[1],o=t[2],s=n[0],r=n[1],u=n[2];return Math.abs(a-s)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-r)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(o-u)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},t.exports=i},function(t,n){var a={};a.EPSILON=1e-6,a.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,a.RANDOM=Math.random,a.ENABLE_SIMD=!1,a.SIMD_AVAILABLE=a.ARRAY_TYPE===Float32Array&&"SIMD"in this,a.USE_SIMD=a.ENABLE_SIMD&&a.SIMD_AVAILABLE,a.setMatrixArrayType=function(t){a.ARRAY_TYPE=t};var e=Math.PI/180;a.toRadian=function(t){return t*e},a.equals=function(t,n){return Math.abs(t-n)<=a.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))},t.exports=a},function(t,n,a){"use strict";var e=a(0),i=a(11);class o extends e.a{constructor(t,n,a,e=1e3,o=i["Linear"]){super(),this.outputter=t,this.start=n,this.end=a,this.duration=e,this.easing=o,this.elapsed=0,this.direction=1,this.out=[]}update(t,n){const a=this.easing(this.elapsed/this.duration),e=this.start[0],i=this.start[1],o=this.start[2],s=this.start[3];this.out[0]=e+a*(this.end[0]-e),this.out[1]=i+a*(this.end[1]-i),this.out[2]=o+a*(this.end[2]-o),this.out[3]=s+a*(this.end[3]-s),this.outputter(t,this.out),this.elapsed+=n*this.direction,(this.elapsed>this.duration||this.elapsed<0)&&(this.direction*=-1,this.elapsed=Math.min(Math.max(this.elapsed,0),this.duration))}}n.a=o},function(t,n,a){"use strict";function e(){this.screen&&o(this.screen,t=>{const n=this.screen.offsetLeft,a=this.screen.offsetTop,e=t.touches&&t.touches[0],i=(e?e.pageX:t.pageX)-n,o=(e?e.pageY:t.pageY)-a;u.a.copy(this._nextClick,this.screenToWorld(i,o))})}function i(){this.keyboard&&this.keyboard.addEventListener("keydown",t=>{this._nextKey=t.which})}function o(t,n){const a=function(t){return t.stopPropagation(),t.preventDefault(),t.handled!==!0&&(n(t),void(t.handled=!0))};t.removeEventListener("touchstart",t.touchClick),t.removeEventListener("click",t.touchClick),t.addEventListener("touchstart",a),t.addEventListener("click",a),t.touchClick=a}var s=a(1),r=a(8),u=a.n(r),h=a(34),c=a.n(h);const l=u.a.create(),f=c.a.create();class d extends s.a{constructor(t,n,a){super(),this.screen=t,this.keyboard=n,this.camera=a,this.cameraSystem=a,this._nextClick=u.a.create(),this.lastClick=u.a.create(),this.hasClick=!1,this._nextKey=null,this.lastKey=null,e.call(this),i.call(this)}update(t){super.update(t),u.a.copy(this.lastClick,this._nextClick),u.a.set(this._nextClick,NaN,NaN),this.hasClick=!isNaN(this.lastClick[0]),this.lastKey=this._nextKey,this._nextKey=null}setScreen(t){this.screen=t,e.call(this)}screenToWorld(t,n){const a=this.camera,e=a.width,i=(a.height,this.screen),o=i.offsetWidth,s=i.offsetHeight,r=e/o;return u.a.set(l,t-o/2,n-s/2),u.a.scale(l,l,r),u.a.set(l,l[0]/a.scaleX,l[1]/a.scaleY),1==a.rotationAxis[2]&&(c.a.rotate(f,f,-a.rotation),u.a.transformMat2(l,l,f)),u.a.add(l,l,a.position),l}}n.a=d,d.Keys={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90}},function(t,n,a){"use strict";function e(t,n){const{context,renderQueue}=t,a=renderQueue[n];if(a){for(let n=0,e=a.length;n<e;n++)context.save(),a[n].call(t,context),context.restore();a.length=0}}var i=a(1);a(0);class o extends i.a{constructor(t,n){super(),this.context=t,this.canvas=t&&t.canvas,this.camera=n,this.cameraSystem=n,this.renderQueue=[],this.clearScreen=!0}push(t,n){n=void 0==n?1:n,this.renderQueue[n]||(this.renderQueue[n]=[]),this.renderQueue[n].push(t)}update(t){this.clearScreen&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save();var n,a,i=this.camera.position,o=this.canvas.width/2,s=this.canvas.height/2;for(this.context.translate(o,s),this.context.scale(this.camera.scaleX,this.camera.scaleY),1==this.camera.rotationAxis[2]&&this.context.rotate(-this.camera.rotation),this.context.translate(-i[0],-i[1]),n=0,a=this.renderQueue.length;n<a;n++)e(this,n);this.context.restore(),e(this,-1)}drawPath(t,n){var a=2,e=n.length;for(t.beginPath(),t.moveTo(n[0],n[1]);a<e-1;a+=2)t.lineTo(n[a],n[a+1])}strokePath(t,n,a){"undefined"==typeof n&&(n="#000"),"undefined"==typeof a&&(a=1),this.push(function(a){a.strokeStyle=n,this.drawPath(a,t),a.stroke()},a)}}n.a=o},function(t,n,a){"use strict";var e=a(1);class i extends e.a{constructor(t){super(),this.bounds=t}}n.a=i},function(t,n,a){var e=a(3),i={};i.create=function(){var t=new e.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var n=new e.ARRAY_TYPE(2);return n[0]=t[0],n[1]=t[1],n},i.fromValues=function(t,n){var a=new e.ARRAY_TYPE(2);return a[0]=t,a[1]=n,a},i.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},i.set=function(t,n,a){return t[0]=n,t[1]=a,t},i.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t},i.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t},i.sub=i.subtract,i.multiply=function(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t},i.mul=i.multiply,i.divide=function(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t},i.div=i.divide,i.ceil=function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},i.floor=function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},i.min=function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t},i.max=function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t},i.round=function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},i.scale=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t},i.scaleAndAdd=function(t,n,a,e){return t[0]=n[0]+a[0]*e,t[1]=n[1]+a[1]*e,t},i.distance=function(t,n){var a=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(a*a+e*e)},i.dist=i.distance,i.squaredDistance=function(t,n){var a=n[0]-t[0],e=n[1]-t[1];return a*a+e*e},i.sqrDist=i.squaredDistance,i.length=function(t){var n=t[0],a=t[1];return Math.sqrt(n*n+a*a)},i.len=i.length,i.squaredLength=function(t){var n=t[0],a=t[1];return n*n+a*a},i.sqrLen=i.squaredLength,i.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},i.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},i.normalize=function(t,n){var a=n[0],e=n[1],i=a*a+e*e;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i),t},i.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},i.cross=function(t,n,a){var e=n[0]*a[1]-n[1]*a[0];return t[0]=t[1]=0,t[2]=e,t},i.lerp=function(t,n,a,e){var i=n[0],o=n[1];return t[0]=i+e*(a[0]-i),t[1]=o+e*(a[1]-o),t},i.random=function(t,n){n=n||1;var a=2*e.RANDOM()*Math.PI;return t[0]=Math.cos(a)*n,t[1]=Math.sin(a)*n,t},i.transformMat2=function(t,n,a){var e=n[0],i=n[1];return t[0]=a[0]*e+a[2]*i,t[1]=a[1]*e+a[3]*i,t},i.transformMat2d=function(t,n,a){var e=n[0],i=n[1];return t[0]=a[0]*e+a[2]*i+a[4],t[1]=a[1]*e+a[3]*i+a[5],t},i.transformMat3=function(t,n,a){var e=n[0],i=n[1];return t[0]=a[0]*e+a[3]*i+a[6],t[1]=a[1]*e+a[4]*i+a[7],t},i.transformMat4=function(t,n,a){var e=n[0],i=n[1];return t[0]=a[0]*e+a[4]*i+a[12],t[1]=a[1]*e+a[5]*i+a[13],t},i.forEach=function(){var t=i.create();return function(n,a,e,i,o,s){var r,u;for(a||(a=2),e||(e=0),u=i?Math.min(i*a+e,n.length):n.length,r=e;r<u;r+=a)t[0]=n[r],t[1]=n[r+1],o(t,t,s),n[r]=t[0],n[r+1]=t[1];return n}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},i.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]},i.equals=function(t,n){var a=t[0],i=t[1],o=n[0],s=n[1];return Math.abs(a-o)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(i-s)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))},t.exports=i},function(t,n,a){"use strict";function e(t){let n=t.match(o)||t.match(s);if(n){const t=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1];return t.format="hex",t}if(n=t.match(r)){const t=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return t.format="rgb",t}}function i(t){function n(t,n){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),this._events[t].push(n),this}function a(t,...n){this._events||(this._events={});var a=this._events[t];a&&a.length&&a.forEach(t=>{t.apply(this,n)})}t.prototype.on=n,t.prototype.fire=a}n.a=e,n.b=i;const o=/#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i,s=/#([0-9a-f])([0-9a-f])([0-9a-f])/i,r=/rgba?\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(?:,(0(?:.\d+)|1(?:.0)?))?\)/},function(t,n,a){"use strict";var e=a(1),i=a(2),o=a.n(i);class s extends e.a{constructor(){super(),this.pruneList=[],this.suspendedObjects=[],this.skewX=this.skew,this.skeyY=this.skew,this.scaleX=1,this.scaleY=1,this.rotation=0,this.rotationAxis=o.a.create(),o.a.set(this.rotationAxis,0,0,1)}setScale(t,n){n=n||t,this.scaleX=t,this.scaleY=n}setSize(t,n){this.width=t,this.height=n}addManagerForPruning(t){t instanceof GameObjectManager&&this.pruneList.push(t)}getTransformMatrix(){return this.transformMatrix}update(t){super.update(t)}}n.a=s},function(t,n,a){"use strict";function e(t){var n=1.70158;return t*t*((n+1)*t-n)}function i(t){var n=1.70158;return t-=1,t*t*((n+1)*t+n)+1}function o(t){var n=2.5949095;return t*=2,t<1?Math.pow(t,2)*((n+1)*t-n)/2:(t-=2,(Math.pow(t,2)*((n+1)*t+n)+2)/2)}function s(t){if(0==t||1==t)return t;var n=.3,a=n/4;return t-=1,-1*Math.pow(2,10*t)*Math.sin((t-a)*(2*Math.PI)/n)}function r(t){if(0==t||1==t)return t;var n=.3,a=n/4;return Math.pow(2,-10*t)*Math.sin((t-a)*(2*Math.PI)/n)+1}function u(t){if(0==t)return 0;if(t*=2,2==t)return 1;var n=.3*1.5,a=n/4;return t<1?(t-=1,-.5*(Math.pow(2,10*t)*Math.sin((t-a)*(2*Math.PI)/n))):(t-=1,.5*(Math.pow(2,-10*t)*Math.sin((t-a)*(2*Math.PI)/n))+1)}Object.defineProperty(n,"__esModule",{value:!0}),n.BackIn=e,n.BackOut=i,n.BackInOut=o,n.ElasticIn=s,n.ElasticOut=r,n.ElasticInOut=u;const h=t=>t;n.Linear=h;const c=t=>t*t;n.QuadIn=c;const l=t=>-t*(t-2);n.QuadOut=l;const f=t=>1-Math.sqrt(1-t*t);n.CircIn=f;const d=t=>Math.sqrt(1-(t-1)*(t-1));n.CircOut=d;const M=t=>t*t*(3-2*t);n.Smooth=M;const m=t=>-1*Math.cos(t*(Math.PI/2))+1;n.SineIn=m;const p=t=>Math.sin(t*(Math.PI/2));n.SineOut=p;const S=t=>-1*(Math.cos(Math.PI*t)-1)/2;n.SineInOut=S},function(t,n,a){"use strict";function e(t,n){return t[0]*n[1]-t[1]*n[0]}var i=a(0),o=a(8),s=a.n(o);const r=s.a.create(),u=s.a.create(),h=s.a.create(),c=s.a.create(),l=s.a.create(),f=s.a.create(),d=s.a.create(),M=s.a.create(),m=s.a.create();class p extends i.a{constructor(t,n){super(),this.backgroundSystem=t,this.bounds=n,this.coefficientFriction=p.COEFFICIENT_FRICTION,this.coefficientRestitution=p.COEFFICIENT_RESTITUTION}update(t,n){var a,i,o,p,S,v=this.backgroundSystem.surfaces,I=0,x=v.length,D=this.coefficientFriction,b=this.coefficientRestitution,F=t.position[0],y=t.position[1];if(this.lastX&&Math.abs(this.lastX-F)<100&&Math.abs(this.lastY-y)<100)for(;I<x;I++)for(a=v[I],i=a.length,o=0;o<i-3;o+=2)if(s.a.set(c,a[o],a[o+1]),s.a.set(l,a[o+2],a[o+3]),s.a.subtract(l,l,c),s.a.set(f,this.lastX,this.lastY),s.a.subtract(d,t.position,f),s.a.subtract(M,f,c),p=e(M,d)/e(l,d),S=e(M,l)/e(l,d),p>=0&&p<=1&&S>=0&&S<=1){t.position[0]=this.lastX,t.position[1]=this.lastY,s.a.set(u,-l[1],l[0]),s.a.normalize(u,u),s.a.copy(m,t.velocity),s.a.scale(r,u,s.a.dot(u,m)),s.a.subtract(h,m,r),s.a.scale(h,h,D),s.a.scale(r,r,b),s.a.subtract(t.velocity,h,r);break}this.lastX=t.position[0],this.lastY=t.position[1]}}p.COEFFICIENT_FRICTION=.95,p.COEFFICIENT_RESTITUTION=.4,n.a=p},function(t,n,a){"use strict";var e=a(0),i=a(2),o=a.n(i);const s=o.a.create(),r=o.a.create(),u=o.a.create(),h=o.a.create(),c=o.a.create();class l extends e.a{constructor(){super(),this.cRestitution=.9}init(t){t.on("attack",n=>{const a=t.bounds[2]-t.bounds[0],e=t.bounds[3]-t.bounds[1],i=n.bounds[2]-n.bounds[0],l=n.bounds[3]-n.bounds[1],f=(a+e)/2,d=(i+l)/2,M=(f+d)/2,m=o.a.dist(t.position,n.position);if(m<M){o.a.subtract(s,t.position,n.position),o.a.scale(r,s,(M-m)/m);const a=1/(t.mass||1),e=1/(n.mass||1);o.a.scaleAndAdd(t.position,t.position,r,a/(a+e)),o.a.scaleAndAdd(n.position,n.position,r,-e/(a+e)),o.a.subtract(u,t.velocity,n.velocity),o.a.normalize(h,r);const i=o.a.dot(u,h);if(i>0)return;const l=-(1+this.cRestitution)*i/(a+e);o.a.scale(c,h,l),o.a.scaleAndAdd(t.velocity,t.velocity,c,a),o.a.scaleAndAdd(n.velocity,n.velocity,c,-e)}})}}n.a=l},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n,a){super(),this.collisionSystem=t,this.attack=n,this.vulnerable=a}update(t,n){this.attack&&this.collisionSystem.addAttackObject(t),this.vulnerable&&this.collisionSystem.addVulnerableObject(t)}}n.a=i},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n){super(),this.backgroundSystem=t,this.segments=n}update(t,n){for(var a,e,i,o,s=[],r=0,u=this.segments.length;r<u;r++){for(i=this.segments[r],e=i.length-1,o=[],a=0;a<e;a+=2)o.push(i[a]+t.position.x,i[a+1]+t.position.y);s.push(o)}this.backgroundSystem.addTemporarySurfaces(s)}}n.a=i},function(t,n,a){"use strict";function e(t,n){var a=this.slice((n||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,a)}var i=a(1);class o extends i.a{constructor(){super(),this.objects=[],this._objectsToBeRemoved=[],this.objects.remove=e}addObject(t){return t instanceof i.a&&this.objects.push(t),t.parent=this,this}addObjectAt(t,n){return t instanceof i.a&&this.objects.splice(n,0,t),t.parent=this,this}removeObject(t){return t instanceof i.a&&this._objectsToBeRemoved.push(t),t.parent==this&&(t.parent=null),this}removeAll(){this.objects.length=0}update(t){super.update(t);var n,a=0,e=this.objects.length,i=0;for(a=0;a<e;a++)this.objects[a].update(t);for(n=this._objectsToBeRemoved.length;i<n;i++)for(a=0;a<e;a++)if(this.objects[a]==this._objectsToBeRemoved[i]){this.objects.remove(a),e--;break}this._objectsToBeRemoved.length=0}toHTML(){var t,n=this.name;if(this.objects.length>1&&(n+=" ("+this.objects.length+" items)"),this.components.length){for(n+="<ul>",t=0;t<this.components.length;t++)n+="<li>"+this.components[t].toHTML();n+="</ul>"}if(this.objects.length){for(n+="<ul>",t=0;t<this.objects.length;t++)n+="<li>"+this.objects[t].toHTML();n+="</ul>"}return n}}n.a=o},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t){super(),this.inputSystem=t}update(t,n){if(t.bounds&&this.inputSystem.hasClick){const n=this.inputSystem.lastClick,a=t.position,e=t.bounds;e[0]+a[0]<n[0]&&e[1]+a[1]<n[1]&&e[2]+a[0]>n[0]&&e[3]+a[1]>n[1]&&this.fire("click",t)}}}n.a=i},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const a=t.bounds,e=t.position,i=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(e[0],e[1]),a?t.scale(a[2]-a[0],a[3]-a[1]):i&&t.scale(i,i),t.arc(0,0,.5,0,2*Math.PI,!1),t.fill()})}}n.a=i},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n="#000"){super(),this.renderSystem=t,this.color=n}update(t,n){const a=t.bounds,e=t.position,i=t.size,o=t.color||t.colour||this.color;this.renderSystem.push(t=>{t.beginPath(),t.fillStyle=o,t.translate(e[0],e[1]),a?t.rect(a[0],a[1],a[2]-a[0],a[3]-a[1]):i&&t.rect(-i/2,-i/2,i,i),t.fill()})}}n.a=i},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n,a,e,i="10px sans-serif",o="#000"){super(),this.renderSystem=t,this.text=n,this.font=i,this.color=o,this.setPosition(a,e)}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.translate(this.position[0],this.position[1]),n.fillStyle=this.color,n.font=this.font,n.fillText(this.text,0,0)})}}n.a=i},function(t,n,a){"use strict";var e=a(1),i=a(2),o=a.n(i),s=a(24),r=a.n(s);class u extends e.a{constructor(t,n,a,e,i){super(),this.context=t,this.canvasWidth=n,this.canvasHeight=a,this.cameraSystem=e,this.shaderProgram=i,this.mvMatrix=r.a.create(),this.pMatrix=r.a.create(),this.renderQueue=[],this.spareVector=o.a.create(),this.ambientLight=.3,this.pointLighting=1.4}push(t){this.renderQueue.push(t)}update(t){var n,a,e=this.context,i=this.cameraSystem;for(e.viewport(0,0,e.viewportWidth,e.viewportHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),r.a.perspective(this.pMatrix,45*Math.PI/180,e.viewportWidth/e.viewportHeight,.1,1e4),r.a.translate(this.pMatrix,this.pMatrix,o.a.negate(this.spareVector,i.position)),i.rotation&&i.rotationAxis&&r.a.rotate(this.pMatrix,this.pMatrix,i.rotation,i.rotationAxis),e.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),n=0,a=this.renderQueue.length;n<a;n++)r.a.identity(this.mvMatrix),this.renderQueue[n].call(this,this.context,this.mvMatrix);this.renderQueue.length=0}setCanvasSize(t,n){this.canvasWidth=t,this.canvasHeight=n}}n.a=u},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n,a,e){super(),this.worldSystem=t,this.ax=(n||0)/2,this.ay=(a||0)/2,this.az=(e||0)/2,this.cRestitution=1,this.cFriction=1}update(t,n){var a=this.cRestitution,e=this.cFriction;t.bounds?(this.bx1=this.worldSystem.bounds[0]-t.bounds[0],this.by1=this.worldSystem.bounds[1]-t.bounds[1],this.bx2=this.worldSystem.bounds[2]-t.bounds[2],this.by2=this.worldSystem.bounds[3]-t.bounds[3],this.bz1=this.worldSystem.bounds[4]-t.bounds[4],this.bz2=this.worldSystem.bounds[5]-t.bounds[5]):(this.bx1=this.worldSystem.bounds[0]+this.ax,this.by1=this.worldSystem.bounds[1]+this.ay,this.bx2=this.worldSystem.bounds[2]-this.ax,this.by2=this.worldSystem.bounds[3]-this.ay,this.bz1=this.worldSystem.bounds[4]+this.az,this.bz2=this.worldSystem.bounds[5]-this.az),t.hasBounced=!1,t.position[0]<this.bx1?(t.position[0]=this.bx1,t.velocity[0]=-t.velocity[0]*a,t.velocity[1]=t.velocity[1]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=1):t.position[0]>this.bx2&&(t.position[0]=this.bx2,t.velocity[0]=-t.velocity[0]*a,t.velocity[1]=t.velocity[1]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=1),t.position[1]<this.by1?(t.position[1]=this.by1,t.velocity[1]=-t.velocity[1]*a,t.velocity[0]=t.velocity[0]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=2):t.position[1]>this.by2&&(t.position[1]=this.by2,t.velocity[1]=-t.velocity[1]*a,t.velocity[0]=t.velocity[0]*e,t.velocity[2]=t.velocity[2]*e,t.hasBounced=2),t.position[2]<this.bz1?(t.position[2]=this.bz1,t.velocity[2]=-t.velocity[2]*a,t.velocity[0]=t.velocity[0]*e,t.velocity[1]=t.velocity[1]*e,t.hasBounced=3):t.position[2]>this.bz2&&(t.position[2]=this.bz2,t.velocity[2]=-t.velocity[2]*a,t.velocity[0]=t.velocity[0]*e,t.velocity[1]=t.velocity[1]*e,t.hasBounced=3)}}n.a=i},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t){super(),this.worldSystem=t}update(t,n){this.ax=this.worldSystem.bounds[0],this.ay=this.worldSystem.bounds[1],this.bx=this.worldSystem.bounds[2],this.by=this.worldSystem.bounds[3],this.az=this.worldSystem.bounds[4],this.bz=this.worldSystem.bounds[5],t.position[0]<this.ax&&t.velocity[0]<0?(t.position[0]=this.bx,this.fire("wrap",t)):t.position[0]>this.bx&&t.velocity[0]>0&&(t.position[0]=this.ax,this.fire("wrap",t)),t.position[1]<this.ay&&t.velocity[1]<0?(t.position[1]=this.by,this.fire("wrap",t)):t.position[1]>this.by&&t.velocity[1]>0&&(t.position[1]=this.ay,this.fire("wrap",t)),t.position[2]<this.az&&t.velocity[2]<0?(t.position[2]=this.bz,this.fire("wrap",t)):t.position[2]>this.bz&&t.velocity[2]>0&&(t.position[2]=this.az,this.fire("wrap",t))}}n.a=i},function(t,n,a){var e=a(3),i={scalar:{},SIMD:{}};i.create=function(){var t=new e.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var n=new e.ARRAY_TYPE(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},i.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},i.fromValues=function(t,n,a,i,o,s,r,u,h,c,l,f,d,M,m,p){var S=new e.ARRAY_TYPE(16);return S[0]=t,S[1]=n,S[2]=a,S[3]=i,S[4]=o,S[5]=s,S[6]=r,S[7]=u,S[8]=h,S[9]=c,S[10]=l,S[11]=f,S[12]=d,S[13]=M,S[14]=m,S[15]=p,S},i.set=function(t,n,a,e,i,o,s,r,u,h,c,l,f,d,M,m,p){return t[0]=n,t[1]=a,t[2]=e,t[3]=i,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=h,t[9]=c,t[10]=l,t[11]=f,t[12]=d,t[13]=M,t[14]=m,t[15]=p,t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.scalar.transpose=function(t,n){if(t===n){var a=n[1],e=n[2],i=n[3],o=n[6],s=n[7],r=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=a,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=o,t[11]=n[14],t[12]=i,t[13]=s,t[14]=r}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},i.SIMD.transpose=function(t,n){var a,e,i,o,s,r,u,h,c,l;return a=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),i=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12),s=SIMD.Float32x4.shuffle(a,e,0,1,4,5),r=SIMD.Float32x4.shuffle(i,o,0,1,4,5),u=SIMD.Float32x4.shuffle(s,r,0,2,4,6),h=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,h),s=SIMD.Float32x4.shuffle(a,e,2,3,6,7),r=SIMD.Float32x4.shuffle(i,o,2,3,6,7),c=SIMD.Float32x4.shuffle(s,r,0,2,4,6),l=SIMD.Float32x4.shuffle(s,r,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,l),t},i.transpose=e.USE_SIMD?i.SIMD.transpose:i.scalar.transpose,i.scalar.invert=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],d=n[11],M=n[12],m=n[13],p=n[14],S=n[15],v=a*r-e*s,I=a*u-i*s,x=a*h-o*s,D=e*u-i*r,b=e*h-o*r,F=i*h-o*u,y=c*m-l*M,g=c*p-f*M,w=c*S-d*M,A=l*p-f*m,E=l*S-d*m,z=f*S-d*p,R=v*z-I*E+x*A+D*w-b*g+F*y;return R?(R=1/R,t[0]=(r*z-u*E+h*A)*R,t[1]=(i*E-e*z-o*A)*R,t[2]=(m*F-p*b+S*D)*R,t[3]=(f*b-l*F-d*D)*R,t[4]=(u*w-s*z-h*g)*R,t[5]=(a*z-i*w+o*g)*R,t[6]=(p*x-M*F-S*I)*R,t[7]=(c*F-f*x+d*I)*R,t[8]=(s*E-r*w+h*y)*R,t[9]=(e*w-a*E-o*y)*R,t[10]=(M*b-m*x+S*v)*R,t[11]=(l*x-c*b-d*v)*R,t[12]=(r*g-s*A-u*y)*R,t[13]=(a*A-e*g+i*y)*R,t[14]=(m*I-M*D-p*v)*R,t[15]=(c*D-l*I+f*v)*R,t):null},i.SIMD.invert=function(t,n){var a,e,i,o,s,r,u,h,c,l,f=SIMD.Float32x4.load(n,0),d=SIMD.Float32x4.load(n,4),M=SIMD.Float32x4.load(n,8),m=SIMD.Float32x4.load(n,12);return s=SIMD.Float32x4.shuffle(f,d,0,1,4,5),e=SIMD.Float32x4.shuffle(M,m,0,1,4,5),a=SIMD.Float32x4.shuffle(s,e,0,2,4,6),e=SIMD.Float32x4.shuffle(e,s,1,3,5,7),s=SIMD.Float32x4.shuffle(f,d,2,3,6,7),o=SIMD.Float32x4.shuffle(M,m,2,3,6,7),i=SIMD.Float32x4.shuffle(s,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,s,1,3,5,7),s=SIMD.Float32x4.mul(i,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.mul(e,s),u=SIMD.Float32x4.mul(a,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,s),r),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(e,i),s=SIMD.Float32x4.swizzle(s,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),r),c=SIMD.Float32x4.mul(a,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(o,s)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),r),h=SIMD.Float32x4.mul(a,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(i,s)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,s),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),s=SIMD.Float32x4.mul(a,e),s=SIMD.Float32x4.swizzle(s,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),h),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),c),s=SIMD.Float32x4.swizzle(s,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,s),h),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,s)),s=SIMD.Float32x4.mul(a,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,s)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),h),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,s),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(e,s)),s=SIMD.Float32x4.mul(a,i),s=SIMD.Float32x4.swizzle(s,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(e,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,s)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,s),c),
l=SIMD.Float32x4.mul(a,r),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,2,3,0,1),l),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,1,0,3,2),l),s=SIMD.Float32x4.reciprocalApproximation(l),l=SIMD.Float32x4.sub(SIMD.Float32x4.add(s,s),SIMD.Float32x4.mul(l,SIMD.Float32x4.mul(s,s))),(l=SIMD.Float32x4.swizzle(l,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(l,r)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(l,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(l,h)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(l,c)),t):null},i.invert=e.USE_SIMD?i.SIMD.invert:i.scalar.invert,i.scalar.adjoint=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],d=n[11],M=n[12],m=n[13],p=n[14],S=n[15];return t[0]=r*(f*S-d*p)-l*(u*S-h*p)+m*(u*d-h*f),t[1]=-(e*(f*S-d*p)-l*(i*S-o*p)+m*(i*d-o*f)),t[2]=e*(u*S-h*p)-r*(i*S-o*p)+m*(i*h-o*u),t[3]=-(e*(u*d-h*f)-r*(i*d-o*f)+l*(i*h-o*u)),t[4]=-(s*(f*S-d*p)-c*(u*S-h*p)+M*(u*d-h*f)),t[5]=a*(f*S-d*p)-c*(i*S-o*p)+M*(i*d-o*f),t[6]=-(a*(u*S-h*p)-s*(i*S-o*p)+M*(i*h-o*u)),t[7]=a*(u*d-h*f)-s*(i*d-o*f)+c*(i*h-o*u),t[8]=s*(l*S-d*m)-c*(r*S-h*m)+M*(r*d-h*l),t[9]=-(a*(l*S-d*m)-c*(e*S-o*m)+M*(e*d-o*l)),t[10]=a*(r*S-h*m)-s*(e*S-o*m)+M*(e*h-o*r),t[11]=-(a*(r*d-h*l)-s*(e*d-o*l)+c*(e*h-o*r)),t[12]=-(s*(l*p-f*m)-c*(r*p-u*m)+M*(r*f-u*l)),t[13]=a*(l*p-f*m)-c*(e*p-i*m)+M*(e*f-i*l),t[14]=-(a*(r*p-u*m)-s*(e*p-i*m)+M*(e*u-i*r)),t[15]=a*(r*f-u*l)-s*(e*f-i*l)+c*(e*u-i*r),t},i.SIMD.adjoint=function(t,n){var a,e,i,o,s,r,u,h,c,l,f,d,M,a=SIMD.Float32x4.load(n,0),e=SIMD.Float32x4.load(n,4),i=SIMD.Float32x4.load(n,8),o=SIMD.Float32x4.load(n,12);return c=SIMD.Float32x4.shuffle(a,e,0,1,4,5),r=SIMD.Float32x4.shuffle(i,o,0,1,4,5),s=SIMD.Float32x4.shuffle(c,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,c,1,3,5,7),c=SIMD.Float32x4.shuffle(a,e,2,3,6,7),h=SIMD.Float32x4.shuffle(i,o,2,3,6,7),u=SIMD.Float32x4.shuffle(c,h,0,2,4,6),h=SIMD.Float32x4.shuffle(h,c,1,3,5,7),c=SIMD.Float32x4.mul(u,h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.mul(r,c),f=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,c),l),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(r,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),l),M=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(h,c)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),l),d=SIMD.Float32x4.mul(s,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(s,r),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),d),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),M),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,c),d),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(s,h),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,c)),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,c),f),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(r,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(h,c)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,c),M),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,M),t},i.adjoint=e.USE_SIMD?i.SIMD.adjoint:i.scalar.adjoint,i.determinant=function(t){var n=t[0],a=t[1],e=t[2],i=t[3],o=t[4],s=t[5],r=t[6],u=t[7],h=t[8],c=t[9],l=t[10],f=t[11],d=t[12],M=t[13],m=t[14],p=t[15],S=n*s-a*o,v=n*r-e*o,I=n*u-i*o,x=a*r-e*s,D=a*u-i*s,b=e*u-i*r,F=h*M-c*d,y=h*m-l*d,g=h*p-f*d,w=c*m-l*M,A=c*p-f*M,E=l*p-f*m;return S*E-v*A+I*w+x*g-D*y+b*F},i.SIMD.multiply=function(t,n,a){var e=SIMD.Float32x4.load(n,0),i=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4.load(a,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,3,3,3,3),s))));SIMD.Float32x4.store(t,0,u);var h=SIMD.Float32x4.load(a,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),s))));SIMD.Float32x4.store(t,4,c);var l=SIMD.Float32x4.load(a,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),s))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(a,12),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),s))));return SIMD.Float32x4.store(t,12,M),t},i.scalar.multiply=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=n[9],d=n[10],M=n[11],m=n[12],p=n[13],S=n[14],v=n[15],I=a[0],x=a[1],D=a[2],b=a[3];return t[0]=I*e+x*r+D*l+b*m,t[1]=I*i+x*u+D*f+b*p,t[2]=I*o+x*h+D*d+b*S,t[3]=I*s+x*c+D*M+b*v,I=a[4],x=a[5],D=a[6],b=a[7],t[4]=I*e+x*r+D*l+b*m,t[5]=I*i+x*u+D*f+b*p,t[6]=I*o+x*h+D*d+b*S,t[7]=I*s+x*c+D*M+b*v,I=a[8],x=a[9],D=a[10],b=a[11],t[8]=I*e+x*r+D*l+b*m,t[9]=I*i+x*u+D*f+b*p,t[10]=I*o+x*h+D*d+b*S,t[11]=I*s+x*c+D*M+b*v,I=a[12],x=a[13],D=a[14],b=a[15],t[12]=I*e+x*r+D*l+b*m,t[13]=I*i+x*u+D*f+b*p,t[14]=I*o+x*h+D*d+b*S,t[15]=I*s+x*c+D*M+b*v,t},i.multiply=e.USE_SIMD?i.SIMD.multiply:i.scalar.multiply,i.mul=i.multiply,i.scalar.translate=function(t,n,a){var e,i,o,s,r,u,h,c,l,f,d,M,m=a[0],p=a[1],S=a[2];return n===t?(t[12]=n[0]*m+n[4]*p+n[8]*S+n[12],t[13]=n[1]*m+n[5]*p+n[9]*S+n[13],t[14]=n[2]*m+n[6]*p+n[10]*S+n[14],t[15]=n[3]*m+n[7]*p+n[11]*S+n[15]):(e=n[0],i=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=n[9],d=n[10],M=n[11],t[0]=e,t[1]=i,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=h,t[7]=c,t[8]=l,t[9]=f,t[10]=d,t[11]=M,t[12]=e*m+r*p+l*S+n[12],t[13]=i*m+u*p+f*S+n[13],t[14]=o*m+h*p+d*S+n[14],t[15]=s*m+c*p+M*S+n[15]),t},i.SIMD.translate=function(t,n,a){var e=SIMD.Float32x4.load(n,0),i=SIMD.Float32x4.load(n,4),o=SIMD.Float32x4.load(n,8),s=SIMD.Float32x4.load(n,12),r=SIMD.Float32x4(a[0],a[1],a[2],0);n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11]),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(r,0,0,0,0)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(r,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(r,2,2,2,2));var u=SIMD.Float32x4.add(e,SIMD.Float32x4.add(i,SIMD.Float32x4.add(o,s)));return SIMD.Float32x4.store(t,12,u),t},i.translate=e.USE_SIMD?i.SIMD.translate:i.scalar.translate,i.scalar.scale=function(t,n,a){var e=a[0],i=a[1],o=a[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},i.SIMD.scale=function(t,n,a){var e,i,o,s=SIMD.Float32x4(a[0],a[1],a[2],0);return e=SIMD.Float32x4.load(n,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(s,0,0,0,0))),i=SIMD.Float32x4.load(n,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,1,1,1,1))),o=SIMD.Float32x4.load(n,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2))),t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},i.scale=e.USE_SIMD?i.SIMD.scale:i.scalar.scale,i.rotate=function(t,n,a,i){var o,s,r,u,h,c,l,f,d,M,m,p,S,v,I,x,D,b,F,y,g,w,A,E,z=i[0],R=i[1],_=i[2],P=Math.sqrt(z*z+R*R+_*_);return Math.abs(P)<e.EPSILON?null:(P=1/P,z*=P,R*=P,_*=P,o=Math.sin(a),s=Math.cos(a),r=1-s,u=n[0],h=n[1],c=n[2],l=n[3],f=n[4],d=n[5],M=n[6],m=n[7],p=n[8],S=n[9],v=n[10],I=n[11],x=z*z*r+s,D=R*z*r+_*o,b=_*z*r-R*o,F=z*R*r-_*o,y=R*R*r+s,g=_*R*r+z*o,w=z*_*r+R*o,A=R*_*r-z*o,E=_*_*r+s,t[0]=u*x+f*D+p*b,t[1]=h*x+d*D+S*b,t[2]=c*x+M*D+v*b,t[3]=l*x+m*D+I*b,t[4]=u*F+f*y+p*g,t[5]=h*F+d*y+S*g,t[6]=c*F+M*y+v*g,t[7]=l*F+m*y+I*g,t[8]=u*w+f*A+p*E,t[9]=h*w+d*A+S*E,t[10]=c*w+M*A+v*E,t[11]=l*w+m*A+I*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},i.scalar.rotateX=function(t,n,a){var e=Math.sin(a),i=Math.cos(a),o=n[4],s=n[5],r=n[6],u=n[7],h=n[8],c=n[9],l=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*i+h*e,t[5]=s*i+c*e,t[6]=r*i+l*e,t[7]=u*i+f*e,t[8]=h*i-o*e,t[9]=c*i-s*e,t[10]=l*i-r*e,t[11]=f*i-u*e,t},i.SIMD.rotateX=function(t,n,a){var e=SIMD.Float32x4.splat(Math.sin(a)),i=SIMD.Float32x4.splat(Math.cos(a));n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,4),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(s,e))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,i),SIMD.Float32x4.mul(o,e))),t},i.rotateX=e.USE_SIMD?i.SIMD.rotateX:i.scalar.rotateX,i.scalar.rotateY=function(t,n,a){var e=Math.sin(a),i=Math.cos(a),o=n[0],s=n[1],r=n[2],u=n[3],h=n[8],c=n[9],l=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i-h*e,t[1]=s*i-c*e,t[2]=r*i-l*e,t[3]=u*i-f*e,t[8]=o*e+h*i,t[9]=s*e+c*i,t[10]=r*e+l*i,t[11]=u*e+f*i,t},i.SIMD.rotateY=function(t,n,a){var e=SIMD.Float32x4.splat(Math.sin(a)),i=SIMD.Float32x4.splat(Math.cos(a));n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(s,e))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(s,i))),t},i.rotateY=e.USE_SIMD?i.SIMD.rotateY:i.scalar.rotateY,i.scalar.rotateZ=function(t,n,a){var e=Math.sin(a),i=Math.cos(a),o=n[0],s=n[1],r=n[2],u=n[3],h=n[4],c=n[5],l=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i+h*e,t[1]=s*i+c*e,t[2]=r*i+l*e,t[3]=u*i+f*e,t[4]=h*i-o*e,t[5]=c*i-s*e,t[6]=l*i-r*e,t[7]=f*i-u*e,t},i.SIMD.rotateZ=function(t,n,a){var e=SIMD.Float32x4.splat(Math.sin(a)),i=SIMD.Float32x4.splat(Math.cos(a));n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]);var o=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.load(n,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(s,e))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,i),SIMD.Float32x4.mul(o,e))),t},i.rotateZ=e.USE_SIMD?i.SIMD.rotateZ:i.scalar.rotateZ,i.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,n,a){var i,o,s,r=a[0],u=a[1],h=a[2],c=Math.sqrt(r*r+u*u+h*h);return Math.abs(c)<e.EPSILON?null:(c=1/c,r*=c,u*=c,h*=c,i=Math.sin(n),o=Math.cos(n),s=1-o,t[0]=r*r*s+o,t[1]=u*r*s+h*i,t[2]=h*r*s-u*i,t[3]=0,t[4]=r*u*s-h*i,t[5]=u*u*s+o,t[6]=h*u*s+r*i,t[7]=0,t[8]=r*h*s+u*i,t[9]=u*h*s-r*i,t[10]=h*h*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,n){var a=Math.sin(n),e=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,n){var a=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,n){var a=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=e+e,u=i+i,h=o+o,c=e*r,l=e*u,f=e*h,d=i*u,M=i*h,m=o*h,p=s*r,S=s*u,v=s*h;return t[0]=1-(d+m),t[1]=l+v,t[2]=f-S,t[3]=0,t[4]=l-v,t[5]=1-(c+m),t[6]=M+p,t[7]=0,t[8]=f+S,t[9]=M-p,t[10]=1-(c+d),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},i.getTranslation=function(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t},i.getRotation=function(t,n){var a=n[0]+n[5]+n[10],e=0;return a>0?(e=2*Math.sqrt(a+1),t[3]=.25*e,t[0]=(n[6]-n[9])/e,t[1]=(n[8]-n[2])/e,t[2]=(n[1]-n[4])/e):n[0]>n[5]&n[0]>n[10]?(e=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/e,t[0]=.25*e,t[1]=(n[1]+n[4])/e,t[2]=(n[8]+n[2])/e):n[5]>n[10]?(e=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/e,t[0]=(n[1]+n[4])/e,t[1]=.25*e,t[2]=(n[6]+n[9])/e):(e=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/e,t[0]=(n[8]+n[2])/e,t[1]=(n[6]+n[9])/e,t[2]=.25*e),t},i.fromRotationTranslationScale=function(t,n,a,e){var i=n[0],o=n[1],s=n[2],r=n[3],u=i+i,h=o+o,c=s+s,l=i*u,f=i*h,d=i*c,M=o*h,m=o*c,p=s*c,S=r*u,v=r*h,I=r*c,x=e[0],D=e[1],b=e[2];return t[0]=(1-(M+p))*x,t[1]=(f+I)*x,t[2]=(d-v)*x,t[3]=0,t[4]=(f-I)*D,t[5]=(1-(l+p))*D,t[6]=(m+S)*D,t[7]=0,t[8]=(d+v)*b,t[9]=(m-S)*b,t[10]=(1-(l+M))*b,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,n,a,e,i){var o=n[0],s=n[1],r=n[2],u=n[3],h=o+o,c=s+s,l=r+r,f=o*h,d=o*c,M=o*l,m=s*c,p=s*l,S=r*l,v=u*h,I=u*c,x=u*l,D=e[0],b=e[1],F=e[2],y=i[0],g=i[1],w=i[2];return t[0]=(1-(m+S))*D,t[1]=(d+x)*D,t[2]=(M-I)*D,t[3]=0,t[4]=(d-x)*b,t[5]=(1-(f+S))*b,t[6]=(p+v)*b,t[7]=0,t[8]=(M+I)*F,t[9]=(p-v)*F,t[10]=(1-(f+m))*F,t[11]=0,t[12]=a[0]+y-(t[0]*y+t[4]*g+t[8]*w),t[13]=a[1]+g-(t[1]*y+t[5]*g+t[9]*w),t[14]=a[2]+w-(t[2]*y+t[6]*g+t[10]*w),t[15]=1,t},i.fromQuat=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=a+a,r=e+e,u=i+i,h=a*s,c=e*s,l=e*r,f=i*s,d=i*r,M=i*u,m=o*s,p=o*r,S=o*u;return t[0]=1-l-M,t[1]=c+S,t[2]=f-p,t[3]=0,t[4]=c-S,t[5]=1-h-M,t[6]=d+m,t[7]=0,t[8]=f+p,t[9]=d-m,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,n,a,e,i,o,s){var r=1/(a-n),u=1/(i-e),h=1/(o-s);return t[0]=2*o*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(a+n)*r,t[9]=(i+e)*u,t[10]=(s+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*h,t[15]=0,t},i.perspective=function(t,n,a,e,i){var o=1/Math.tan(n/2),s=1/(e-i);return t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+e)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*e*s,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,n,a,e){var i=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),s=Math.tan(n.leftDegrees*Math.PI/180),r=Math.tan(n.rightDegrees*Math.PI/180),u=2/(s+r),h=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-((s-r)*u*.5),t[9]=(i-o)*h*.5,t[10]=e/(a-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*a/(a-e),t[15]=0,t},i.ortho=function(t,n,a,e,i,o,s){var r=1/(n-a),u=1/(e-i),h=1/(o-s);return t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(n+a)*r,t[13]=(i+e)*u,t[14]=(s+o)*h,t[15]=1,t},i.lookAt=function(t,n,a,o){var s,r,u,h,c,l,f,d,M,m,p=n[0],S=n[1],v=n[2],I=o[0],x=o[1],D=o[2],b=a[0],F=a[1],y=a[2];return Math.abs(p-b)<e.EPSILON&&Math.abs(S-F)<e.EPSILON&&Math.abs(v-y)<e.EPSILON?i.identity(t):(f=p-b,d=S-F,M=v-y,m=1/Math.sqrt(f*f+d*d+M*M),f*=m,d*=m,M*=m,s=x*M-D*d,r=D*f-I*M,u=I*d-x*f,m=Math.sqrt(s*s+r*r+u*u),m?(m=1/m,s*=m,r*=m,u*=m):(s=0,r=0,u=0),h=d*u-M*r,c=M*s-f*u,l=f*r-d*s,m=Math.sqrt(h*h+c*c+l*l),m?(m=1/m,h*=m,c*=m,l*=m):(h=0,c=0,l=0),t[0]=s,t[1]=h,t[2]=f,t[3]=0,t[4]=r,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=l,t[10]=M,t[11]=0,t[12]=-(s*p+r*S+u*v),t[13]=-(h*p+c*S+l*v),t[14]=-(f*p+d*S+M*v),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},i.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t[9]=n[9]+a[9],t[10]=n[10]+a[10],t[11]=n[11]+a[11],t[12]=n[12]+a[12],t[13]=n[13]+a[13],t[14]=n[14]+a[14],t[15]=n[15]+a[15],t},i.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t[9]=n[9]-a[9],t[10]=n[10]-a[10],t[11]=n[11]-a[11],t[12]=n[12]-a[12],t[13]=n[13]-a[13],t[14]=n[14]-a[14],t[15]=n[15]-a[15],t},i.sub=i.subtract,i.multiplyScalar=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12]*a,t[13]=n[13]*a,t[14]=n[14]*a,t[15]=n[15]*a,t},i.multiplyScalarAndAdd=function(t,n,a,e){return t[0]=n[0]+a[0]*e,t[1]=n[1]+a[1]*e,t[2]=n[2]+a[2]*e,t[3]=n[3]+a[3]*e,t[4]=n[4]+a[4]*e,t[5]=n[5]+a[5]*e,t[6]=n[6]+a[6]*e,t[7]=n[7]+a[7]*e,t[8]=n[8]+a[8]*e,t[9]=n[9]+a[9]*e,t[10]=n[10]+a[10]*e,t[11]=n[11]+a[11]*e,t[12]=n[12]+a[12]*e,t[13]=n[13]+a[13]*e,t[14]=n[14]+a[14]*e,t[15]=n[15]+a[15]*e,t},i.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]},i.equals=function(t,n){var a=t[0],i=t[1],o=t[2],s=t[3],r=t[4],u=t[5],h=t[6],c=t[7],l=t[8],f=t[9],d=t[10],M=t[11],m=t[12],p=t[13],S=t[14],v=t[15],I=n[0],x=n[1],D=n[2],b=n[3],F=n[4],y=n[5],g=n[6],w=n[7],A=n[8],E=n[9],z=n[10],R=n[11],_=n[12],P=n[13],C=n[14],T=n[15];return Math.abs(a-I)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(i-x)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-D)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(s-b)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(r-F)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(F))&&Math.abs(u-y)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-g)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(c-w)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(l-A)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-E)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-z)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(M-R)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(m-_)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(_))&&Math.abs(p-P)<=e.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(S-C)<=e.EPSILON*Math.max(1,Math.abs(S),Math.abs(C))&&Math.abs(v-T)<=e.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))},t.exports=i},function(t,n,a){"use strict";var e=a(0),i=a(2),o=a.n(i);const s=o.a.create(),r=o.a.create(),u=o.a.create(),h=o.a.create();class c extends e.a{constructor(t){super(),this.flock=t}update(t,n){o.a.set(u,0,0,0),o.a.set(r,0,0,0),o.a.set(s,0,0,0),o.a.set(h,0,0,0);let a=0;const e=this.flock.length;for(let i=0;i<e;i++){const n=this.flock[i],e=o.a.dist(n.position,t.position);e>0&&e<c.NEIGHBOUR_RADIUS&&(o.a.add(u,u,n.position),o.a.add(r,r,n.velocity),e<c.SEPARATION_RADIUS&&(o.a.subtract(h,t.position,n.position),o.a.normalize(h,h),o.a.scaleAndAdd(s,s,h,1/e)),a++)}if(a>0){o.a.scale(u,u,1/a),o.a.subtract(u,u,t.position),o.a.scaleAndAdd(t.velocity,t.velocity,u,c.COHESION_WEIGHT),o.a.scaleAndAdd(t.velocity,t.velocity,r,c.ALIGN_WEIGHT/a),o.a.scaleAndAdd(t.velocity,t.velocity,s,c.SEPARATION_WEIGHT/a);var l=o.a.length(t.velocity);l>c.MAX_SPEED&&o.a.scale(t.velocity,t.velocity,c.MAX_SPEED/l)}}}n.a=c,c.NEIGHBOUR_RADIUS=200,c.SEPARATION_RADIUS=150,c.MAX_SPEED=.1,c.COHESION_WEIGHT=.1*c.MAX_SPEED/c.NEIGHBOUR_RADIUS,c.ALIGN_WEIGHT=30*c.MAX_SPEED/c.NEIGHBOUR_RADIUS,c.SEPARATION_WEIGHT=100/c.SEPARATION_RADIUS},function(t,n,a){"use strict";var e=a(1);class i extends e.a{constructor(){super()}playSound(t){t.audio&&t.audio.play()}}n.a=i},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=(a(1),a(0)),i=a(2),o=a.n(i),s=a(25);a.d(n,"FlockingComponent",function(){return s.a});var r=a(38);a.d(n,"GravityComponent",function(){return r.a});var u=a(40);a.d(n,"PositionInterpolatorComponent",function(){return u.a});var h=a(41);a.d(n,"SwitchComponent",function(){return h.a});var c=a(4);a.d(n,"PropertyAnimationComponent",function(){return c.a});var l=a(39);a.d(n,"PositionAnimationComponent",function(){return l.a});var f=a(36);a.d(n,"BoundsAnimationComponent",function(){return f.a});var d=a(37);a.d(n,"ColorAnimationComponent",function(){return d.a});class M extends e.a{constructor(t){super(),this.target=t,this.vector=o.a.create()}update(t,n){o.a.subtract(this.vector,this.target.position,t.position);var a=this.target.mass*n/o.a.squaredLength(this.vector);o.a.normalize(this.vector,this.vector),o.a.scaleAndAdd(t.velocity,t.velocity,this.vector,a)}}n.PointGravityComponent=M;class m extends e.a{update(t,n){o.a.scaleAndAdd(t.position,t.position,t.velocity,n)}}n.MoveComponent=m;class p extends e.a{update(t,n){t.impulse&&(o.a.add(t.velocity,t.velocity,t.impulse),o.a.set(t.impulse,0,0,0))}}n.PhysicsComponent=p;class S extends e.a{update(t,n){Math.random()<.001&&o.a.random(t.velocity,Math.random())}}n.RandomMotionComponent=S;class v extends e.a{constructor(t){super(),this.rotationSpeed=t}update(t,n){var a=t.rotationSpeed||this.rotationSpeed||0;t.setRotation(t.rotation+a*n)}}n.RotationComponent=v;class I extends e.a{update(t,n){t.targetRotation=Math.atan2(t.velocity[0],-t.velocity[1])}}n.RotateToHeadingComponent=I;class x extends e.a{update(t,n){var a=t.rotation,e=t.targetRotation,i=e-a,o=.01;i>Math.PI?i-=2*Math.PI:i<-Math.PI&&(i+=2*Math.PI),t.rotation=a+i*n*o}}n.RotationInterpolatorComponent=x;class D extends e.a{constructor(t){super(),this.target=t}update(t,n){this.target&&o.a.copy(t.position,this.target.position)}setTarget(t){this.target=t}}n.FollowComponent=D;class b extends e.a{constructor(t,n){super(),this.target=t,this.distance=n}update(t,n){o.a.add(t.position,this.target.position,this.distance)}}n.FollowAtDistanceComponent=b;class F extends e.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=this.target.rotation+Math.PI}}n.TrackRotationComponent=F;class y extends e.a{constructor(t){super(),this.target=t}update(t,n){t.rotation=-this.target.rotation}}n.CounterRotationComponent=y;class g extends e.a{constructor(t){super(),this.velocityMagnitude=t}update(t,n){const a=o.a.length(t.velocity);if(a>this.velocityMagnitude){const n=this.velocityMagnitude/a;o.a.scale(t.velocity,t.velocity,n)}}}n.TerminalVelocityComponent=g},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(43);a.d(n,"CollisionSystem",function(){return e.a});var i=a(14);a.d(n,"CollisionComponent",function(){return i.a});var o=a(13);a.d(n,"BounceComponent",function(){return o.a});var s=a(42);a.d(n,"BackgroundCollisionSystem",function(){return s.a});var r=a(12);a.d(n,"BackgroundCollisionComponent",function(){return r.a});var u=a(15);a.d(n,"SolidComponent",function(){return u.a})},function(t,n,a){"use strict";function e(t){function n(a){if(a&&t.time==a)return void console.log("Multiple calls: "+a);t.time=a,t.frame++;try{t.root.update(Math.min(a-t._lastTime,100)),t.state==f&&p(n),t._lastTime=a}catch(t){window.console&&console.error(t.stack||t)}}n(t._lastTime)}function i(t,n){t._loaded++,t.fire("resourcesProgress",t._loaded/t._toLoad),t._toLoad-t._loaded<=0&&t.fire("resourcesLoaded")}var o=(a(1),a(16)),s=(a(0),a(10)),r=a(6),u=a(7),h=a(5),c=a(9);const l=0,f=1,d=2,M=3;let m=0;const p="undefined"!=typeof window&&window.requestAnimationFrame||function(t,n){var a=(new Date).getTime(),e=Math.max(0,16-(a-m)),i=setTimeout(function(){t(a+e)},e);return m=a+e,i};class S{constructor(t={}){this.canvas=t.canvas,this.width=t.width||this.canvas&&this.canvas.width||0,this.height=t.height||this.canvas&&this.canvas.height||0,this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.root=new o.a,this.textures=[],this.sounds=[],this.frame=0,this.time=0,this.score=t.score||0,this.lives=t.lives||0,this.level=t.level||0,this._toLoad=0,this._lastTime=0,this._loaded=0,this._autosizeCallback=(()=>{if(this.canvas){const t=this.canvas.offsetWidth,n=this.canvas.offsetHeight;this.setSize(t,n),this.cameraSystem&&this.cameraSystem.setPosition(t/2,n/2),this.worldSystem&&this.worldSystem.setBounds(0,0,t,n)}}),t.autosize&&this.setAutosize(!0)}setCanvas(t){this.canvas=t,this.canvas&&(this.width=this.width||this.canvas.width,this.height=this.height||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height)}loadTextures(t){this._toLoad+=t.length;var n=this;return t.map(function(t){var a={image:new Image,width:0,height:0,loaded:!1};return a.image.onload=function(){a.width=a.image.width,a.height=a.image.height,a.loaded=!0,i(n,a)},a.image.onerror=function(){throw new Error("Failed to load a texture: "+t)},a.image.src=t,n.textures.push(a),a})}loadAudio(t){this._toLoad+=t.length;var n=this;return t.map(function(t){var a={audio:new Audio,length:0,laoded:!1};return a.audio.addEventListener("canplaythrough",()=>{a.loaded||(a.length=a.audio.duration,a.loaded=!0,i(n,a))}),a.audio.onerror=function(){throw new Error("Failed to load a sound: "+t)},a.audio.src=t,n.sounds.push(a),a})}start(){this.nextLevel(),this.state=f,e(this)}stop(){this.state=d}getDefaultCamera(){return this.cameraSystem||(this.cameraSystem=new s.a,this.cameraSystem.setPosition(this.width/2,this.height/2)),this.cameraSystem}getDefaultRenderer(){if(!this.renderSystem){this.cameraSystem||this.getDefaultCamera();let t;this.canvas&&(t=this.canvas.getContext("2d")),this.renderSystem=new r.a(t,this.cameraSystem)}return this.renderSystem}getDefaultWorld(t=0,n=t){const a=[-t,-n,this.width+t,this.height+n];return this.worldSystem?this.worldSystem.setBounds(...a):this.worldSystem=new u.a(a),this.worldSystem}getDefaultInput(){return this.inputSystem||(this.cameraSystem||this.getDefaultCamera(),this.inputSystem=new h.a(this.canvas,"undefined"!=typeof document&&document,this.cameraSystem)),this.inputSystem}setScore(t){this.score=t,this.fire("score",this.score)}nextLevel(){this.level++,this.fire("loadLevel",this.level)}setLevel(t){this.level=t,this.fire("loadLevel",this.level)}completeLevel(){this.fire("levelComplete",this.level)}setSize(t,n){this.width=t,this.height=n,this.canvas&&(this.canvas.width=t,this.canvas.height=n)}setAutosize(t){t?window.addEventListener("resize",this._autosizeCallback):window.removeEventListener("resize",this._autosizeCallback)}}n.a=S,a.i(c.b)(S),S.STATE_PAUSED=l,S.STATE_PLAYING=f,S.STATE_STOPPED=d,S.STATE_DEAD=M},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(44);a.d(n,"DebugDrawBoundsComponent",function(){return e.a});var i=a(45);a.d(n,"DebugDrawPathComponent",function(){return i.a});var o=a(46);a.d(n,"DebugDrawSurfacesComponent",function(){return o.a});var s=a(47);a.d(n,"DebugFlockingComponent",function(){return s.a})},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(5);a.d(n,"InputSystem",function(){return e.a});var i=a(17);a.d(n,"ClickComponent",function(){return i.a})},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(6);a.d(n,"CanvasRenderSystem",function(){return e.a});var i=a(18);a.d(n,"DotRenderComponent",function(){return i.a});var o=a(19);a.d(n,"RectangleRenderComponent",function(){return o.a});var s=a(20);a.d(n,"TextRenderComponent",function(){return s.a});var r=a(21);a.d(n,"WebGLRenderSystem",function(){return r.a});var u=a(48);a.d(n,"PolyShapeRenderComponent",function(){return u.a});var h=a(49);a.d(n,"TileComponent",function(){return h.a}),a.d(n,"SpriteRenderingComponent",function(){return h.b}),a.d(n,"SpriteAnimationComponent",function(){return h.c}),a.d(n,"Sprite",function(){return h.d}),a.d(n,"AnimatedSpriteComponent",function(){return h.e}),a.d(n,"CanvasSpriteRenderingComponent",function(){return h.f})},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(7);a.d(n,"WorldSystem",function(){return e.a});var i=a(22);a.d(n,"WorldBounceComponent",function(){return i.a});var o=a(23);a.d(n,"WorldWrapComponent",function(){return o.a})},function(t,n,a){var e=a(3),i={};i.create=function(){var t=new e.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var n=new e.ARRAY_TYPE(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},i.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.fromValues=function(t,n,a,i){var o=new e.ARRAY_TYPE(4);return o[0]=t,o[1]=n,o[2]=a,o[3]=i,o},i.set=function(t,n,a,e,i){return t[0]=n,t[1]=a,t[2]=e,t[3]=i,t},i.transpose=function(t,n){if(t===n){var a=n[1];t[1]=n[2],t[2]=a}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},i.invert=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=a*o-i*e;return s?(s=1/s,t[0]=o*s,t[1]=-e*s,t[2]=-i*s,t[3]=a*s,t):null},i.adjoint=function(t,n){var a=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=a,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=a[0],u=a[1],h=a[2],c=a[3];return t[0]=e*r+o*u,t[1]=i*r+s*u,t[2]=e*h+o*c,t[3]=i*h+s*c,t},i.mul=i.multiply,i.rotate=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=Math.sin(a),u=Math.cos(a);return t[0]=e*u+o*r,t[1]=i*u+s*r,t[2]=e*-r+o*u,t[3]=i*-r+s*u,t},i.scale=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=a[0],u=a[1];return t[0]=e*r,t[1]=i*r,t[2]=o*u,t[3]=s*u,t},i.fromRotation=function(t,n){var a=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=a,t[2]=-a,t[3]=e,t},i.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,n,a,e){return t[2]=e[2]/e[0],a[0]=e[0],a[1]=e[1],a[3]=e[3]-t[2]*a[1],[t,n,a]},i.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t},i.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t},i.sub=i.subtract,i.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},i.equals=function(t,n){var a=t[0],i=t[1],o=t[2],s=t[3],r=n[0],u=n[1],h=n[2],c=n[3];return Math.abs(a-r)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(r))&&Math.abs(i-u)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-c)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))},i.multiplyScalar=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t},i.multiplyScalarAndAdd=function(t,n,a,e){return t[0]=n[0]+a[0]*e,t[1]=n[1]+a[1]*e,t[2]=n[2]+a[2]*e,t[3]=n[3]+a[3]*e,t},t.exports=i},function(t,n,a){var e=a(3),i={};i.create=function(){var t=new e.ARRAY_TYPE(9);
return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},i.clone=function(t){var n=new e.ARRAY_TYPE(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},i.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},i.fromValues=function(t,n,a,i,o,s,r,u,h){var c=new e.ARRAY_TYPE(9);return c[0]=t,c[1]=n,c[2]=a,c[3]=i,c[4]=o,c[5]=s,c[6]=r,c[7]=u,c[8]=h,c},i.set=function(t,n,a,e,i,o,s,r,u,h){return t[0]=n,t[1]=a,t[2]=e,t[3]=i,t[4]=o,t[5]=s,t[6]=r,t[7]=u,t[8]=h,t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,n){if(t===n){var a=n[1],e=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=a,t[5]=n[7],t[6]=e,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},i.invert=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=c*s-r*h,f=-c*o+r*u,d=h*o-s*u,M=a*l+e*f+i*d;return M?(M=1/M,t[0]=l*M,t[1]=(-c*e+i*h)*M,t[2]=(r*e-i*s)*M,t[3]=f*M,t[4]=(c*a-i*u)*M,t[5]=(-r*a+i*o)*M,t[6]=d*M,t[7]=(-h*a+e*u)*M,t[8]=(s*a-e*o)*M,t):null},i.adjoint=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8];return t[0]=s*c-r*h,t[1]=i*h-e*c,t[2]=e*r-i*s,t[3]=r*u-o*c,t[4]=a*c-i*u,t[5]=i*o-a*r,t[6]=o*h-s*u,t[7]=e*u-a*h,t[8]=a*s-e*o,t},i.determinant=function(t){var n=t[0],a=t[1],e=t[2],i=t[3],o=t[4],s=t[5],r=t[6],u=t[7],h=t[8];return n*(h*o-s*u)+a*(-h*i+s*r)+e*(u*i-o*r)},i.multiply=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=a[0],d=a[1],M=a[2],m=a[3],p=a[4],S=a[5],v=a[6],I=a[7],x=a[8];return t[0]=f*e+d*s+M*h,t[1]=f*i+d*r+M*c,t[2]=f*o+d*u+M*l,t[3]=m*e+p*s+S*h,t[4]=m*i+p*r+S*c,t[5]=m*o+p*u+S*l,t[6]=v*e+I*s+x*h,t[7]=v*i+I*r+x*c,t[8]=v*o+I*u+x*l,t},i.mul=i.multiply,i.translate=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=a[0],d=a[1];return t[0]=e,t[1]=i,t[2]=o,t[3]=s,t[4]=r,t[5]=u,t[6]=f*e+d*s+h,t[7]=f*i+d*r+c,t[8]=f*o+d*u+l,t},i.rotate=function(t,n,a){var e=n[0],i=n[1],o=n[2],s=n[3],r=n[4],u=n[5],h=n[6],c=n[7],l=n[8],f=Math.sin(a),d=Math.cos(a);return t[0]=d*e+f*s,t[1]=d*i+f*r,t[2]=d*o+f*u,t[3]=d*s-f*e,t[4]=d*r-f*i,t[5]=d*u-f*o,t[6]=h,t[7]=c,t[8]=l,t},i.scale=function(t,n,a){var e=a[0],i=a[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},i.fromTranslation=function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t},i.fromRotation=function(t,n){var a=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=a,t[2]=0,t[3]=-a,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},i.fromQuat=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=a+a,r=e+e,u=i+i,h=a*s,c=e*s,l=e*r,f=i*s,d=i*r,M=i*u,m=o*s,p=o*r,S=o*u;return t[0]=1-l-M,t[3]=c-S,t[6]=f+p,t[1]=c+S,t[4]=1-h-M,t[7]=d-m,t[2]=f-p,t[5]=d+m,t[8]=1-h-l,t},i.normalFromMat4=function(t,n){var a=n[0],e=n[1],i=n[2],o=n[3],s=n[4],r=n[5],u=n[6],h=n[7],c=n[8],l=n[9],f=n[10],d=n[11],M=n[12],m=n[13],p=n[14],S=n[15],v=a*r-e*s,I=a*u-i*s,x=a*h-o*s,D=e*u-i*r,b=e*h-o*r,F=i*h-o*u,y=c*m-l*M,g=c*p-f*M,w=c*S-d*M,A=l*p-f*m,E=l*S-d*m,z=f*S-d*p,R=v*z-I*E+x*A+D*w-b*g+F*y;return R?(R=1/R,t[0]=(r*z-u*E+h*A)*R,t[1]=(u*w-s*z-h*g)*R,t[2]=(s*E-r*w+h*y)*R,t[3]=(i*E-e*z-o*A)*R,t[4]=(a*z-i*w+o*g)*R,t[5]=(e*w-a*E-o*y)*R,t[6]=(m*F-p*b+S*D)*R,t[7]=(p*x-M*F-S*I)*R,t[8]=(M*b-m*x+S*v)*R,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},i.add=function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t},i.subtract=function(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t},i.sub=i.subtract,i.multiplyScalar=function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t},i.multiplyScalarAndAdd=function(t,n,a,e){return t[0]=n[0]+a[0]*e,t[1]=n[1]+a[1]*e,t[2]=n[2]+a[2]*e,t[3]=n[3]+a[3]*e,t[4]=n[4]+a[4]*e,t[5]=n[5]+a[5]*e,t[6]=n[6]+a[6]*e,t[7]=n[7]+a[7]*e,t[8]=n[8]+a[8]*e,t},i.exactEquals=function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]},i.equals=function(t,n){var a=t[0],i=t[1],o=t[2],s=t[3],r=t[4],u=t[5],h=t[6],c=t[7],l=t[8],f=n[0],d=n[1],M=n[2],m=n[3],p=n[4],S=n[5],v=t[6],I=n[7],x=n[8];return Math.abs(a-f)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-d)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-M)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-m)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(r-p)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(u-S)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-v)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-I)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(l-x)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))},t.exports=i},function(t,n,a){"use strict";var e=a(4);const i=(t,n)=>{t.setBounds(...n)};class o extends e.a{constructor(t,n,a=undefined,e=undefined){super(i,t,n,a,e)}}n.a=o},function(t,n,a){"use strict";function e(t,n){t.color=`rgba(${0|n[0]}, ${0|n[1]}, ${0|n[2]}, ${n[3]})`}var i=a(4),o=a(9);class s extends i.a{constructor(t,n,i=undefined,s=undefined){super(e,a.i(o.a)(t),a.i(o.a)(n),i,s)}}n.a=s},function(t,n,a){"use strict";var e=a(0);class i extends e.a{update(t,n){"undefined"==typeof t.velocity[1]&&(t.velocity[1]=0),t.velocity[1]+=i.GRAVITATIONAL_CONSTANT*n}}n.a=i,i.GRAVITATIONAL_CONSTANT=3e-4},function(t,n,a){"use strict";var e=a(4);const i=(t,n)=>{t.setPosition(...n)};class o extends e.a{constructor(t,n,a=undefined,e=undefined){super(i,t,n,a,e)}}n.a=o},function(t,n,a){"use strict";var e=a(0),i=a(2),o=a.n(i);class s extends e.a{constructor(t,n){super(),this.duration=t,this.easing=n||s.linear,this.elapsed=0,this.running=!1,this.starting=!1,this.start=o.a.create(),this.position=o.a.create()}update(t,n){if(this.starting&&(isNaN(this.position[0])&&(this.position[0]=t.position[0]),isNaN(this.position[1])&&(this.position[1]=t.position[1]),isNaN(this.position[2])&&(this.position[2]=t.position[2]),o.a.copy(this.start,t.position),this.running=!0,this.starting=!1,this.elapsed=0),this.running){var a=this.elapsed/this.duration,e=this.easing(a);a>1?(o.a.copy(t.position,this.position),this.running=!1):(o.a.lerp(t.position,this.start,this.position,e),this.elapsed+=n)}}setPosition(t,n,a){super.setPosition(t,n,a),this.starting=!0}}n.a=s},function(t,n,a){"use strict";var e=a(1),i=a(0),o=e.a.prototype.addComponent;class s extends i.a{constructor(t,n){super(),this.positiveComponents=[],this.negativeComponents=[],this.active=!0,this.object=t,this.prop=n}addComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addPositiveComponent(t){this.components=this.positiveComponents,o.call(this,t),this.components=void 0}addNegativeComponent(t){this.components=this.negativeComponents,o.call(this,t),this.components=void 0}addComponents(t,n){t.forEach(this.addPositiveComponent.bind(this)),n.forEach(this.addNegativeComponent.bind(this))}flip(){this.setActive(!this.active)}setActive(t){this.active=t,this.object&&(this.object[this.prop]=this.active)}update(t,n){var a,e=0;if(this.object&&(this.active=this.object[this.prop]),this.active)for(a=this.positiveComponents.length;e<a;e++)this.positiveComponents[e].update(t,n);else for(a=this.negativeComponents.length;e<a;e++)this.negativeComponents[e].update(t,n)}}n.a=s},function(t,n,a){"use strict";var e=a(1);class i extends e.a{constructor(){super(),this.surfaces=[],this.temporarySurfaces=[]}addSurface(t){this.surfaces.push(t)}addSurfaces(t){for(var n=0;n<t.length;n++)this.surfaces.push(t[n])}clearSurfaces(){this.surfaces.length=0}addTemporarySurface(t){this.temporarySurfaces.push(t)}update(t){super.update(t),this.temporarySurfaces.length=0}}n.a=i},function(t,n,a){"use strict";var e=a(1);class i extends e.a{constructor(){super(),this.attackObjects=[],this.vulnerableObjects=[]}addAttackObject(t){this.attackObjects.push(t)}addVulnerableObject(t){this.vulnerableObjects.push(t)}update(t){const n=this.attackObjects.length,a=this.vulnerableObjects.length;for(let e=0;e<n;e++){const t=this.attackObjects[e],n=t.position[0],i=t.position[1],o=t.bounds,s=[n+o[0],i+o[1],n+o[2],i+o[3]];for(let r=0;r<a;r++){const n=this.vulnerableObjects[r],a=n.position[0],e=n.position[1],i=n.bounds,o=[a+i[0],e+i[1],a+i[2],e+i[3]];t!==n&&s[0]<o[2]&&s[1]<o[3]&&s[2]>o[0]&&s[3]>o[1]&&(t.fire("attack",n),n.fire("attackedBy",t))}}this.attackObjects.length=0,this.vulnerableObjects.length=0}}n.a=i},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t){super(),this.renderSystem=t}update(t,n){const a=t.bounds;a&&this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.rect(t.bounds[0],t.bounds[1],t.bounds[2]-t.bounds[0],t.bounds[3]-t.bounds[1]),n.strokeStyle="#000",n.stroke()})}}n.a=i},function(t,n,a){"use strict";var e=(a(1),a(0)),i=a(8);a.n(i);const o=1e3;class s extends e.a{constructor(t){super(),this.path=[],this.currIndex=0,this.lastVx=0,this.lastVy=0,this.renderSystem=t,this.path.length=o}update(t,n){const a=t.position[0],e=t.position[1],i=t.velocity[0],s=t.velocity[1],r=(i-this.lastVx)/n,u=(s-this.lastVy)/n,h=this.path,c=(this.currIndex-2+o)%o,l=Math.abs(h[c]-a),f=Math.abs(h[c+1]-e);(l>100||f>100)&&(h[this.currIndex]=NaN,h[this.currIndex+1]=NaN,this.currIndex=(this.currIndex+2)%o),h[this.currIndex]=a,h[this.currIndex+1]=e,this.renderSystem.push(t=>{t.beginPath(),t.moveTo(h[this.currIndex],h[this.currIndex+1]);for(let n=2;n<o;n+=2){let a=(this.currIndex+n)%o;h[a]?t.lineTo(h[a],h[a+1]):(n+=2,a=(this.currIndex+n)%o,t.moveTo(h[a],h[a+1]))}t.strokeStyle="#CCC",t.stroke()}),this.currIndex=(this.currIndex+2)%o,this.renderSystem.strokePath([a,e,a+100*i,e+100*s],"rgba(0,128,255,0.7)",0),this.renderSystem.strokePath([a,e,a+4e5*r,e+4e5*u],"rgba(0,255,0,0.7)",0),this.lastVx=i,this.lastVy=s}}n.a=s},function(t,n,a){"use strict";var e=a(0);class i extends e.a{constructor(t,n){super(),this.renderSystem=t,this.colour=n||"#000"}update(t,n){for(var a,e,i,o=t.surfaces,s=0,r=o.length;s<r;s++)this.renderSystem.strokePath(o[s],t.colour||this.colour);for(s=0;s<r;s++)for(e=t.surfaces[s],i=e.length,a=0;a<i-3;a+=2){var u=e[a],h=e[a+1],c=e[a+2],l=e[a+3],f=c-u,d=l-h,M=u+.5*f,m=h+.5*d,p=d/Math.sqrt(d*d+f*f),S=-f/Math.sqrt(d*d+f*f);this.renderSystem.strokePath([M,m,M+30*p,m+30*S],"#08f")}}}n.a=i},function(t,n,a){"use strict";var e=a(0),i=a(25);class o extends e.a{constructor(t){super(),this.renderSystem=t}update(t,n){this.renderSystem.push(n=>{n.translate(t.position[0],t.position[1]),n.beginPath(),n.arc(0,0,i.a.NEIGHBOUR_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#008",n.stroke(),n.beginPath(),n.arc(0,0,i.a.SEPARATION_RADIUS,0,2*Math.PI,!1),n.strokeStyle="#800",n.stroke()})}}n.a=o},function(t,n,a){"use strict";var e=a(0),i=a(35),o=a.n(i),s=a(24),r=a.n(s);class u extends e.a{constructor(t,n,a,e,i){super();var o=t.context;this.renderSystem=t,this.vertexBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.STATIC_DRAW),this.vertexBuffer.itemSize=3,this.vertexBuffer.numItems=Math.floor(n.length/this.vertexBuffer.itemSize),this.textureBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.textureBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(a),o.STATIC_DRAW),this.textureBuffer.itemSize=2,this.textureBuffer.numItems=Math.floor(a.length/this.textureBuffer.itemSize),this.vertexNormalBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexNormalBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e),o.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=Math.floor(e.length/this.vertexNormalBuffer.itemSize),this.vertexIndexBuffer=o.createBuffer(),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),o.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=i.length}update(t,n){var a=this.vertexBuffer,e=this.textureBuffer,i=this.vertexNormalBuffer,s=this.vertexIndexBuffer,u=this.lighting||t.lighting,h=this.renderSystem.shaderProgram,c=this.texture||t.texture;this.renderSystem.push(function(n,l){r.a.translate(l,l,t.position),t.rotation&&t.rotationAxis&&r.a.rotate(l,l,t.rotation,t.rotationAxis);var f=o.a.create();o.a.fromMat4(f,l),o.a.invert(f,f),o.a.transpose(f,f),n.uniformMatrix3fv(h.nMatrixUniform,!1,f),t.size&&r.a.scale(l,l,t.size),n.bindBuffer(n.ARRAY_BUFFER,a),n.vertexAttribPointer(h.vertexPositionAttribute,a.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,e),n.vertexAttribPointer(h.textureCoordAttribute,e.itemSize,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(h.vertexNormalAttribute,i.itemSize,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,c),n.uniform1i(h.samplerUniform,0),n.uniform1i(h.useLightingUniform,u),u&&(n.uniform3f(h.ambientColorUniform,this.ambientLight,this.ambientLight,this.ambientLight),n.uniform3f(h.pointLightingLocationUniform,0,0,0),n.uniform3f(h.pointLightingColorUniform,this.pointLighting,this.pointLighting,this.pointLighting)),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,s),n.uniformMatrix4fv(h.mvMatrixUniform,!1,l),n.drawElements(n.TRIANGLES,s.numItems,n.UNSIGNED_SHORT,0)})}}n.a=u,u.createCube=function(t){var n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],a=[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],e=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],i=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return new u(t,n,a,e,i)},u.createSphere=function(t,n,a){var e,i,o,s,r,h,c,l,f,d,M,m,p,S,v,I,x=[],D=[],b=[];for(e=0;e<=n;e++)for(i=e*Math.PI/n,o=Math.sin(i),s=Math.cos(i),r=0;r<=a;r++)h=2*r*Math.PI/a,c=Math.sin(h),l=Math.cos(h),f=l*o,d=s,M=c*o,m=1-r/a,p=1-e/n,D.push(f),D.push(d),D.push(M),b.push(m),b.push(p),x.push(f),x.push(d),x.push(M);for(S=[],e=0;e<n;e++)for(r=0;r<a;r++)v=e*(a+1)+r,I=v+a+1,S.push(v),S.push(I),S.push(v+1),S.push(I),S.push(I+1),S.push(v+1);return new u(t,x,b,x,S)}},function(t,n,a){"use strict";function e(t,n){this.images=t,this.delay=1e3/n,this.lastChange=0,this.imageIndex=0}function i(t){this.renderSystem=t}var o=a(0);n.e=e,n.f=i;class s extends o.a{constructor(t,n,a){super(),this.renderSystem=t,this.texture=n,this.bounds=a}update(t,n){for(var a,e=this.renderSystem,i=this.texture,o=this.bounds,s=i.width,r=i.height,u=t.position[0]%s,h=(t.position[1]%r,o[1]),c=o[2],l=o[3],f=function(t,n,a){return function(e){e.drawImage(t.image,n,a)}};h<l+r;h+=r)for(a=o[0]+u-s;a<c+s;a+=s)e.push(f(i,a,h))}}n.a=s;class r extends o.a{constructor(t,n,a){super(),this.renderSystem=t,this.layer=n,this.sprite=a}update(t,n){super.update(n);var a=this.sprite||t.sprite,e=a&&a.t.image;a&&this.renderSystem.push(function(n){var i=t.position[0],o=t.position[1],s=a.w,r=a.h;n.translate(i,o),n.rotate(t.rotation),n.drawImage(e,a.x,a.y,s,r,-a.ox,-a.oy,s,r)},this.layer)}}n.b=r;class u extends o.a{constructor(t,n){super(),this.duration=t,this.spriteIndex=0,this.playing=!0,this.sprites=n}init(t){this.sprites&&(t.sprites=this.sprites),t.sprites.length&&(t.sprite=t.sprites[0]),t.spriteCountdown=t.sprite&&t.sprite.d||this.duration}update(t,n){var a,e,i=t.sprites.length;this.playing&&(t.spriteCountdown-=n,t.spriteCountdown<=0&&(this.spriteIndex=(this.spriteIndex+1)%i,a=t.sprites[this.spriteIndex],t.sprite=a,e=a.d||this.duration,t.spriteCountdown=e))}play(){this.playing=!0}stop(){this.playing=!1,this.spriteIndex=0}pause(){this.playing=!1}}n.c=u;const h={};n.d=h,h.generateSpriteSheet=function(t,n,a){var e,i,o=[];for(e=0;e<n;e++)for(i=0;i<a;i++)o.push({t:t.t,x:i*t.w,y:e*t.h,w:t.w,h:t.h,ox:t.ox,oy:t.oy,d:t.d});return o},e.prototype=new o.a,e.prototype.update=function(t,n){this.lastChange>this.delay?(this.imageIndex=(this.imageIndex+1)%this.images.length,t.sprite=this.images[this.imageIndex],this.lastChange=0):this.lastChange+=n},i.prototype=new o.a,i.prototype.update=function(t,n){this.renderSystem.push(function(n){var a=t.position[0],e=t.position[1],i=t.sprite.width,o=t.sprite.height;n.translate(a,e),n.rotate(t.rotation),n.drawImage(t.sprite,-i/2,-o/2)})}},function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(1);a.d(n,"GameObject",function(){return e.a});var i=a(16);a.d(n,"GameObjectManager",function(){return i.a});var o=a(0);a.d(n,"GameComponent",function(){return o.a});var s=a(10);a.d(n,"CameraSystem",function(){return s.a});var r=a(6);a.d(n,"CanvasRenderSystem",function(){return r.a});var u=a(7);a.d(n,"WorldSystem",function(){return u.a});var h=a(5);a.d(n,"InputSystem",function(){return h.a});var c=a(26);a.d(n,"AudioSystem",function(){return c.a});var l=a(29);a.d(n,"Game",function(){return l.a});var f=a(27),d=a(11);a.d(n,"Easing",function(){return d});var M=a(33);a.d(n,"World",function(){return M});var m=a(22),p=a(23),S=a(31);a.d(n,"Input",function(){return S});var v=a(17),I=a(28);a.d(n,"Collision",function(){return I});var x=a(14),D=a(13),b=a(12),F=a(15),y=a(32);a.d(n,"Render",function(){return y});var g=a(21);a.d(n,"WebGLRenderSystem",function(){return g.a});var w=a(18),A=a(19),E=a(20),z=a(30);a.d(n,"Debug",function(){return z});const R={};n.Components=R;for(let _ in f)R[_]=f[_];R.WorldBounceComponent=m.a,R.WorldWrapComponent=p.a,R.ClickComponent=v.a,R.CollisionComponent=x.a,R.BounceComponent=D.a,R.BackgroundCollisionComponent=b.a,R.SolidComponent=F.a,R.DotRenderComponent=w.a,R.RectangleRenderComponent=A.a,R.TextRenderComponent=E.a}])});